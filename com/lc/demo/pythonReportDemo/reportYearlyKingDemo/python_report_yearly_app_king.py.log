============================================================================================================================================================分隔符
I am main()
总共抄表数据: 27757
0005 ['2018-01-01 00:00:00', '2018-12-31 23:59:59'] 开始进行计算年报表数据处理
不同的表计号共有个数: 17
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00050000000007
此查询区间,当前编号下总共抄表记录: 7183
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000105'}]
0000000105
00050000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000104')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000105', 'rtu_no': '00050000000003', 'flmeter_no': '00050000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 13, 790856), 'year': '2018', 'std_sum': '520', 'work_sum': '520', 'max_std_flow': '1101004800.0', 'min_std_flow': '0.0', 'avg_std_flow': '1544653.0', 'max_std_flow_time': datetime.datetime(2018, 8, 16, 2, 36, 34, 228000), 'min_std_flow_time': datetime.datetime(2018, 8, 1, 15, 48, 32, 439000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 9, 19, 10, 32, 35, 874000), 'min_work_flow_time': datetime.datetime(2018, 8, 1, 15, 48, 32, 439000), 'max_temperature': '2.2977563e+23', 'min_temperature': '-3451289.5', 'avg_temperature': '5.116989920645969e+20', 'max_temp_time': datetime.datetime(2018, 8, 13, 2, 9, 39, 326000), 'min_temp_time': datetime.datetime(2018, 8, 7, 22, 19, 35, 97000), 'max_press': '154898956000.0', 'min_press': '-3447184.5', 'avg_press': '86253858.0', 'max_press_time': datetime.datetime(2018, 8, 12, 22, 9, 39, 76000), 'min_press_time': datetime.datetime(2018, 8, 8, 10, 49, 32, 272000), 'price': '0.0', 'use_volume_work': '520', 'use_volume_std': '520', 'use_money': '0.0', 'sum_total_volume': '520', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '83', 'valve_state_msg': '83', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86253858.0', 'press_out': '86253858.0', 'temp_in': '5.116989920645969e+20', 'temp_out': '5.116989920645969e+20', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00050000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 176
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000106'}]
0000000106
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000091')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000106', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 14, 130948), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 12, 10, 6, 262000), 'min_std_flow_time': datetime.datetime(2018, 12, 23, 0, 32, 8, 778000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 12, 10, 6, 262000), 'min_work_flow_time': datetime.datetime(2018, 12, 23, 0, 32, 8, 778000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 12, 10, 6, 262000), 'min_temp_time': datetime.datetime(2018, 12, 23, 0, 32, 8, 778000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 12, 10, 6, 262000), 'min_press_time': datetime.datetime(2018, 12, 23, 0, 32, 8, 778000), 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '73340', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '522.8', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 222
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000107'}]
0000000107
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000095')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000107', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 14, 390255), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 14, 51, 26, 356000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 21, 8, 21, 403000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 14, 51, 26, 356000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 21, 8, 21, 403000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 14, 51, 26, 356000), 'min_temp_time': datetime.datetime(2018, 12, 22, 21, 8, 21, 403000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 14, 51, 26, 356000), 'min_press_time': datetime.datetime(2018, 12, 22, 21, 8, 21, 403000), 'price': '1.61', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '5021', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '430.89', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000009
此查询区间,当前编号下总共抄表记录: 860
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000108'}]
0000000108
00050000000009
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000088')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000108', 'rtu_no': '00050000000003', 'flmeter_no': '00050000000009', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 14, 710399), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 9, 18, 4, 56, 59, 87000), 'min_std_flow_time': datetime.datetime(2018, 8, 17, 6, 57, 42, 982000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 9, 18, 4, 56, 59, 87000), 'min_work_flow_time': datetime.datetime(2018, 8, 17, 6, 57, 42, 982000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 9, 18, 4, 56, 59, 87000), 'min_temp_time': datetime.datetime(2018, 8, 17, 6, 57, 42, 982000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 9, 18, 4, 56, 59, 87000), 'min_press_time': datetime.datetime(2018, 8, 17, 6, 57, 42, 982000), 'price': '1.71', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '238579', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '56355.66', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '80', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00050000000009处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 223
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000109'}]
0000000109
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000101')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000109', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 15, 41513), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 15, 47, 13, 809000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 20, 41, 14, 762000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 15, 47, 13, 809000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 20, 41, 14, 762000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 15, 47, 13, 809000), 'min_temp_time': datetime.datetime(2018, 12, 22, 20, 41, 14, 762000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 15, 47, 13, 809000), 'min_press_time': datetime.datetime(2018, 12, 22, 20, 41, 14, 762000), 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '35381', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '9132.72', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 28
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000110'}]
0000000110
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000096')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000110', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 15, 462389), 'year': '2018', 'std_sum': '174131', 'work_sum': '174131', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 3, 59, 41, 528000), 'min_std_flow_time': datetime.datetime(2018, 12, 29, 3, 47, 40, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 3, 59, 41, 528000), 'min_work_flow_time': datetime.datetime(2018, 12, 29, 3, 47, 40, 840000), 'max_temperature': '19.01', 'min_temperature': '8.53', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2018, 12, 27, 5, 49, 35, 90000), 'min_temp_time': datetime.datetime(2018, 12, 29, 5, 49, 42, 137000), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2018, 12, 30, 3, 59, 41, 528000), 'min_press_time': datetime.datetime(2018, 12, 29, 3, 47, 40, 840000), 'price': '1.43', 'use_volume_work': '8061', 'use_volume_std': '8061', 'use_money': '11527.23', 'sum_total_volume': '174131', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5645.89', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000026
此查询区间,当前编号下总共抄表记录: 230
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000111'}]
0000000111
00056000000026
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000092')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000111', 'rtu_no': '00050000000021', 'flmeter_no': '00056000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 15, 728650), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 11, 28, 32, 856000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 20, 28, 32, 918000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 11, 28, 32, 856000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 20, 28, 32, 918000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 11, 28, 32, 856000), 'min_temp_time': datetime.datetime(2018, 12, 22, 20, 28, 32, 918000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 11, 28, 32, 856000), 'min_press_time': datetime.datetime(2018, 12, 22, 20, 28, 32, 918000), 'price': '1.61', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '7985', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1489.91', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000026处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 1978
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000112'}]
0000000112
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000089')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000112', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 16, 15910), 'year': '2018', 'std_sum': '525342', 'work_sum': '525342', 'max_std_flow': '1883308032.0', 'min_std_flow': '0.0', 'avg_std_flow': '112844395.0', 'max_std_flow_time': datetime.datetime(2018, 11, 28, 22, 5, 22, 719000), 'min_std_flow_time': datetime.datetime(2018, 10, 1, 22, 38, 58, 914000), 'max_work_flow': '1675051846.0', 'min_work_flow': '0.0', 'avg_work_flow': '109431540.0', 'max_work_flow_time': datetime.datetime(2018, 12, 4, 19, 49, 18, 804000), 'min_work_flow_time': datetime.datetime(2018, 10, 1, 22, 38, 58, 914000), 'max_temperature': '6.681447e+35', 'min_temperature': '0.0', 'avg_temperature': '6.746571029402958e+32', 'max_temp_time': datetime.datetime(2018, 10, 14, 20, 13, 57, 671000), 'min_temp_time': datetime.datetime(2018, 10, 4, 2, 29, 5, 945000), 'max_press': '868.0', 'min_press': '0.0', 'avg_press': '82.0', 'max_press_time': datetime.datetime(2018, 10, 4, 2, 29, 5, 945000), 'min_press_time': datetime.datetime(2018, 10, 1, 10, 27, 59, 304000), 'price': '1.52', 'use_volume_work': '79425', 'use_volume_std': '79425', 'use_money': '120726.0', 'sum_total_volume': '525342', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '4298.49', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '82.0', 'press_out': '82.0', 'temp_in': '6.746571029402958e+32', 'temp_out': '6.746571029402958e+32', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000006
此查询区间,当前编号下总共抄表记录: 6859
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000113'}]
0000000113
00050000000006
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000090')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000113', 'rtu_no': '00050000000003', 'flmeter_no': '00050000000006', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 16, 347023), 'year': '2018', 'std_sum': '3', 'work_sum': '0', 'max_std_flow': '1108320570.0', 'min_std_flow': '26178.0', 'avg_std_flow': '1101425015.0', 'max_std_flow_time': datetime.datetime(2018, 9, 19, 10, 32, 35, 843000), 'min_std_flow_time': datetime.datetime(2018, 8, 11, 0, 19, 35, 974000), 'max_work_flow': '1118216506.0', 'min_work_flow': '262224450.0', 'avg_work_flow': '1105221506.0', 'max_work_flow_time': datetime.datetime(2018, 8, 11, 0, 19, 35, 990000), 'min_work_flow_time': datetime.datetime(2018, 7, 30, 5, 42, 52, 209000), 'max_temperature': '2.2933942e+23', 'min_temperature': '-2103696.5', 'avg_temperature': '2.0061765855080913e+20', 'max_temp_time': datetime.datetime(2018, 8, 2, 3, 18, 56, 705000), 'min_temp_time': datetime.datetime(2018, 7, 28, 7, 57, 34, 22000), 'max_press': '101.325', 'min_press': '-2103696.5', 'avg_press': '-10942.0', 'max_press_time': datetime.datetime(2018, 9, 19, 10, 32, 35, 843000), 'min_press_time': datetime.datetime(2018, 7, 28, 1, 14, 55, 6000), 'price': '1.4900001', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '10.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '87', 'valve_state_msg': '87', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '-10942.0', 'press_out': '-10942.0', 'temp_in': '2.0061765855080913e+20', 'temp_out': '2.0061765855080913e+20', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00050000000006处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 1879
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000114'}]
0000000114
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000100')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000114', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 16, 706039), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1108320570.0', 'min_std_flow': '0.0', 'avg_std_flow': '4128921.0', 'max_std_flow_time': datetime.datetime(2018, 9, 19, 12, 58, 32, 45000), 'min_std_flow_time': datetime.datetime(2018, 10, 1, 22, 11, 16, 414000), 'max_work_flow': '1108320570.0', 'min_work_flow': '0.0', 'avg_work_flow': '4128921.0', 'max_work_flow_time': datetime.datetime(2018, 9, 19, 12, 58, 32, 45000), 'min_work_flow_time': datetime.datetime(2018, 10, 1, 22, 11, 16, 414000), 'max_temperature': '4.775683e+23', 'min_temperature': '-2103696.5', 'avg_temperature': '2.541608834486429e+20', 'max_temp_time': datetime.datetime(2018, 12, 17, 4, 25, 41, 543000), 'min_temp_time': datetime.datetime(2018, 9, 30, 5, 35, 18, 23000), 'max_press': '3.7779616e+22', 'min_press': '-2103696.5', 'avg_press': '2.0106235231506117e+19', 'max_press_time': datetime.datetime(2018, 10, 26, 18, 56, 51, 347000), 'min_press_time': datetime.datetime(2018, 9, 26, 11, 52, 20, 617000), 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '-3', 'use_money': '-6.84', 'sum_total_volume': '80351', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1230.67', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '2.0106235231506117e+19', 'press_out': '2.0106235231506117e+19', 'temp_in': '2.541608834486429e+20', 'temp_out': '2.541608834486429e+20', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 156
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000115'}]
0000000115
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000102')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000115', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 17, 29203), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 11, 4, 13, 996000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 21, 32, 59, 246000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 11, 4, 13, 996000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 21, 32, 59, 246000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 11, 4, 13, 996000), 'min_temp_time': datetime.datetime(2018, 12, 22, 21, 32, 59, 246000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 11, 4, 13, 996000), 'min_press_time': datetime.datetime(2018, 12, 22, 21, 32, 59, 246000), 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '3439', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '730.38', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 169
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000116'}]
0000000116
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000093')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000116', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 17, 312419), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 15, 36, 16, 637000), 'min_std_flow_time': datetime.datetime(2018, 12, 28, 11, 38, 22, 918000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 15, 36, 16, 637000), 'min_work_flow_time': datetime.datetime(2018, 12, 28, 11, 38, 22, 918000), 'max_temperature': '1.7374836e+18', 'min_temperature': '-362.41', 'avg_temperature': '1.028096804733728e+16', 'max_temp_time': datetime.datetime(2018, 12, 25, 11, 20, 27, 684000), 'min_temp_time': datetime.datetime(2018, 12, 31, 10, 55, 29, 637000), 'max_press': '101.53', 'min_press': '-11.17', 'avg_press': '95.0', 'max_press_time': datetime.datetime(2018, 12, 29, 1, 57, 27, 106000), 'min_press_time': datetime.datetime(2018, 12, 31, 10, 55, 29, 637000), 'price': '1.59', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '29928', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '469.55', 'remain_volume': '0.0', 'fm_state': '20', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '95.0', 'press_out': '95.0', 'temp_in': '1.028096804733728e+16', 'temp_out': '1.028096804733728e+16', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000008
此查询区间,当前编号下总共抄表记录: 7279
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000117'}]
0000000117
00050000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000098')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000117', 'rtu_no': '00050000000003', 'flmeter_no': '00050000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 17, 641540), 'year': '2018', 'std_sum': '3', 'work_sum': '0', 'max_std_flow': '1715605414.0', 'min_std_flow': '262224450.0', 'avg_std_flow': '1098663791.0', 'max_std_flow_time': datetime.datetime(2018, 7, 31, 14, 51, 36, 283000), 'min_std_flow_time': datetime.datetime(2018, 7, 28, 23, 31, 23, 678000), 'max_work_flow': '1108320570.0', 'min_work_flow': '262224450.0', 'avg_work_flow': '1102112988.0', 'max_work_flow_time': datetime.datetime(2018, 9, 19, 10, 32, 37, 359000), 'min_work_flow_time': datetime.datetime(2018, 7, 28, 23, 31, 23, 678000), 'max_temperature': '2.2910694e+23', 'min_temperature': '-2107792.5', 'avg_temperature': '3.147505701332601e+20', 'max_temp_time': datetime.datetime(2018, 8, 7, 4, 39, 47, 526000), 'min_temp_time': datetime.datetime(2018, 7, 28, 18, 57, 58, 100000), 'max_press': '101.325', 'min_press': '-2107801.5', 'avg_press': '-20712.0', 'max_press_time': datetime.datetime(2018, 9, 19, 10, 32, 37, 359000), 'min_press_time': datetime.datetime(2018, 8, 9, 17, 29, 34, 402000), 'price': '1.5900002', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '93', 'valve_state_msg': '93', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '-20712.0', 'press_out': '-20712.0', 'temp_in': '3.147505701332601e+20', 'temp_out': '3.147505701332601e+20', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00050000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 198
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000118'}]
0000000118
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000099')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000118', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 18, 30527), 'year': '2018', 'std_sum': '40070', 'work_sum': '43337', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 15, 36, 17, 809000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 20, 42, 26, 903000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 15, 36, 17, 809000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 20, 42, 26, 903000), 'max_temperature': '34.03', 'min_temperature': '19.18', 'avg_temperature': '29.0', 'max_temp_time': datetime.datetime(2018, 12, 21, 21, 18, 29, 90000), 'min_temp_time': datetime.datetime(2018, 12, 24, 6, 19, 31, 200000), 'max_press': '101.05', 'min_press': '82.65', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2018, 12, 31, 12, 58, 24, 278000), 'min_press_time': datetime.datetime(2018, 12, 28, 6, 33, 26, 247000), 'price': '1.46', 'use_volume_work': '2997', 'use_volume_std': '2804', 'use_money': '4093.84', 'sum_total_volume': '40070', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '39451.92', 'remain_volume': '0.0', 'fm_state': '33', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '29.0', 'temp_out': '29.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 2
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000119'}]
0000000119
00056000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000094')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000119', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 18, 294821), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 25, 14, 38, 15, 184000), 'min_std_flow_time': datetime.datetime(2018, 12, 24, 21, 28, 23, 325000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 25, 14, 38, 15, 184000), 'min_work_flow_time': datetime.datetime(2018, 12, 24, 21, 28, 23, 325000), 'max_temperature': '14.04', 'min_temperature': '8.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2018, 12, 25, 14, 38, 15, 184000), 'min_temp_time': datetime.datetime(2018, 12, 24, 21, 28, 23, 325000), 'max_press': '96.85', 'min_press': '91.27', 'avg_press': '94.0', 'max_press_time': datetime.datetime(2018, 12, 25, 14, 38, 15, 184000), 'min_press_time': datetime.datetime(2018, 12, 24, 21, 28, 23, 325000), 'price': '220.52', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '144825', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '4948.6', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '94.0', 'press_out': '94.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 180
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000120'}]
0000000120
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000103')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000120', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 18, 558118), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 29, 15, 3, 22, 293000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 21, 3, 4, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 29, 15, 3, 22, 293000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 21, 3, 4, 840000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 29, 15, 3, 22, 293000), 'min_temp_time': datetime.datetime(2018, 12, 22, 21, 3, 4, 840000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 29, 15, 3, 22, 293000), 'min_press_time': datetime.datetime(2018, 12, 22, 21, 3, 4, 840000), 'price': '161.51', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '23284', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3134.36', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 135
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000121'}]
0000000121
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000097')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000121', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 34, 18, 845324), 'year': '2018', 'std_sum': '10145', 'work_sum': '11985', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 12, 4, 34, 59000), 'min_std_flow_time': datetime.datetime(2018, 12, 23, 0, 14, 39, 668000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 12, 4, 34, 59000), 'min_work_flow_time': datetime.datetime(2018, 12, 23, 0, 14, 39, 668000), 'max_temperature': '21.14', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2018, 12, 26, 3, 38, 35, 356000), 'min_temp_time': datetime.datetime(2018, 12, 29, 13, 38, 37, 231000), 'max_press': '109.49', 'min_press': '-2498346090000.0', 'avg_press': '-18506267235.0', 'max_press_time': datetime.datetime(2018, 12, 30, 12, 4, 34, 59000), 'min_press_time': datetime.datetime(2018, 12, 29, 13, 38, 37, 231000), 'price': '1.52', 'use_volume_work': '11272', 'use_volume_std': '9543', 'use_money': '14505.36', 'sum_total_volume': '10145', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '76152.14', 'remain_volume': '0.0', 'fm_state': '98', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '-18506267235.0', 'press_out': '-18506267235.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
all done-年报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-03-20 14:34:12.742628
程序运行结束时间: 2019-03-20 14:34:19.124577
整个程序运行总时间: 6 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 3.4133397413098074e-07
程序运行结束time.clock(): 6.38149430552531
整个程序运行总时间time.clock()差: 6.3814939641913355 秒
----------------------------------------------------------------------------------------
============================================================================================================================================================分隔符
I am main()
总共抄表数据: 27757
0005 ['2018-01-01 00:00:00', '2018-12-31 23:59:59'] 开始进行计算年报表数据处理
不同的表计号共有个数: 17
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 156
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000122'}]
0000000122
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000115')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000122', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 16, 449437), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 11, 4, 13, 996000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 21, 32, 59, 246000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 11, 4, 13, 996000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 21, 32, 59, 246000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 11, 4, 13, 996000), 'min_temp_time': datetime.datetime(2018, 12, 22, 21, 32, 59, 246000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 11, 4, 13, 996000), 'min_press_time': datetime.datetime(2018, 12, 22, 21, 32, 59, 246000), 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '3439', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '730.38', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000026
此查询区间,当前编号下总共抄表记录: 230
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000123'}]
0000000123
00056000000026
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000111')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000123', 'rtu_no': '00050000000021', 'flmeter_no': '00056000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 16, 798477), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 11, 28, 32, 856000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 20, 28, 32, 918000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 11, 28, 32, 856000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 20, 28, 32, 918000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 11, 28, 32, 856000), 'min_temp_time': datetime.datetime(2018, 12, 22, 20, 28, 32, 918000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 11, 28, 32, 856000), 'min_press_time': datetime.datetime(2018, 12, 22, 20, 28, 32, 918000), 'price': '1.61', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '7985', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1489.91', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000026处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000007
此查询区间,当前编号下总共抄表记录: 7183
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000124'}]
0000000124
00050000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000105')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000124', 'rtu_no': '00050000000003', 'flmeter_no': '00050000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 17, 112667), 'year': '2018', 'std_sum': '520', 'work_sum': '520', 'max_std_flow': '1101004800.0', 'min_std_flow': '0.0', 'avg_std_flow': '1544653.0', 'max_std_flow_time': datetime.datetime(2018, 8, 16, 2, 36, 34, 228000), 'min_std_flow_time': datetime.datetime(2018, 8, 1, 15, 48, 32, 439000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 9, 19, 10, 32, 35, 874000), 'min_work_flow_time': datetime.datetime(2018, 8, 1, 15, 48, 32, 439000), 'max_temperature': '2.2977563e+23', 'min_temperature': '-3451289.5', 'avg_temperature': '5.116989920645969e+20', 'max_temp_time': datetime.datetime(2018, 8, 13, 2, 9, 39, 326000), 'min_temp_time': datetime.datetime(2018, 8, 7, 22, 19, 35, 97000), 'max_press': '154898956000.0', 'min_press': '-3447184.5', 'avg_press': '86253858.0', 'max_press_time': datetime.datetime(2018, 8, 12, 22, 9, 39, 76000), 'min_press_time': datetime.datetime(2018, 8, 8, 10, 49, 32, 272000), 'price': '0.0', 'use_volume_work': '520', 'use_volume_std': '520', 'use_money': '0.0', 'sum_total_volume': '520', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '83', 'valve_state_msg': '83', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86253858.0', 'press_out': '86253858.0', 'temp_in': '5.116989920645969e+20', 'temp_out': '5.116989920645969e+20', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00050000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 169
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000125'}]
0000000125
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000116')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000125', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 17, 438766), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 15, 36, 16, 637000), 'min_std_flow_time': datetime.datetime(2018, 12, 28, 11, 38, 22, 918000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 15, 36, 16, 637000), 'min_work_flow_time': datetime.datetime(2018, 12, 28, 11, 38, 22, 918000), 'max_temperature': '1.7374836e+18', 'min_temperature': '-362.41', 'avg_temperature': '1.028096804733728e+16', 'max_temp_time': datetime.datetime(2018, 12, 25, 11, 20, 27, 684000), 'min_temp_time': datetime.datetime(2018, 12, 31, 10, 55, 29, 637000), 'max_press': '101.53', 'min_press': '-11.17', 'avg_press': '95.0', 'max_press_time': datetime.datetime(2018, 12, 29, 1, 57, 27, 106000), 'min_press_time': datetime.datetime(2018, 12, 31, 10, 55, 29, 637000), 'price': '1.59', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '29928', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '469.55', 'remain_volume': '0.0', 'fm_state': '20', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '95.0', 'press_out': '95.0', 'temp_in': '1.028096804733728e+16', 'temp_out': '1.028096804733728e+16', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 223
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000126'}]
0000000126
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000109')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000126', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 17, 783872), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 15, 47, 13, 809000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 20, 41, 14, 762000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 15, 47, 13, 809000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 20, 41, 14, 762000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 15, 47, 13, 809000), 'min_temp_time': datetime.datetime(2018, 12, 22, 20, 41, 14, 762000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 15, 47, 13, 809000), 'min_press_time': datetime.datetime(2018, 12, 22, 20, 41, 14, 762000), 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '35381', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '9132.72', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 198
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000127'}]
0000000127
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000118')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000127', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 18, 58113), 'year': '2018', 'std_sum': '40070', 'work_sum': '43337', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 15, 36, 17, 809000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 20, 42, 26, 903000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 15, 36, 17, 809000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 20, 42, 26, 903000), 'max_temperature': '34.03', 'min_temperature': '19.18', 'avg_temperature': '29.0', 'max_temp_time': datetime.datetime(2018, 12, 21, 21, 18, 29, 90000), 'min_temp_time': datetime.datetime(2018, 12, 24, 6, 19, 31, 200000), 'max_press': '101.05', 'min_press': '82.65', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2018, 12, 31, 12, 58, 24, 278000), 'min_press_time': datetime.datetime(2018, 12, 28, 6, 33, 26, 247000), 'price': '1.46', 'use_volume_work': '2997', 'use_volume_std': '2804', 'use_money': '4093.84', 'sum_total_volume': '40070', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '39451.92', 'remain_volume': '0.0', 'fm_state': '33', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '29.0', 'temp_out': '29.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 180
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000128'}]
0000000128
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000120')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000128', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 18, 335370), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 29, 15, 3, 22, 293000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 21, 3, 4, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 29, 15, 3, 22, 293000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 21, 3, 4, 840000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 29, 15, 3, 22, 293000), 'min_temp_time': datetime.datetime(2018, 12, 22, 21, 3, 4, 840000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 29, 15, 3, 22, 293000), 'min_press_time': datetime.datetime(2018, 12, 22, 21, 3, 4, 840000), 'price': '161.51', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '23284', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3134.36', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 176
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000129'}]
0000000129
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000106')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000129', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 18, 607672), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 12, 10, 6, 262000), 'min_std_flow_time': datetime.datetime(2018, 12, 23, 0, 32, 8, 778000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 12, 10, 6, 262000), 'min_work_flow_time': datetime.datetime(2018, 12, 23, 0, 32, 8, 778000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 12, 10, 6, 262000), 'min_temp_time': datetime.datetime(2018, 12, 23, 0, 32, 8, 778000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 12, 10, 6, 262000), 'min_press_time': datetime.datetime(2018, 12, 23, 0, 32, 8, 778000), 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '73340', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '522.8', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 28
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000130'}]
0000000130
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000110')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000130', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 18, 865953), 'year': '2018', 'std_sum': '174131', 'work_sum': '174131', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 3, 59, 41, 528000), 'min_std_flow_time': datetime.datetime(2018, 12, 29, 3, 47, 40, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 3, 59, 41, 528000), 'min_work_flow_time': datetime.datetime(2018, 12, 29, 3, 47, 40, 840000), 'max_temperature': '19.01', 'min_temperature': '8.53', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2018, 12, 27, 5, 49, 35, 90000), 'min_temp_time': datetime.datetime(2018, 12, 29, 5, 49, 42, 137000), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2018, 12, 30, 3, 59, 41, 528000), 'min_press_time': datetime.datetime(2018, 12, 29, 3, 47, 40, 840000), 'price': '1.43', 'use_volume_work': '8061', 'use_volume_std': '8061', 'use_money': '11527.23', 'sum_total_volume': '174131', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5645.89', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 135
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000131'}]
0000000131
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000121')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000131', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 19, 201057), 'year': '2018', 'std_sum': '10145', 'work_sum': '11985', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 12, 4, 34, 59000), 'min_std_flow_time': datetime.datetime(2018, 12, 23, 0, 14, 39, 668000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 12, 4, 34, 59000), 'min_work_flow_time': datetime.datetime(2018, 12, 23, 0, 14, 39, 668000), 'max_temperature': '21.14', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2018, 12, 26, 3, 38, 35, 356000), 'min_temp_time': datetime.datetime(2018, 12, 29, 13, 38, 37, 231000), 'max_press': '109.49', 'min_press': '-2498346090000.0', 'avg_press': '-18506267235.0', 'max_press_time': datetime.datetime(2018, 12, 30, 12, 4, 34, 59000), 'min_press_time': datetime.datetime(2018, 12, 29, 13, 38, 37, 231000), 'price': '1.52', 'use_volume_work': '11272', 'use_volume_std': '9543', 'use_money': '14505.36', 'sum_total_volume': '10145', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '76152.14', 'remain_volume': '0.0', 'fm_state': '98', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '-18506267235.0', 'press_out': '-18506267235.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 2
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000132'}]
0000000132
00056000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000119')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000132', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 19, 539154), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 25, 14, 38, 15, 184000), 'min_std_flow_time': datetime.datetime(2018, 12, 24, 21, 28, 23, 325000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 25, 14, 38, 15, 184000), 'min_work_flow_time': datetime.datetime(2018, 12, 24, 21, 28, 23, 325000), 'max_temperature': '14.04', 'min_temperature': '8.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2018, 12, 25, 14, 38, 15, 184000), 'min_temp_time': datetime.datetime(2018, 12, 24, 21, 28, 23, 325000), 'max_press': '96.85', 'min_press': '91.27', 'avg_press': '94.0', 'max_press_time': datetime.datetime(2018, 12, 25, 14, 38, 15, 184000), 'min_press_time': datetime.datetime(2018, 12, 24, 21, 28, 23, 325000), 'price': '220.52', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '144825', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '4948.6', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '94.0', 'press_out': '94.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000009
此查询区间,当前编号下总共抄表记录: 860
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000133'}]
0000000133
00050000000009
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000108')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000133', 'rtu_no': '00050000000003', 'flmeter_no': '00050000000009', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 19, 795496), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 9, 18, 4, 56, 59, 87000), 'min_std_flow_time': datetime.datetime(2018, 8, 17, 6, 57, 42, 982000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 9, 18, 4, 56, 59, 87000), 'min_work_flow_time': datetime.datetime(2018, 8, 17, 6, 57, 42, 982000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 9, 18, 4, 56, 59, 87000), 'min_temp_time': datetime.datetime(2018, 8, 17, 6, 57, 42, 982000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 9, 18, 4, 56, 59, 87000), 'min_press_time': datetime.datetime(2018, 8, 17, 6, 57, 42, 982000), 'price': '1.71', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '238579', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '56355.66', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '80', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00050000000009处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 1978
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000134'}]
0000000134
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000112')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000134', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 20, 69767), 'year': '2018', 'std_sum': '525342', 'work_sum': '525342', 'max_std_flow': '1883308032.0', 'min_std_flow': '0.0', 'avg_std_flow': '112844395.0', 'max_std_flow_time': datetime.datetime(2018, 11, 28, 22, 5, 22, 719000), 'min_std_flow_time': datetime.datetime(2018, 10, 1, 22, 38, 58, 914000), 'max_work_flow': '1675051846.0', 'min_work_flow': '0.0', 'avg_work_flow': '109431540.0', 'max_work_flow_time': datetime.datetime(2018, 12, 4, 19, 49, 18, 804000), 'min_work_flow_time': datetime.datetime(2018, 10, 1, 22, 38, 58, 914000), 'max_temperature': '6.681447e+35', 'min_temperature': '0.0', 'avg_temperature': '6.746571029402958e+32', 'max_temp_time': datetime.datetime(2018, 10, 14, 20, 13, 57, 671000), 'min_temp_time': datetime.datetime(2018, 10, 4, 2, 29, 5, 945000), 'max_press': '868.0', 'min_press': '0.0', 'avg_press': '82.0', 'max_press_time': datetime.datetime(2018, 10, 4, 2, 29, 5, 945000), 'min_press_time': datetime.datetime(2018, 10, 1, 10, 27, 59, 304000), 'price': '1.52', 'use_volume_work': '79425', 'use_volume_std': '79425', 'use_money': '120726.0', 'sum_total_volume': '525342', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '4298.49', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '82.0', 'press_out': '82.0', 'temp_in': '6.746571029402958e+32', 'temp_out': '6.746571029402958e+32', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000008
此查询区间,当前编号下总共抄表记录: 7279
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000135'}]
0000000135
00050000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000117')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000135', 'rtu_no': '00050000000003', 'flmeter_no': '00050000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 20, 421824), 'year': '2018', 'std_sum': '3', 'work_sum': '0', 'max_std_flow': '1715605414.0', 'min_std_flow': '262224450.0', 'avg_std_flow': '1098663791.0', 'max_std_flow_time': datetime.datetime(2018, 7, 31, 14, 51, 36, 283000), 'min_std_flow_time': datetime.datetime(2018, 7, 28, 23, 31, 23, 678000), 'max_work_flow': '1108320570.0', 'min_work_flow': '262224450.0', 'avg_work_flow': '1102112988.0', 'max_work_flow_time': datetime.datetime(2018, 9, 19, 10, 32, 37, 359000), 'min_work_flow_time': datetime.datetime(2018, 7, 28, 23, 31, 23, 678000), 'max_temperature': '2.2910694e+23', 'min_temperature': '-2107792.5', 'avg_temperature': '3.147505701332601e+20', 'max_temp_time': datetime.datetime(2018, 8, 7, 4, 39, 47, 526000), 'min_temp_time': datetime.datetime(2018, 7, 28, 18, 57, 58, 100000), 'max_press': '101.325', 'min_press': '-2107801.5', 'avg_press': '-20712.0', 'max_press_time': datetime.datetime(2018, 9, 19, 10, 32, 37, 359000), 'min_press_time': datetime.datetime(2018, 8, 9, 17, 29, 34, 402000), 'price': '1.5900002', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '93', 'valve_state_msg': '93', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '-20712.0', 'press_out': '-20712.0', 'temp_in': '3.147505701332601e+20', 'temp_out': '3.147505701332601e+20', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00050000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000006
此查询区间,当前编号下总共抄表记录: 6859
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000136'}]
0000000136
00050000000006
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000113')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000136', 'rtu_no': '00050000000003', 'flmeter_no': '00050000000006', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 20, 766874), 'year': '2018', 'std_sum': '3', 'work_sum': '0', 'max_std_flow': '1108320570.0', 'min_std_flow': '26178.0', 'avg_std_flow': '1101425015.0', 'max_std_flow_time': datetime.datetime(2018, 9, 19, 10, 32, 35, 843000), 'min_std_flow_time': datetime.datetime(2018, 8, 11, 0, 19, 35, 974000), 'max_work_flow': '1118216506.0', 'min_work_flow': '262224450.0', 'avg_work_flow': '1105221506.0', 'max_work_flow_time': datetime.datetime(2018, 8, 11, 0, 19, 35, 990000), 'min_work_flow_time': datetime.datetime(2018, 7, 30, 5, 42, 52, 209000), 'max_temperature': '2.2933942e+23', 'min_temperature': '-2103696.5', 'avg_temperature': '2.0061765855080913e+20', 'max_temp_time': datetime.datetime(2018, 8, 2, 3, 18, 56, 705000), 'min_temp_time': datetime.datetime(2018, 7, 28, 7, 57, 34, 22000), 'max_press': '101.325', 'min_press': '-2103696.5', 'avg_press': '-10942.0', 'max_press_time': datetime.datetime(2018, 9, 19, 10, 32, 35, 843000), 'min_press_time': datetime.datetime(2018, 7, 28, 1, 14, 55, 6000), 'price': '1.4900001', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '10.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '87', 'valve_state_msg': '87', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '-10942.0', 'press_out': '-10942.0', 'temp_in': '2.0061765855080913e+20', 'temp_out': '2.0061765855080913e+20', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00050000000006处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 1879
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000137'}]
0000000137
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000114')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000137', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 21, 111951), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1108320570.0', 'min_std_flow': '0.0', 'avg_std_flow': '4128921.0', 'max_std_flow_time': datetime.datetime(2018, 9, 19, 12, 58, 32, 45000), 'min_std_flow_time': datetime.datetime(2018, 10, 1, 22, 11, 16, 414000), 'max_work_flow': '1108320570.0', 'min_work_flow': '0.0', 'avg_work_flow': '4128921.0', 'max_work_flow_time': datetime.datetime(2018, 9, 19, 12, 58, 32, 45000), 'min_work_flow_time': datetime.datetime(2018, 10, 1, 22, 11, 16, 414000), 'max_temperature': '4.775683e+23', 'min_temperature': '-2103696.5', 'avg_temperature': '2.541608834486429e+20', 'max_temp_time': datetime.datetime(2018, 12, 17, 4, 25, 41, 543000), 'min_temp_time': datetime.datetime(2018, 9, 30, 5, 35, 18, 23000), 'max_press': '3.7779616e+22', 'min_press': '-2103696.5', 'avg_press': '2.0106235231506117e+19', 'max_press_time': datetime.datetime(2018, 10, 26, 18, 56, 51, 347000), 'min_press_time': datetime.datetime(2018, 9, 26, 11, 52, 20, 617000), 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '-3', 'use_money': '-6.84', 'sum_total_volume': '80351', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1230.67', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '2.0106235231506117e+19', 'press_out': '2.0106235231506117e+19', 'temp_in': '2.541608834486429e+20', 'temp_out': '2.541608834486429e+20', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 222
1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_YEARLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_YEARLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '2019年报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000138'}]
0000000138
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_YEARLY where SRY_ORG_ID = :1 and SRY_ID=:2],参数:[('0005', '000520180000000107')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_YEARLY (SRY_ORG_ID,SRY_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRY_STATUS )VALUES(:sry_org_id,:sry_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :sry_status)],参数:[{'sry_org_id': '0005', 'sry_id': '000520180000000138', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 20, 14, 35, 21, 374250), 'year': '2018', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2018, 12, 30, 14, 51, 26, 356000), 'min_std_flow_time': datetime.datetime(2018, 12, 22, 21, 8, 21, 403000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2018, 12, 30, 14, 51, 26, 356000), 'min_work_flow_time': datetime.datetime(2018, 12, 22, 21, 8, 21, 403000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2018, 12, 30, 14, 51, 26, 356000), 'min_temp_time': datetime.datetime(2018, 12, 22, 21, 8, 21, 403000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2018, 12, 30, 14, 51, 26, 356000), 'min_press_time': datetime.datetime(2018, 12, 22, 21, 8, 21, 403000), 'price': '1.61', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '5021', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '430.89', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'sry_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
all done-年报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-03-20 14:35:15.361316
程序运行结束时间: 2019-03-20 14:35:21.690406
整个程序运行总时间: 6 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 0.0
程序运行结束time.clock(): 6.328852414698933
整个程序运行总时间time.clock()差: 6.328852414698933 秒
----------------------------------------------------------------------------------------
