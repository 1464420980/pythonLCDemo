============================================================================================================================================================分隔符
此机构: 0008
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0008 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0015
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0015 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0017
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0017 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0005
💗 I am main()
总共抄表数据: 14341
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 482
0005 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 18
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00056000000017
此查询区间,当前编号下总共抄表记录: 1261
此查询区间,上一月最后一天内当前编号下总共抄表记录: 45
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000433'}]
0000000433
00056000000017
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000429')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000433', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 40, 805185), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '192923', 'work_sum': '211295', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 36, 688000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 33, 12, 793000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 36, 688000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 33, 12, 793000), 'max_temperature': '18.13', 'min_temperature': '0.0', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 56, 36, 688000), 'min_temp_time': datetime.datetime(2019, 2, 21, 15, 54, 4, 319000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 56, 36, 688000), 'min_press_time': datetime.datetime(2019, 2, 21, 15, 54, 4, 319000), 'price': '1.55', 'use_volume_work': '9971.0', 'use_volume_std': '13336.0', 'use_money': '20670.8', 'sum_total_volume': '211295', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '14008.73', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000017处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000026
此查询区间,当前编号下总共抄表记录: 393
此查询区间,上一月最后一天内当前编号下总共抄表记录: 45
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000434'}]
0000000434
00056000000026
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000427')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000434', 'rtu_no': '00050000000021', 'flmeter_no': '00056000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 41, 75153), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 13, 10, 420000), 'min_std_flow_time': datetime.datetime(2019, 2, 21, 10, 7, 19, 603000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 13, 10, 420000), 'min_work_flow_time': datetime.datetime(2019, 2, 21, 10, 7, 19, 603000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 13, 10, 420000), 'min_temp_time': datetime.datetime(2019, 2, 21, 10, 7, 19, 603000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 13, 10, 420000), 'min_press_time': datetime.datetime(2019, 2, 21, 10, 7, 19, 603000), 'price': '1.61', 'use_volume_work': '-201324.0', 'use_volume_std': '-179587.0', 'use_money': '-289135.07', 'sum_total_volume': '9097', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2317.45', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000026处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 396
此查询区间,上一月最后一天内当前编号下总共抄表记录: 45
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000435'}]
0000000435
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000423')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000435', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 41, 365182), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 16, 7, 218000), 'min_std_flow_time': datetime.datetime(2019, 2, 21, 10, 23, 9, 90000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 16, 7, 218000), 'min_work_flow_time': datetime.datetime(2019, 2, 21, 10, 23, 9, 90000), 'max_temperature': '33.26', 'min_temperature': '20.0', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 2, 23, 21, 36, 0, 407000), 'min_temp_time': datetime.datetime(2019, 2, 20, 19, 18, 58, 990000), 'max_press': '101.65', 'min_press': '95.23', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 2, 23, 1, 30, 11, 563000), 'min_press_time': datetime.datetime(2019, 2, 18, 18, 11, 2, 382000), 'price': '1.59', 'use_volume_work': '-201324.0', 'use_volume_std': '-179587.0', 'use_money': '-285543.33', 'sum_total_volume': '29929', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '467.96', 'remain_volume': '0.0', 'fm_state': '20', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 813
此查询区间,上一月最后一天内当前编号下总共抄表记录: 79
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000436'}]
0000000436
00056000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000415')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000436', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 41, 635183), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 11, 11, 7, 831000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 19, 0, 236000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 11, 11, 7, 831000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 19, 0, 236000), 'max_temperature': '21.94', 'min_temperature': '0.0', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 22, 58, 41, 303000), 'min_temp_time': datetime.datetime(2019, 2, 3, 20, 23, 0, 842000), 'max_press': '99.25', 'min_press': '0.0', 'avg_press': '94.0', 'max_press_time': datetime.datetime(2019, 2, 22, 3, 37, 1, 573000), 'min_press_time': datetime.datetime(2019, 2, 3, 20, 23, 0, 842000), 'price': '1.43', 'use_volume_work': '-201324.0', 'use_volume_std': '-179587.0', 'use_money': '-256809.41', 'sum_total_volume': '168211', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3199.14', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '94.0', 'press_out': '94.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 1067
此查询区间,上一月最后一天内当前编号下总共抄表记录: 116
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000437'}]
0000000437
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000421')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000437', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 41, 894762), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '56060', 'work_sum': '60398', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 16, 8, 406000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 14, 24, 669000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 16, 8, 406000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 14, 24, 669000), 'max_temperature': '35.78', 'min_temperature': '18.45', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 2, 23, 21, 36, 1, 454000), 'min_temp_time': datetime.datetime(2019, 2, 28, 6, 20, 0, 52000), 'max_press': '101.15', 'min_press': '94.38', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 2, 20, 17, 18, 46, 548000), 'min_press_time': datetime.datetime(2019, 2, 1, 18, 23, 19, 825000), 'price': '1.46', 'use_volume_work': '7046.0', 'use_volume_std': '6578.0', 'use_money': '9603.88', 'sum_total_volume': '56060', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '21366.52', 'remain_volume': '0.0', 'fm_state': '39', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000015
此查询区间,当前编号下总共抄表记录: 1179
此查询区间,上一月最后一天内当前编号下总共抄表记录: 160
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000438'}]
0000000438
00056000000015
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000430')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000438', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000015', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 42, 254792), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '316722', 'work_sum': '237396', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 1, 56, 10, 74000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 38, 54, 417000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 1, 56, 10, 74000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 38, 54, 417000), 'max_temperature': '16.65', 'min_temperature': '0.0', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 22, 29, 33, 231000), 'min_temp_time': datetime.datetime(2019, 2, 21, 21, 56, 7, 546000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 2, 28, 1, 56, 10, 74000), 'min_press_time': datetime.datetime(2019, 2, 21, 21, 56, 7, 546000), 'price': '1.55', 'use_volume_work': '12139.0', 'use_volume_std': '34656.0', 'use_money': '53716.8', 'sum_total_volume': '237396', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '21624.69', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000015处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 377
此查询区间,上一月最后一天内当前编号下总共抄表记录: 160
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000439'}]
0000000439
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000418')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000439', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 42, 564764), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 5, 31, 320000), 'min_std_flow_time': datetime.datetime(2019, 2, 10, 9, 5, 46, 11000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 5, 31, 320000), 'min_work_flow_time': datetime.datetime(2019, 2, 10, 9, 5, 46, 11000), 'max_temperature': '35.91', 'min_temperature': '0.0', 'avg_temperature': '35.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 22, 5, 31, 320000), 'min_temp_time': datetime.datetime(2019, 2, 10, 9, 5, 46, 11000), 'max_press': '101.32', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 25, 22, 5, 31, 320000), 'min_press_time': datetime.datetime(2019, 2, 10, 9, 5, 46, 11000), 'price': '2.28', 'use_volume_work': '-225257.0', 'use_volume_std': '-282066.0', 'use_money': '-643110.48', 'sum_total_volume': '90353', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '758.55', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000018
此查询区间,当前编号下总共抄表记录: 1374
此查询区间,上一月最后一天内当前编号下总共抄表记录: 212
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000440'}]
0000000440
00056000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000431')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000440', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 42, 864887), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '148885', 'work_sum': '148885', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 37, 781000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 8, 45, 975000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 37, 781000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 8, 45, 975000), 'max_temperature': '19.65', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 21, 17, 54, 40, 350000), 'min_temp_time': datetime.datetime(2019, 2, 7, 23, 11, 43, 194000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 56, 37, 781000), 'min_press_time': datetime.datetime(2019, 2, 7, 23, 11, 43, 194000), 'price': '1.55', 'use_volume_work': '8452.0', 'use_volume_std': '8452.0', 'use_money': '13100.6', 'sum_total_volume': '148885', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '11504.22', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0c', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000019
此查询区间,当前编号下总共抄表记录: 1041
此查询区间,上一月最后一天内当前编号下总共抄表记录: 252
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000441'}]
0000000441
00056000000019
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000422')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000441', 'rtu_no': '00050000000016', 'flmeter_no': '00056000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 43, 154776), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 20, 44, 284000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 32, 55, 341000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 20, 44, 284000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 32, 55, 341000), 'max_temperature': '32.15', 'min_temperature': '0.0', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 2, 20, 12, 41, 49, 583000), 'min_temp_time': datetime.datetime(2019, 2, 4, 11, 32, 55, 341000), 'max_press': '91.12', 'min_press': '0.0', 'avg_press': '89.0', 'max_press_time': datetime.datetime(2019, 2, 25, 9, 13, 3, 171000), 'min_press_time': datetime.datetime(2019, 2, 4, 2, 59, 57, 357000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '175768', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '15276.5', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '89.0', 'press_out': '89.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000019处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 1029
此查询区间,上一月最后一天内当前编号下总共抄表记录: 289
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000442'}]
0000000442
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000426')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000442', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 43, 434768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 32, 26, 794000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 17, 23, 996000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 32, 26, 794000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 17, 23, 996000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 32, 26, 794000), 'min_temp_time': datetime.datetime(2019, 2, 2, 1, 17, 23, 996000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 32, 26, 794000), 'min_press_time': datetime.datetime(2019, 2, 2, 1, 17, 23, 996000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '46488', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5240.76', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 988
此查询区间,上一月最后一天内当前编号下总共抄表记录: 319
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000443'}]
0000000443
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000432')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000443', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 43, 704886), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 37, 12, 157000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 2, 29, 40, 57000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 37, 12, 157000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 2, 29, 40, 57000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 37, 12, 157000), 'min_temp_time': datetime.datetime(2019, 2, 4, 2, 29, 40, 57000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 37, 12, 157000), 'min_press_time': datetime.datetime(2019, 2, 4, 2, 29, 40, 57000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '3730', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '69000.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '06', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 472
此查询区间,上一月最后一天内当前编号下总共抄表记录: 338
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000444'}]
0000000444
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000416')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000444', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 43, 984771), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '227390', 'work_sum': '227390', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 6, 29, 44, 376000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 53, 37, 465000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 6, 29, 44, 376000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 53, 37, 465000), 'max_temperature': '21.48', 'min_temperature': '9.76', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 13, 13, 57, 56, 370000), 'min_temp_time': datetime.datetime(2019, 2, 1, 6, 14, 13, 903000), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 2, 26, 6, 29, 44, 376000), 'min_press_time': datetime.datetime(2019, 2, 2, 0, 53, 37, 465000), 'price': '1.43', 'use_volume_work': '23328.0', 'use_volume_std': '23328.0', 'use_money': '33359.04', 'sum_total_volume': '227390', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '12466.47', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 323
此查询区间,上一月最后一天内当前编号下总共抄表记录: 338
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000445'}]
0000000445
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000419')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000445', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 44, 354733), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 43, 14, 52000), 'min_std_flow_time': datetime.datetime(2019, 2, 21, 9, 56, 38, 790000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 43, 14, 52000), 'min_work_flow_time': datetime.datetime(2019, 2, 21, 9, 56, 38, 790000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 43, 14, 52000), 'min_temp_time': datetime.datetime(2019, 2, 21, 9, 56, 38, 790000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 43, 14, 52000), 'min_press_time': datetime.datetime(2019, 2, 21, 9, 56, 38, 790000), 'price': '2.28', 'use_volume_work': '-204062.0', 'use_volume_std': '-204062.0', 'use_money': '-465261.36', 'sum_total_volume': '83384', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '4721.8', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 911
此查询区间,上一月最后一天内当前编号下总共抄表记录: 369
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000446'}]
0000000446
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000424')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000446', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 44, 624734), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '93783', 'work_sum': '105211', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 47, 11, 899000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 29, 14, 289000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 47, 11, 899000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 29, 14, 289000), 'max_temperature': '26.28', 'min_temperature': '11.37', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 2, 14, 1, 2, 59, 960000), 'min_temp_time': datetime.datetime(2019, 2, 20, 7, 41, 12, 481000), 'max_press': '98.23', 'min_press': '87.19', 'avg_press': '95.0', 'max_press_time': datetime.datetime(2019, 2, 9, 22, 51, 51, 547000), 'min_press_time': datetime.datetime(2019, 2, 19, 19, 38, 51, 368000), 'price': '1.52', 'use_volume_work': '-98851.0', 'use_volume_std': '-110279.0', 'use_money': '-167624.08', 'sum_total_volume': '98300', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '8535700.0', 'remain_volume': '0.0', 'fm_state': '21', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '36', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '95.0', 'press_out': '95.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000016
此查询区间,当前编号下总共抄表记录: 1136
此查询区间,上一月最后一天内当前编号下总共抄表记录: 415
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000447'}]
0000000447
00056000000016
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000428')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000447', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 44, 934734), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '441599', 'work_sum': '257811', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 35, 672000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 38, 55, 214000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 35, 672000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 38, 55, 214000), 'max_temperature': '83.5', 'min_temperature': '0.0', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 24, 19, 35, 33, 551000), 'min_temp_time': datetime.datetime(2019, 2, 19, 18, 56, 35, 709000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 56, 35, 672000), 'min_press_time': datetime.datetime(2019, 2, 19, 18, 56, 35, 709000), 'price': '1.55', 'use_volume_work': '53749.0', 'use_volume_std': '237537.0', 'use_money': '368182.35', 'sum_total_volume': '257811', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13928.65', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000016处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 222
此查询区间,上一月最后一天内当前编号下总共抄表记录: 415
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000448'}]
0000000448
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000425')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000448', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 45, 204769), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 18, 16, 10, 197000), 'min_std_flow_time': datetime.datetime(2019, 2, 24, 16, 7, 55, 140000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 18, 16, 10, 197000), 'min_work_flow_time': datetime.datetime(2019, 2, 24, 16, 7, 55, 140000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 27, 18, 16, 10, 197000), 'min_temp_time': datetime.datetime(2019, 2, 24, 16, 7, 55, 140000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 27, 18, 16, 10, 197000), 'min_press_time': datetime.datetime(2019, 2, 24, 16, 7, 55, 140000), 'price': '1.61', 'use_volume_work': '-204062.0', 'use_volume_std': '-204062.0', 'use_money': '-328539.82', 'sum_total_volume': '23771', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '8146.29', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 434
此查询区间,上一月最后一天内当前编号下总共抄表记录: 449
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000449'}]
0000000449
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000420')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000449', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 45, 514735), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 7, 17, 306000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 45, 21, 215000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 7, 17, 306000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 45, 21, 215000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 7, 17, 306000), 'min_temp_time': datetime.datetime(2019, 2, 2, 0, 45, 21, 215000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 7, 17, 306000), 'min_press_time': datetime.datetime(2019, 2, 2, 0, 45, 21, 215000), 'price': '1.61', 'use_volume_work': '-204062.0', 'use_volume_std': '-204062.0', 'use_money': '-328539.82', 'sum_total_volume': '5700', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '137.7', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 925
此查询区间,上一月最后一天内当前编号下总共抄表记录: 482
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000450'}]
0000000450
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000417')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000450', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 45, 804770), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '601014', 'work_sum': '601014', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 18, 55, 81000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 53, 55, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 18, 55, 81000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 53, 55, 840000), 'max_temperature': '19.58', 'min_temperature': '5.57', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 13, 21, 8, 46, 602000), 'min_temp_time': datetime.datetime(2019, 2, 10, 9, 40, 6, 71000), 'max_press': '84.0', 'min_press': '84.0', 'avg_press': '84.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 18, 55, 81000), 'min_press_time': datetime.datetime(2019, 2, 2, 1, 53, 55, 840000), 'price': '1.52', 'use_volume_work': '396952.0', 'use_volume_std': '396952.0', 'use_money': '603367.04', 'sum_total_volume': '601014', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '6374.5', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '84.0', 'press_out': '84.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
0005 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0007
💗 I am main()
总共抄表数据: 10
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 1
0007 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00076000000001
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一月最后一天内当前编号下总共抄表记录: 1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0007', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0007', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000015'}]
0000000015
00076000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0007', '00072019020000000014')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0007', 'srm_id': '00072019020000000015', 'rtu_no': '00070000000001', 'flmeter_no': '00076000000001', 'customer_no': '00070000000001', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 46, 184744), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '781', 'work_sum': '777', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 8, 23, 32, 20, 694000), 'min_std_flow_time': datetime.datetime(2019, 2, 1, 23, 32, 1, 996000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 8, 23, 32, 20, 694000), 'min_work_flow_time': datetime.datetime(2019, 2, 1, 23, 32, 1, 996000), 'max_temperature': '12.4', 'min_temperature': '1.5', 'avg_temperature': '6.0', 'max_temp_time': datetime.datetime(2019, 2, 2, 23, 32, 4, 512000), 'min_temp_time': datetime.datetime(2019, 2, 8, 23, 32, 20, 694000), 'max_press': '103.4', 'min_press': '98.3', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 2, 23, 32, 4, 512000), 'min_press_time': datetime.datetime(2019, 2, 8, 23, 32, 20, 694000), 'price': '3.09', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 103.0, 'total_buy_volume': None, 'total_buy_money': '2192', 'remain_money': '2089', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '6.0', 'temp_out': '6.0', 'rssi': '10.0', 'srm_status': '1'}]
insert sys_serial_no ok
00076000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0007 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0009
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0009 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0011
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0011 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0012
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0012 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0016
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0016 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0003
💗 I am main()
总共抄表数据: 16121
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 537
0003 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 47
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00036000000008
此查询区间,当前编号下总共抄表记录: 70
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000584'}]
0000000584
00036000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000541')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000584', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 47, 774734), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 13, 16, 58, 29, 653000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 37, 29, 851000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 13, 16, 58, 29, 653000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 37, 29, 851000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 13, 16, 58, 29, 653000), 'min_temp_time': datetime.datetime(2019, 2, 4, 12, 37, 29, 851000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 13, 16, 58, 29, 653000), 'min_press_time': datetime.datetime(2019, 2, 4, 12, 37, 29, 851000), 'price': '0.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '48385', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '51686.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '81', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000055
此查询区间,当前编号下总共抄表记录: 84
此查询区间,上一月最后一天内当前编号下总共抄表记录: 6
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000585'}]
0000000585
00036000000055
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000569')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000585', 'rtu_no': '00030000000097', 'flmeter_no': '00036000000055', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 48, 64778), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 23, 43, 516000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 52, 21, 856000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 23, 43, 516000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 52, 21, 856000), 'max_temperature': '11.3', 'min_temperature': '9.1', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 18, 30, 56, 733000), 'min_temp_time': datetime.datetime(2019, 2, 17, 0, 51, 21, 228000), 'max_press': '103.0', 'min_press': '97.7', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 12, 0, 51, 35, 891000), 'min_press_time': datetime.datetime(2019, 2, 28, 22, 32, 27, 852000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 8.0, 'total_buy_volume': None, 'total_buy_money': '16', 'remain_money': '8', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000055处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000072
此查询区间,当前编号下总共抄表记录: 559
此查询区间,上一月最后一天内当前编号下总共抄表记录: 34
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000586'}]
0000000586
00036000000072
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000578')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000586', 'rtu_no': '00030000000115', 'flmeter_no': '00036000000072', 'customer_no': '00030000000002', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 48, 424731), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 58, 55, 607000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 49, 39, 414000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 58, 55, 607000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 49, 39, 414000), 'max_temperature': '20.4', 'min_temperature': '8.9', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 22, 1, 21, 36, 242000), 'min_temp_time': datetime.datetime(2019, 2, 11, 7, 20, 14, 316000), 'max_press': '103.3', 'min_press': '94.8', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 10, 20, 46, 983000), 'min_press_time': datetime.datetime(2019, 2, 26, 15, 50, 45, 363000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000072处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000059
此查询区间,当前编号下总共抄表记录: 458
此查询区间,上一月最后一天内当前编号下总共抄表记录: 36
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000587'}]
0000000587
00036000000059
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000562')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000587', 'rtu_no': '00030000000101', 'flmeter_no': '00036000000059', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 48, 714763), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 5, 34, 836000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 29, 46, 856000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 5, 34, 836000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 29, 46, 856000), 'max_temperature': '23.9', 'min_temperature': '8.0', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 16, 10, 57, 162000), 'min_temp_time': datetime.datetime(2019, 2, 12, 7, 24, 50, 17000), 'max_press': '105.3', 'min_press': '100.7', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 21, 19, 28, 16, 232000), 'min_press_time': datetime.datetime(2019, 2, 3, 1, 36, 19, 200000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000059处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000044
此查询区间,当前编号下总共抄表记录: 531
此查询区间,上一月最后一天内当前编号下总共抄表记录: 56
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000588'}]
0000000588
00036000000044
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000571')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000588', 'rtu_no': '00030000000085', 'flmeter_no': '00036000000044', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 49, 94733), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 50, 1, 354000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 28, 7, 320000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 50, 1, 354000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 28, 7, 320000), 'max_temperature': '8.4', 'min_temperature': '1.2', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 23, 34, 10, 772000), 'min_temp_time': datetime.datetime(2019, 2, 9, 11, 25, 59, 653000), 'max_press': '105.9', 'min_press': '101.1', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 2, 9, 11, 25, 59, 653000), 'min_press_time': datetime.datetime(2019, 2, 2, 14, 26, 8, 481000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '5.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000044处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000052
此查询区间,当前编号下总共抄表记录: 563
此查询区间,上一月最后一天内当前编号下总共抄表记录: 79
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000589'}]
0000000589
00036000000052
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000575')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000589', 'rtu_no': '00030000000094', 'flmeter_no': '00036000000052', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 49, 734745), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '3902', 'work_sum': '3747', 'max_std_flow': '15.46', 'min_std_flow': '0.0', 'avg_std_flow': '2.0', 'max_std_flow_time': datetime.datetime(2019, 2, 15, 5, 24, 10, 800000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 14, 26, 38, 59000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 29, 57, 635000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 15, 32, 14, 836000), 'max_temperature': '25.6', 'min_temperature': '11.3', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 2, 24, 13, 26, 25, 923000), 'min_temp_time': datetime.datetime(2019, 2, 20, 7, 24, 13, 966000), 'max_press': '106.7', 'min_press': '96.5', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 2, 14, 3, 22, 51, 651000), 'min_press_time': datetime.datetime(2019, 2, 5, 10, 24, 54, 231000), 'price': '1.0', 'use_volume_work': '3747.0', 'use_volume_std': '3902.0', 'use_money': '3902.0', 'sum_total_volume': None, 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '1.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000052处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000048
此查询区间,当前编号下总共抄表记录: 245
此查询区间,上一月最后一天内当前编号下总共抄表记录: 85
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000590'}]
0000000590
00036000000048
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000557')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000590', 'rtu_no': '00030000000090', 'flmeter_no': '00036000000048', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 50, 544769), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 24, 9, 313000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 19, 965000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 24, 9, 313000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 19, 965000), 'max_temperature': '17.7', 'min_temperature': '13.6', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 23, 33, 35, 272000), 'min_temp_time': datetime.datetime(2019, 2, 11, 3, 24, 2, 342000), 'max_press': '103.3', 'min_press': '94.4', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 14, 0, 21, 11, 178000), 'min_press_time': datetime.datetime(2019, 2, 24, 1, 23, 5, 80000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000048处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000050
此查询区间,当前编号下总共抄表记录: 818
此查询区间,上一月最后一天内当前编号下总共抄表记录: 116
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000591'}]
0000000591
00036000000050
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000551')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000591', 'rtu_no': '00030000000092', 'flmeter_no': '00036000000050', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 50, 914783), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 11, 15, 511000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 18, 40, 737000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 11, 15, 511000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 18, 40, 737000), 'max_temperature': '20.9', 'min_temperature': '7.6', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 13, 9, 34, 340000), 'min_temp_time': datetime.datetime(2019, 2, 12, 5, 0, 9, 711000), 'max_press': '103.3', 'min_press': '77.4', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 9, 55, 36, 426000), 'min_press_time': datetime.datetime(2019, 2, 2, 8, 7, 46, 543000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000050处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000022
此查询区间,当前编号下总共抄表记录: 208
此查询区间,上一月最后一天内当前编号下总共抄表记录: 128
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000592'}]
0000000592
00036000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000549')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000592', 'rtu_no': None, 'flmeter_no': '00036000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 51, 204793), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '1511546.680', 'work_sum': '431435.100', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 24), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 24), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_temperature': '19.867', 'min_temperature': '1.428', 'avg_temperature': '7.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 16, 0, 22), 'min_temp_time': datetime.datetime(2019, 2, 2, 4, 0, 25), 'max_press': '120.811', 'min_press': '110.621', 'avg_press': '114.0', 'max_press_time': datetime.datetime(2019, 2, 1, 0, 0, 25), 'min_press_time': datetime.datetime(2019, 2, 21, 6, 0, 20), 'price': '0.000', 'use_volume_work': '431435.1', 'use_volume_std': '1511546.68', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '114.0', 'press_out': '114.0', 'temp_in': '7.0', 'temp_out': '7.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 773
此查询区间,上一月最后一天内当前编号下总共抄表记录: 167
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000593'}]
0000000593
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000545')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000593', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 51, 514768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '247', 'work_sum': '253', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 24, 35, 834000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 15, 45, 86000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 24, 35, 834000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 15, 45, 86000), 'max_temperature': '21.65', 'min_temperature': '10.53', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 22, 17, 12, 54, 293000), 'min_temp_time': datetime.datetime(2019, 2, 18, 6, 17, 48, 735000), 'max_press': '102.52', 'min_press': '100.21', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 13, 8, 44, 48, 912000), 'min_press_time': datetime.datetime(2019, 2, 2, 17, 58, 21, 418000), 'price': '3.5', 'use_volume_work': '84.0', 'use_volume_std': '84.0', 'use_money': '294.0', 'sum_total_volume': '247', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '11.0', 'remain_volume': '0.0', 'fm_state': '25', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '81', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000038
此查询区间,当前编号下总共抄表记录: 94
此查询区间,上一月最后一天内当前编号下总共抄表记录: 168
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000594'}]
0000000594
00036000000038
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000554')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000594', 'rtu_no': '00030000000079', 'flmeter_no': '00036000000038', 'customer_no': '00030000000016', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 51, 824899), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 20, 27, 24, 182000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 45, 8, 12000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 20, 27, 24, 182000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 45, 8, 12000), 'max_temperature': '9.5', 'min_temperature': '-0.2', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 21, 32, 22, 537000), 'min_temp_time': datetime.datetime(2019, 2, 9, 10, 45, 50, 685000), 'max_press': '103.8', 'min_press': '100.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 14, 1, 22, 39, 61000), 'min_press_time': datetime.datetime(2019, 2, 2, 14, 47, 23, 371000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000038处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000067
此查询区间,当前编号下总共抄表记录: 561
此查询区间,上一月最后一天内当前编号下总共抄表记录: 196
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000595'}]
0000000595
00036000000067
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000579')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000595', 'rtu_no': '00030000000109', 'flmeter_no': '00036000000067', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 52, 244784), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 3, 7, 3, 329000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 21, 45, 822000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 3, 7, 3, 329000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 21, 45, 822000), 'max_temperature': '22.7', 'min_temperature': '9.2', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 20, 10, 25, 583000), 'min_temp_time': datetime.datetime(2019, 2, 17, 1, 22, 37, 72000), 'max_press': '105.1', 'min_press': '100.7', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 28, 2, 6, 53, 54000), 'min_press_time': datetime.datetime(2019, 2, 7, 3, 33, 8, 687000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000067处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000060
此查询区间,当前编号下总共抄表记录: 474
此查询区间,上一月最后一天内当前编号下总共抄表记录: 220
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000596'}]
0000000596
00036000000060
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000570')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000596', 'rtu_no': '00030000000102', 'flmeter_no': '00036000000060', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 52, 534884), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 18, 25, 31, 831000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 25, 23, 446000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 18, 25, 31, 831000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 25, 23, 446000), 'max_temperature': '11.5', 'min_temperature': '9.1', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 7, 9, 24, 31, 575000), 'min_temp_time': datetime.datetime(2019, 2, 17, 8, 26, 3, 810000), 'max_press': '103.3', 'min_press': '99.8', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 9, 24, 25, 711000), 'min_press_time': datetime.datetime(2019, 2, 2, 14, 25, 58, 528000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000060处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000061
此查询区间,当前编号下总共抄表记录: 713
此查询区间,上一月最后一天内当前编号下总共抄表记录: 244
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000597'}]
0000000597
00036000000061
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000561')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000597', 'rtu_no': '00030000000103', 'flmeter_no': '00036000000061', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 52, 844881), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 18, 36, 4, 69000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 25, 38, 759000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 18, 36, 4, 69000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 25, 38, 759000), 'max_temperature': '11.6', 'min_temperature': '9.2', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 7, 8, 24, 2, 153000), 'min_temp_time': datetime.datetime(2019, 2, 17, 2, 22, 36, 469000), 'max_press': '127.9', 'min_press': '100.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 5, 11, 24, 57, 926000), 'min_press_time': datetime.datetime(2019, 2, 2, 19, 28, 27, 12000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000061处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000007
此查询区间,当前编号下总共抄表记录: 44
此查询区间,上一月最后一天内当前编号下总共抄表记录: 244
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000598'}]
0000000598
00036000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000572')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000598', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 53, 164768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '64', 'work_sum': '66', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 13, 12, 52, 35, 119000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 13, 7, 36, 39000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 13, 12, 52, 35, 119000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 13, 7, 36, 39000), 'max_temperature': '26.96', 'min_temperature': '26.96', 'avg_temperature': '26.0', 'max_temp_time': datetime.datetime(2019, 2, 13, 12, 52, 35, 119000), 'min_temp_time': datetime.datetime(2019, 2, 4, 13, 7, 36, 39000), 'max_press': '100.15', 'min_press': '100.15', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 13, 12, 52, 35, 119000), 'min_press_time': datetime.datetime(2019, 2, 4, 13, 7, 36, 39000), 'price': '0.0', 'use_volume_work': '-103.0', 'use_volume_std': '-99.0', 'use_money': '-0.0', 'sum_total_volume': '60498', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '39566.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '81', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '26.0', 'temp_out': '26.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000037
此查询区间,当前编号下总共抄表记录: 40
此查询区间,上一月最后一天内当前编号下总共抄表记录: 245
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000599'}]
0000000599
00036000000037
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000577')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000599', 'rtu_no': '00030000000064', 'flmeter_no': '00036000000037', 'customer_no': '00030000000018', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 53, 454751), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 16, 34, 52, 932000), 'min_std_flow_time': datetime.datetime(2019, 2, 3, 0, 20, 51, 965000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 16, 34, 52, 932000), 'min_work_flow_time': datetime.datetime(2019, 2, 3, 0, 20, 51, 965000), 'max_temperature': '12.7', 'min_temperature': '9.3', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 16, 34, 52, 932000), 'min_temp_time': datetime.datetime(2019, 2, 17, 0, 21, 2, 367000), 'max_press': '102.9', 'min_press': '100.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 0, 20, 45, 54000), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 20, 51, 965000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 6.0, 'total_buy_volume': None, 'total_buy_money': '6', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000037处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000066
此查询区间,当前编号下总共抄表记录: 117
此查询区间,上一月最后一天内当前编号下总共抄表记录: 245
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000600'}]
0000000600
00036000000066
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000582')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000600', 'rtu_no': '00030000000108', 'flmeter_no': '00036000000066', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 53, 744765), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '534', 'work_sum': '492', 'max_std_flow': '3.28', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 10, 25, 3, 856000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 25, 19, 818000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 11, 24, 38, 903000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 25, 19, 818000), 'max_temperature': '23.6', 'min_temperature': '4.4', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 24, 13, 25, 8, 329000), 'min_temp_time': datetime.datetime(2019, 2, 20, 5, 23, 18, 986000), 'max_press': '113.6', 'min_press': '100.7', 'avg_press': '108.0', 'max_press_time': datetime.datetime(2019, 2, 6, 16, 26, 11, 348000), 'min_press_time': datetime.datetime(2019, 2, 25, 5, 23, 49, 289000), 'price': '1.0', 'use_volume_work': '323.0', 'use_volume_std': '371.0', 'use_money': '371.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '108.0', 'press_out': '108.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '20.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000066处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000040
此查询区间,当前编号下总共抄表记录: 151
此查询区间,上一月最后一天内当前编号下总共抄表记录: 246
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000601'}]
0000000601
00036000000040
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000548')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000601', 'rtu_no': '00030000000081', 'flmeter_no': '00036000000040', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 54, 74768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 1, 23, 13, 181000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 12, 168000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 1, 23, 13, 181000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 12, 168000), 'max_temperature': '25.4', 'min_temperature': '1.2', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 15, 21, 45, 718000), 'min_temp_time': datetime.datetime(2019, 2, 9, 0, 21, 5, 260000), 'max_press': '103.9', 'min_press': '101.1', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 26, 9, 24, 56, 746000), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 20, 56, 153000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '6', 'remain_money': '6', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '29.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000040处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000051
此查询区间,当前编号下总共抄表记录: 202
此查询区间,上一月最后一天内当前编号下总共抄表记录: 259
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000602'}]
0000000602
00036000000051
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000580')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000602', 'rtu_no': '00030000000093', 'flmeter_no': '00036000000051', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 54, 504897), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 22, 17, 314000), 'min_std_flow_time': datetime.datetime(2019, 2, 3, 0, 21, 34, 715000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 22, 17, 314000), 'min_work_flow_time': datetime.datetime(2019, 2, 3, 0, 21, 34, 715000), 'max_temperature': '17.8', 'min_temperature': '13.7', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 20, 27, 35, 721000), 'min_temp_time': datetime.datetime(2019, 2, 11, 0, 20, 59, 304000), 'max_press': '112.2', 'min_press': '101.2', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 2, 23, 5, 22, 41, 95000), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 21, 34, 715000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '4.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000051处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000021
此查询区间,当前编号下总共抄表记录: 22
此查询区间,上一月最后一天内当前编号下总共抄表记录: 259
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000603'}]
0000000603
00036000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000547')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000603', 'rtu_no': '00030000000055', 'flmeter_no': '00036000000021', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 54, 824780), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.37', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 18, 6, 22, 980000), 'min_std_flow_time': datetime.datetime(2019, 2, 25, 0, 21, 8, 671000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 15, 14, 28, 79000), 'min_work_flow_time': datetime.datetime(2019, 2, 25, 0, 21, 8, 671000), 'max_temperature': '20.4', 'min_temperature': '10.7', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 26, 14, 10, 16, 544000), 'min_temp_time': datetime.datetime(2019, 2, 27, 0, 21, 2, 338000), 'max_press': '102.9', 'min_press': '90.2', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 23, 0, 21, 34, 975000), 'min_press_time': datetime.datetime(2019, 2, 25, 16, 6, 1, 206000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000077
此查询区间,当前编号下总共抄表记录: 812
此查询区间,上一月最后一天内当前编号下总共抄表记录: 289
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000604'}]
0000000604
00036000000077
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000567')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000604', 'rtu_no': '00030000000118', 'flmeter_no': '00036000000077', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 55, 154768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1.88', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 19, 32, 29, 688000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 56, 15, 567000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 43, 50, 38000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 56, 15, 567000), 'max_temperature': '20.4', 'min_temperature': '8.8', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 23, 33, 33, 749000), 'min_temp_time': datetime.datetime(2019, 2, 11, 7, 27, 7, 112000), 'max_press': '104.2', 'min_press': '95.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 1, 26, 1, 834000), 'min_press_time': datetime.datetime(2019, 2, 28, 15, 46, 13, 317000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000077处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000058
此查询区间,当前编号下总共抄表记录: 820
此查询区间,上一月最后一天内当前编号下总共抄表记录: 313
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000605'}]
0000000605
00036000000058
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000581')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000605', 'rtu_no': '00030000000100', 'flmeter_no': '00036000000058', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 55, 444767), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 32, 9, 528000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 24, 21, 525000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 32, 9, 528000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 24, 21, 525000), 'max_temperature': '17.8', 'min_temperature': '13.9', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 24, 23, 32, 59, 879000), 'min_temp_time': datetime.datetime(2019, 2, 11, 8, 25, 49, 189000), 'max_press': '118.2', 'min_press': '101.0', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 2, 28, 11, 23, 22, 655000), 'min_press_time': datetime.datetime(2019, 2, 2, 14, 24, 39, 981000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '21.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000058处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000045
此查询区间,当前编号下总共抄表记录: 327
此查询区间,上一月最后一天内当前编号下总共抄表记录: 315
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000606'}]
0000000606
00036000000045
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000546')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000606', 'rtu_no': '00030000000086', 'flmeter_no': '00036000000045', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 55, 834816), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '759', 'work_sum': '757', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 20, 19, 0, 96000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 10, 15, 47, 903000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 20, 19, 0, 96000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 10, 15, 47, 903000), 'max_temperature': '18.6', 'min_temperature': '18.6', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 2, 26, 20, 19, 0, 96000), 'min_temp_time': datetime.datetime(2019, 2, 2, 10, 15, 47, 903000), 'max_press': '102.2', 'min_press': '102.2', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 26, 20, 19, 0, 96000), 'min_press_time': datetime.datetime(2019, 2, 2, 10, 15, 47, 903000), 'price': '1.0', 'use_volume_work': '588.0', 'use_volume_std': '596.0', 'use_money': '596.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '40', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000045处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000075
此查询区间,当前编号下总共抄表记录: 770
此查询区间,上一月最后一天内当前编号下总共抄表记录: 317
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000607'}]
0000000607
00036000000075
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000573')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000607', 'rtu_no': '00030000000117', 'flmeter_no': '00036000000075', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 56, 291356), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 17, 19, 46, 166000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 11, 684000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 17, 19, 46, 166000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 11, 684000), 'max_temperature': '20.6', 'min_temperature': '8.8', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 20, 11, 44, 244000), 'min_temp_time': datetime.datetime(2019, 2, 11, 7, 48, 16, 206000), 'max_press': '163.7', 'min_press': '101.1', 'avg_press': '107.0', 'max_press_time': datetime.datetime(2019, 2, 13, 6, 56, 27, 51000), 'min_press_time': datetime.datetime(2019, 2, 3, 1, 21, 39, 325000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '107.0', 'press_out': '107.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '12.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000075处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000018
此查询区间,当前编号下总共抄表记录: 119
此查询区间,上一月最后一天内当前编号下总共抄表记录: 317
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000608'}]
0000000608
00036000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000574')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000608', 'rtu_no': '00030000000049', 'flmeter_no': '00036000000018', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 56, 621388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '333', 'work_sum': '123', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 18, 31, 56, 19000), 'min_std_flow_time': datetime.datetime(2019, 2, 22, 13, 46, 45, 52000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 18, 31, 56, 19000), 'min_work_flow_time': datetime.datetime(2019, 2, 22, 13, 46, 45, 52000), 'max_temperature': '25.7', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 19, 46, 58, 81000), 'min_temp_time': datetime.datetime(2019, 2, 22, 11, 30, 22, 191000), 'max_press': '101.8', 'min_press': '0.0', 'avg_press': '78.0', 'max_press_time': datetime.datetime(2019, 2, 26, 16, 58, 54, 109000), 'min_press_time': datetime.datetime(2019, 2, 22, 11, 30, 22, 191000), 'price': '2.5', 'use_volume_work': '-46.0', 'use_volume_std': '170.0', 'use_money': '425.0', 'sum_total_volume': None, 'sum_total_money': 1399.0, 'total_buy_volume': None, 'total_buy_money': '2500', 'remain_money': '1101', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '78.0', 'press_out': '78.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '8.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000064
此查询区间,当前编号下总共抄表记录: 411
此查询区间,上一月最后一天内当前编号下总共抄表记录: 341
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000609'}]
0000000609
00036000000064
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000540')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000609', 'rtu_no': '00030000000106', 'flmeter_no': '00036000000064', 'customer_no': '00030000000046', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 56, 971388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 3, 23, 4, 944000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 3, 22, 25, 349000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 3, 23, 4, 944000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 3, 22, 25, 349000), 'max_temperature': '11.4', 'min_temperature': '9.0', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 7, 2, 22, 22, 161000), 'min_temp_time': datetime.datetime(2019, 2, 17, 10, 23, 25, 610000), 'max_press': '103.0', 'min_press': '76.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 11, 1, 21, 12, 447000), 'min_press_time': datetime.datetime(2019, 2, 3, 2, 21, 48, 762000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000064处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000020
此查询区间,当前编号下总共抄表记录: 35
此查询区间,上一月最后一天内当前编号下总共抄表记录: 341
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000610'}]
0000000610
00036000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000543')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000610', 'rtu_no': '00030000000051', 'flmeter_no': '00036000000020', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 57, 291517), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 11, 51, 58, 854000), 'min_std_flow_time': datetime.datetime(2019, 2, 24, 14, 1, 5, 302000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 11, 51, 58, 854000), 'min_work_flow_time': datetime.datetime(2019, 2, 24, 14, 1, 5, 302000), 'max_temperature': '24.0', 'min_temperature': '0.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 15, 22, 28, 95000), 'min_temp_time': datetime.datetime(2019, 2, 24, 14, 1, 5, 302000), 'max_press': '102.9', 'min_press': '0.0', 'avg_press': '55.0', 'max_press_time': datetime.datetime(2019, 2, 25, 14, 12, 17, 396000), 'min_press_time': datetime.datetime(2019, 2, 24, 14, 1, 5, 302000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '50', 'press_in': '55.0', 'press_out': '55.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000028
此查询区间,当前编号下总共抄表记录: 209
此查询区间,上一月最后一天内当前编号下总共抄表记录: 353
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000611'}]
0000000611
00036000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000558')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000611', 'rtu_no': None, 'flmeter_no': '00036000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 57, 611499), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '311644.480', 'work_sum': '287074.660', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 23), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 23), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 18, 0, 23), 'min_temp_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_press': '101.325', 'min_press': '101.325', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 28, 18, 0, 23), 'min_press_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'price': '0.000', 'use_volume_work': '286905.66', 'use_volume_std': '311481.48', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000068
此查询区间,当前编号下总共抄表记录: 873
此查询区间,上一月最后一天内当前编号下总共抄表记录: 378
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000612'}]
0000000612
00036000000068
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000552')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000612', 'rtu_no': '00030000000110', 'flmeter_no': '00036000000068', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 57, 961386), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '2', 'work_sum': '2', 'max_std_flow': '4.71', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 15, 15, 58, 45, 397000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 57, 13, 575000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 52, 36, 122000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 57, 13, 575000), 'max_temperature': '22.3', 'min_temperature': '7.6', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 23, 6, 41, 40, 618000), 'min_temp_time': datetime.datetime(2019, 2, 12, 5, 44, 1, 997000), 'max_press': '106.3', 'min_press': '100.7', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 20, 16, 30, 35, 769000), 'min_press_time': datetime.datetime(2019, 2, 7, 3, 20, 33, 968000), 'price': '1.0', 'use_volume_work': '2.0', 'use_volume_std': '2.0', 'use_money': '2.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000068处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000012
此查询区间,当前编号下总共抄表记录: 51
此查询区间,上一月最后一天内当前编号下总共抄表记录: 381
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000613'}]
0000000613
00036000000012
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000544')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000613', 'rtu_no': '00030000000043', 'flmeter_no': '00036000000012', 'customer_no': '00030000000005', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 58, 291356), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '6837', 'work_sum': '6828', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 1, 20, 37, 895000), 'min_std_flow_time': datetime.datetime(2019, 2, 1, 1, 20, 40, 356000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 1, 20, 37, 895000), 'min_work_flow_time': datetime.datetime(2019, 2, 1, 1, 20, 40, 356000), 'max_temperature': '19.6', 'min_temperature': '9.0', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 22, 14, 36, 45, 528000), 'min_temp_time': datetime.datetime(2019, 2, 11, 1, 21, 27, 165000), 'max_press': '103.0', 'min_press': '100.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 1, 21, 27, 165000), 'min_press_time': datetime.datetime(2019, 2, 3, 1, 20, 50, 590000), 'price': '1.0', 'use_volume_work': '6828.0', 'use_volume_std': '6837.0', 'use_money': '6837.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2999', 'remain_money': '2999', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000012处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000073
此查询区间,当前编号下总共抄表记录: 405
此查询区间,上一月最后一天内当前编号下总共抄表记录: 395
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000614'}]
0000000614
00036000000073
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000550')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000614', 'rtu_no': '00030000000116', 'flmeter_no': '00036000000073', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 58, 741358), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 1, 22, 36, 447000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 14, 965000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 1, 22, 36, 447000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 14, 965000), 'max_temperature': '20.2', 'min_temperature': '8.8', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 22, 1, 21, 24, 805000), 'min_temp_time': datetime.datetime(2019, 2, 12, 7, 17, 52, 826000), 'max_press': '103.1', 'min_press': '99.7', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 11, 11, 13, 56, 100000), 'min_press_time': datetime.datetime(2019, 2, 7, 8, 54, 53, 43000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000073处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000043
此查询区间,当前编号下总共抄表记录: 188
此查询区间,上一月最后一天内当前编号下总共抄表记录: 404
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000615'}]
0000000615
00036000000043
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000560')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000615', 'rtu_no': '00030000000084', 'flmeter_no': '00036000000043', 'customer_no': '00030000000035', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 59, 91403), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 31, 50, 778000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 29, 0, 155000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 31, 50, 778000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 29, 0, 155000), 'max_temperature': '8.3', 'min_temperature': '0.6', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 1, 21, 58, 963000), 'min_temp_time': datetime.datetime(2019, 2, 9, 13, 24, 27, 530000), 'max_press': '103.6', 'min_press': '86.9', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 13, 22, 28, 21, 763000), 'min_press_time': datetime.datetime(2019, 2, 22, 2, 22, 10, 14000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '7.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000043处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000062
此查询区间,当前编号下总共抄表记录: 296
此查询区间,上一月最后一天内当前编号下总共抄表记录: 428
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000616'}]
0000000616
00036000000062
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000553')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000616', 'rtu_no': '00030000000104', 'flmeter_no': '00036000000062', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 59, 361386), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 25, 32, 813000), 'min_std_flow_time': datetime.datetime(2019, 2, 1, 12, 25, 40, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 25, 32, 813000), 'min_work_flow_time': datetime.datetime(2019, 2, 1, 12, 25, 40, 840000), 'max_temperature': '17.9', 'min_temperature': '14.2', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 19, 31, 33, 600000), 'min_temp_time': datetime.datetime(2019, 2, 11, 10, 22, 39, 140000), 'max_press': '105.4', 'min_press': '100.1', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 7, 22, 25, 49, 817000), 'min_press_time': datetime.datetime(2019, 2, 28, 15, 29, 25, 199000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 899.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '99', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '10.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000062处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000047
此查询区间,当前编号下总共抄表记录: 70
此查询区间,上一月最后一天内当前编号下总共抄表记录: 428
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000617'}]
0000000617
00036000000047
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000559')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000617', 'rtu_no': '00030000000089', 'flmeter_no': '00036000000047', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 59, 641387), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '12', 'work_sum': '12', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 22, 31, 52, 505000), 'min_std_flow_time': datetime.datetime(2019, 2, 21, 9, 55, 11, 40000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 22, 31, 52, 505000), 'min_work_flow_time': datetime.datetime(2019, 2, 21, 9, 55, 11, 40000), 'max_temperature': '24.8', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 26, 14, 26, 51, 394000), 'min_temp_time': datetime.datetime(2019, 2, 26, 13, 58, 33, 664000), 'max_press': '102.2', 'min_press': '0.0', 'avg_press': '85.0', 'max_press_time': datetime.datetime(2019, 2, 21, 0, 1, 46, 740000), 'min_press_time': datetime.datetime(2019, 2, 26, 13, 58, 33, 664000), 'price': '1.0', 'use_volume_work': '12.0', 'use_volume_std': '12.0', 'use_money': '12.0', 'sum_total_volume': None, 'sum_total_money': 21.0, 'total_buy_volume': None, 'total_buy_money': '119', 'remain_money': '98', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '85.0', 'press_out': '85.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '6.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000047处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000024
此查询区间,当前编号下总共抄表记录: 209
此查询区间,上一月最后一天内当前编号下总共抄表记录: 440
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000618'}]
0000000618
00036000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000556')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000618', 'rtu_no': None, 'flmeter_no': '00036000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 59, 881412), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '2579974.290', 'work_sum': '695543.720', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 25), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 27), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 25), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 27), 'max_temperature': '13.38', 'min_temperature': '-1.254', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 16, 0, 22), 'min_temp_time': datetime.datetime(2019, 2, 16, 8, 0, 26), 'max_press': '104.997', 'min_press': '100.915', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 28, 16, 0, 22), 'min_press_time': datetime.datetime(2019, 2, 16, 8, 0, 26), 'price': '0.000', 'use_volume_work': '695543.72', 'use_volume_std': '2579974.29', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000069
此查询区间,当前编号下总共抄表记录: 42
此查询区间,上一月最后一天内当前编号下总共抄表记录: 441
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000619'}]
0000000619
00036000000069
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000555')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000619', 'rtu_no': '00030000000111', 'flmeter_no': '00036000000069', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 0, 151388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 0, 21, 22, 82000), 'min_std_flow_time': datetime.datetime(2019, 1, 10, 17, 57, 25, 731000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 0, 21, 22, 82000), 'min_work_flow_time': datetime.datetime(2019, 1, 10, 17, 57, 25, 731000), 'max_temperature': '20.5', 'min_temperature': '0.0', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 1, 10, 18, 17, 30, 340000), 'min_temp_time': datetime.datetime(2019, 2, 2, 0, 20, 48, 59000), 'max_press': '101.3', 'min_press': '0.0', 'avg_press': '9.0', 'max_press_time': datetime.datetime(2019, 1, 10, 18, 17, 30, 340000), 'min_press_time': datetime.datetime(2019, 2, 2, 0, 20, 48, 59000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '9.0', 'press_out': '9.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '2.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000069处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000054
此查询区间,当前编号下总共抄表记录: 135
此查询区间,上一月最后一天内当前编号下总共抄表记录: 444
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000620'}]
0000000620
00036000000054
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000542')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000620', 'rtu_no': '00030000000096', 'flmeter_no': '00036000000054', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 0, 461388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '4414', 'work_sum': '4238', 'max_std_flow': '11.65', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 6, 16, 34, 55, 273000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 23, 606000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 0, 21, 12, 213000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 23, 606000), 'max_temperature': '23.9', 'min_temperature': '13.2', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 13, 36, 56, 210000), 'min_temp_time': datetime.datetime(2019, 2, 27, 1, 21, 11, 370000), 'max_press': '106.8', 'min_press': '101.1', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 2, 10, 0, 21, 21, 130000), 'min_press_time': datetime.datetime(2019, 2, 27, 13, 23, 49, 637000), 'price': '1.0', 'use_volume_work': '4238.0', 'use_volume_std': '4414.0', 'use_money': '4414.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '6.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000054处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000063
此查询区间,当前编号下总共抄表记录: 455
此查询区间,上一月最后一天内当前编号下总共抄表记录: 445
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000621'}]
0000000621
00036000000063
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000563')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000621', 'rtu_no': '00030000000105', 'flmeter_no': '00036000000063', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 0, 801358), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 22, 43, 16, 52000), 'min_std_flow_time': datetime.datetime(2019, 2, 3, 0, 20, 46, 43000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 22, 43, 16, 52000), 'min_work_flow_time': datetime.datetime(2019, 2, 3, 0, 20, 46, 43000), 'max_temperature': '20.9', 'min_temperature': '8.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 13, 36, 58, 491000), 'min_temp_time': datetime.datetime(2019, 2, 12, 0, 21, 8, 852000), 'max_press': '102.9', 'min_press': '90.7', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 2, 11, 0, 21, 11, 148000), 'min_press_time': datetime.datetime(2019, 2, 19, 1, 7, 16, 109000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[电量不足关阀][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[电量不足关阀][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '7.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000063处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000056
此查询区间,当前编号下总共抄表记录: 224
此查询区间,上一月最后一天内当前编号下总共抄表记录: 456
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000622'}]
0000000622
00036000000056
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000566')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000622', 'rtu_no': '00030000000098', 'flmeter_no': '00036000000056', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 1, 111402), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 0, 21, 19, 963000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 16, 762000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 0, 21, 19, 963000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 16, 762000), 'max_temperature': '24.4', 'min_temperature': '16.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 14, 24, 12, 417000), 'min_temp_time': datetime.datetime(2019, 2, 2, 9, 22, 54, 700000), 'max_press': '103.5', 'min_press': '94.6', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 14, 2, 22, 37, 860000), 'min_press_time': datetime.datetime(2019, 2, 2, 16, 24, 28, 450000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '7.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000056处理好数据已写入oracle
----------------------------------------------------------------------------------------
0800007983
此查询区间,当前编号下总共抄表记录: 358
此查询区间,上一月最后一天内当前编号下总共抄表记录: 487
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000623'}]
0000000623
0800007983
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000583')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000623', 'rtu_no': '00030000000114', 'flmeter_no': '0800007983', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 1, 431501), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 19, 30, 252000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 13, 1, 50, 929000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 19, 30, 252000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 13, 1, 50, 929000), 'max_temperature': '20.3', 'min_temperature': '8.9', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 22, 19, 30, 252000), 'min_temp_time': datetime.datetime(2019, 2, 11, 10, 28, 51, 479000), 'max_press': '103.0', 'min_press': '77.4', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 11, 10, 29, 11, 963000), 'min_press_time': datetime.datetime(2019, 2, 2, 8, 51, 3, 778000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
0800007983处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000057
此查询区间,当前编号下总共抄表记录: 278
此查询区间,上一月最后一天内当前编号下总共抄表记录: 488
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000624'}]
0000000624
00036000000057
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000538')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000624', 'rtu_no': '00030000000099', 'flmeter_no': '00036000000057', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 1, 711387), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '0.05', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 21, 11, 51, 1, 354000), 'min_std_flow_time': datetime.datetime(2019, 2, 3, 0, 21, 4, 575000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 3, 4, 1, 577000), 'min_work_flow_time': datetime.datetime(2019, 2, 3, 0, 21, 4, 575000), 'max_temperature': '22.1', 'min_temperature': '7.9', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 20, 7, 32, 128000), 'min_temp_time': datetime.datetime(2019, 2, 12, 0, 21, 13, 117000), 'max_press': '105.8', 'min_press': '101.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 15, 14, 25, 19, 645000), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 21, 4, 575000), 'price': '1.0', 'use_volume_work': '5.0', 'use_volume_std': '5.0', 'use_money': '5.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000057处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000065
此查询区间,当前编号下总共抄表记录: 231
此查询区间,上一月最后一天内当前编号下总共抄表记录: 490
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000625'}]
0000000625
00036000000065
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000576')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000625', 'rtu_no': '00030000000107', 'flmeter_no': '00036000000065', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 2, 31356), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 3, 23, 27, 929000), 'min_std_flow_time': datetime.datetime(2019, 2, 1, 1, 21, 41, 215000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 3, 23, 27, 929000), 'min_work_flow_time': datetime.datetime(2019, 2, 1, 1, 21, 41, 215000), 'max_temperature': '11.4', 'min_temperature': '9.1', 'avg_temperature': '9.0', 'max_temp_time': datetime.datetime(2019, 2, 7, 1, 20, 35, 495000), 'min_temp_time': datetime.datetime(2019, 2, 17, 8, 28, 38, 703000), 'max_press': '106.7', 'min_press': '101.2', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 2, 27, 9, 25, 45, 918000), 'min_press_time': datetime.datetime(2019, 2, 7, 1, 21, 8, 777000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '12', 'remain_money': '9', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000065处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000053
此查询区间,当前编号下总共抄表记录: 443
此查询区间,上一月最后一天内当前编号下总共抄表记录: 494
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000626'}]
0000000626
00036000000053
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000539')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000626', 'rtu_no': '00030000000095', 'flmeter_no': '00036000000053', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 2, 291354), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 29, 34, 166000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 33, 4, 70000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 29, 34, 166000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 33, 4, 70000), 'max_temperature': '17.9', 'min_temperature': '13.8', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 19, 27, 34, 598000), 'min_temp_time': datetime.datetime(2019, 2, 11, 8, 24, 14, 298000), 'max_press': '103.5', 'min_press': '99.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 14, 0, 21, 28, 803000), 'min_press_time': datetime.datetime(2019, 2, 2, 16, 24, 11, 231000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '190', 'remain_money': '190', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '23.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000053处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000039
此查询区间,当前编号下总共抄表记录: 8
此查询区间,上一月最后一天内当前编号下总共抄表记录: 494
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000627'}]
0000000627
00036000000039
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000564')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000627', 'rtu_no': '00030000000080', 'flmeter_no': '00036000000039', 'customer_no': '00030000000029', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 2, 561356), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 15, 58, 7, 315000), 'min_std_flow_time': datetime.datetime(2019, 2, 26, 11, 13, 2, 10000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 15, 58, 7, 315000), 'min_work_flow_time': datetime.datetime(2019, 2, 26, 11, 13, 2, 10000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 27, 15, 58, 7, 315000), 'min_temp_time': datetime.datetime(2019, 2, 26, 11, 13, 2, 10000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 27, 15, 58, 7, 315000), 'min_press_time': datetime.datetime(2019, 2, 26, 11, 13, 2, 10000), 'price': '6.52', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '10', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '8.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000039处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000070
此查询区间,当前编号下总共抄表记录: 853
此查询区间,上一月最后一天内当前编号下总共抄表记录: 525
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000628'}]
0000000628
00036000000070
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000537')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000628', 'rtu_no': '00030000000112', 'flmeter_no': '00036000000070', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 2, 821387), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 19, 0, 830000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 12, 25, 874000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 19, 0, 830000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 12, 25, 874000), 'max_temperature': '21.5', 'min_temperature': '8.9', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 27, 0, 23, 40, 370000), 'min_temp_time': datetime.datetime(2019, 2, 11, 6, 43, 3, 242000), 'max_press': '108.1', 'min_press': '76.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 23, 21, 10, 10, 144000), 'min_press_time': datetime.datetime(2019, 2, 2, 23, 5, 59, 137000), 'price': '1.0', 'use_volume_work': '4.0', 'use_volume_std': '3.0', 'use_money': '3.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000070处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000009
此查询区间,当前编号下总共抄表记录: 563
此查询区间,上一月最后一天内当前编号下总共抄表记录: 525
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000629'}]
0000000629
00036000000009
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000565')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000629', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000009', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 3, 131388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 14, 8, 26, 46, 640000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 37, 31, 23000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 14, 8, 26, 46, 640000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 37, 31, 23000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 14, 8, 26, 46, 640000), 'min_temp_time': datetime.datetime(2019, 2, 4, 12, 37, 31, 23000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 14, 8, 26, 46, 640000), 'min_press_time': datetime.datetime(2019, 2, 4, 12, 37, 31, 23000), 'price': '1.0', 'use_volume_work': '-1.0', 'use_volume_std': '-2.0', 'use_money': '-2.0', 'sum_total_volume': '19674', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '80376.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '81', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000009处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000023
此查询区间,当前编号下总共抄表记录: 209
此查询区间,上一月最后一天内当前编号下总共抄表记录: 537
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000630'}]
0000000630
00036000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000568')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000630', 'rtu_no': None, 'flmeter_no': '00036000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 3, 411390), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '187556.770', 'work_sum': '73774.320', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 24), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 26), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 24), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 26), 'max_temperature': '14.094', 'min_temperature': '-3.982', 'avg_temperature': '2.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 16, 0, 23), 'min_temp_time': datetime.datetime(2019, 2, 16, 8, 0, 24), 'max_press': '113.329', 'min_press': '100.17', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 28, 16, 0, 23), 'min_press_time': datetime.datetime(2019, 2, 6, 18, 0, 22), 'price': '0.000', 'use_volume_work': '73773.32', 'use_volume_std': '187554.77', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '2.0', 'temp_out': '2.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
0003 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0002
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0002 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0010
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0010 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0018
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0018 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0006
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0006 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0013
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0013 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0014
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0014 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
all done-月报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-03-29 16:40:39.647463
程序运行结束时间: 2019-03-29 16:41:04.411355
整个程序运行总时间: 24 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 3e-07
程序运行结束time.clock(): 24.7641587
整个程序运行总时间time.clock()差: 24.7641584 秒
----------------------------------------------------------------------------------------
============================================================================================================================================================分隔符
此机构: 0008
💗 I am main()
总共抄表数据: 741
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0008 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00086000000008
此查询区间,当前编号下总共抄表记录: 741
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000005'}]
0000000005
00086000000008 ☆ sum_total_volume is None 置为0
00086000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0008', '00082019030000000004')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0008', 'srm_id': '00082019030000000005', 'rtu_no': '00080000000003', 'flmeter_no': '00086000000008', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 24, 764696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 22, 31, 26, 505000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 14, 32, 35, 565000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 22, 31, 26, 505000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 14, 32, 35, 565000), 'max_temperature': '21.1', 'min_temperature': '15.0', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 18, 16, 31, 48, 989000), 'min_temp_time': datetime.datetime(2019, 3, 31, 5, 22, 57, 198000), 'max_press': '103.4', 'min_press': '99.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 7, 11, 31, 30, 661000), 'min_press_time': datetime.datetime(2019, 3, 20, 11, 26, 56, 906000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '100', 'remain_money': '100', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00086000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
0008 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0015
💗 I am main()
总共抄表数据: 41
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0015 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00156000000001
此查询区间,当前编号下总共抄表记录: 41
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0015', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0015', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000005'}]
0000000005
00156000000001 ☆ use_volume_work <0 置为0
00156000000001 ☆ sum_total_volume is None 置为0
00156000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0015', '00152019030000000004')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0015', 'srm_id': '00152019030000000005', 'rtu_no': '00150000000001', 'flmeter_no': '00156000000001', 'customer_no': '00150000000001', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 25, 147696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 15, 20, 14, 55, 114000), 'min_std_flow_time': datetime.datetime(2019, 3, 12, 16, 42, 13, 927000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 15, 20, 14, 55, 114000), 'min_work_flow_time': datetime.datetime(2019, 3, 12, 16, 42, 13, 927000), 'max_temperature': '28.9', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 16, 56, 15, 630000), 'min_temp_time': datetime.datetime(2019, 3, 12, 17, 4, 58, 302000), 'max_press': '102.2', 'min_press': '0.0', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 3, 15, 10, 8, 46, 474000), 'min_press_time': datetime.datetime(2019, 3, 12, 17, 4, 58, 302000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 15.0, 'total_buy_volume': None, 'total_buy_money': '20', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '5.0', 'srm_status': '1'}]
insert sys_serial_no ok
00156000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0015 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0017
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0017 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0005
💗 I am main()
总共抄表数据: 55465
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 657
0005 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 22
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00050000000008
此查询区间,当前编号下总共抄表记录: 5624
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000260'}]
0000000260
00050000000008 ☆ use_volume_std <0 置为0
00050000000008 ☆ sum_total_money <0 置为0
00050000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000251')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000260', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 28, 244727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '23', 'work_sum': '29', 'max_std_flow': '0.0', 'min_std_flow': '-2107801.5', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 49, 42, 346000), 'min_std_flow_time': datetime.datetime(2019, 3, 13, 19, 29, 40, 5000), 'max_work_flow': '20.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 13, 19, 29, 40, 5000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 14, 44, 877000), 'max_temperature': '20.0', 'min_temperature': '-2.03', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 49, 42, 346000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 14, 44, 877000), 'max_press': '565.96', 'min_press': '0.0', 'avg_press': '114.0', 'max_press_time': datetime.datetime(2019, 3, 5, 11, 27, 52, 390000), 'min_press_time': datetime.datetime(2019, 3, 5, 16, 29, 3, 610000), 'price': '1.58', 'use_volume_work': '29.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '23', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '500.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '114.0', 'press_out': '114.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00050000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000016
此查询区间,当前编号下总共抄表记录: 2193
此查询区间,上一月最后一天内当前编号下总共抄表记录: 37
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000261'}]
0000000261
00056000000016 ☆ sum_total_money <0 置为0
00056000000016
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000253')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000261', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 28, 613726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '462833', 'work_sum': '266207', 'max_std_flow': '16789.0', 'min_std_flow': '0.0', 'avg_std_flow': '13.0', 'max_std_flow_time': datetime.datetime(2019, 3, 6, 19, 31, 28, 74000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 0, 34, 243000), 'max_work_flow': '124.88', 'min_work_flow': '0.0', 'avg_work_flow': '7.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 45, 4, 167000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 0, 34, 243000), 'max_temperature': '21.92', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 18, 15, 7, 468000), 'min_temp_time': datetime.datetime(2019, 3, 6, 19, 31, 28, 74000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 50, 3, 306000), 'min_press_time': datetime.datetime(2019, 3, 6, 19, 31, 28, 74000), 'price': '1.55', 'use_volume_work': '8396.0', 'use_volume_std': '8396.0', 'use_money': '13013.8', 'sum_total_volume': '266207', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '36502.84', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000016处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000015
此查询区间,当前编号下总共抄表记录: 2519
此查询区间,上一月最后一天内当前编号下总共抄表记录: 72
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000262'}]
0000000262
00056000000015 ☆ sum_total_money <0 置为0
00056000000015
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000242')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000262', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000015', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 28, 907696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '337378', 'work_sum': '245624', 'max_std_flow': '102.94', 'min_std_flow': '0.0', 'avg_std_flow': '5.0', 'max_std_flow_time': datetime.datetime(2019, 3, 25, 7, 30, 43, 859000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 0, 33, 164000), 'max_work_flow': '121.75', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 21, 10, 4, 124000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 0, 33, 164000), 'max_temperature': '32.0', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 26, 14, 5, 42, 249000), 'min_temp_time': datetime.datetime(2019, 3, 5, 21, 25, 24, 810000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 50, 1, 928000), 'min_press_time': datetime.datetime(2019, 3, 5, 21, 25, 24, 810000), 'price': '1.55', 'use_volume_work': '8228.0', 'use_volume_std': '8228.0', 'use_money': '12753.4', 'sum_total_volume': '245624', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '44459.28', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000015处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 2520
此查询区间,上一月最后一天内当前编号下总共抄表记录: 114
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000263'}]
0000000263
00056000000010 ☆ sum_total_money <0 置为0
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000244')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000263', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 29, 327724), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '629047', 'work_sum': '629047', 'max_std_flow': '176.36', 'min_std_flow': '-193.0', 'avg_std_flow': '22.0', 'max_std_flow_time': datetime.datetime(2019, 3, 19, 8, 29, 14, 677000), 'min_std_flow_time': datetime.datetime(2019, 3, 15, 17, 22, 34, 630000), 'max_work_flow': '205.86', 'min_work_flow': '0.0', 'avg_work_flow': '26.0', 'max_work_flow_time': datetime.datetime(2019, 3, 19, 8, 29, 14, 677000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 26, 43, 503000), 'max_temperature': '84.47', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 11, 8, 20, 37, 255000), 'min_temp_time': datetime.datetime(2019, 3, 15, 17, 22, 34, 630000), 'max_press': '84.0', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 20, 9, 37, 348000), 'min_press_time': datetime.datetime(2019, 3, 11, 8, 20, 37, 255000), 'price': '1.52', 'use_volume_work': '28033.0', 'use_volume_std': '28033.0', 'use_money': '42610.16', 'sum_total_volume': '629047', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3763.34', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000019
此查询区间,当前编号下总共抄表记录: 2149
此查询区间,上一月最后一天内当前编号下总共抄表记录: 153
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000264'}]
0000000264
00056000000019 ☆ sum_total_money <0 置为0
00056000000019
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000245')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000264', 'rtu_no': '00050000000016', 'flmeter_no': '00056000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 29, 663730), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '195381', 'work_sum': '179664', 'max_std_flow': '104.61', 'min_std_flow': '0.0', 'avg_std_flow': '2.0', 'max_std_flow_time': datetime.datetime(2019, 3, 22, 8, 21, 40, 984000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 36, 766000), 'max_work_flow': '114.82', 'min_work_flow': '0.0', 'avg_work_flow': '3.0', 'max_work_flow_time': datetime.datetime(2019, 3, 19, 8, 8, 48, 911000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 36, 766000), 'max_temperature': '95.13', 'min_temperature': '0.0', 'avg_temperature': '8.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 9, 8, 57, 52000), 'min_temp_time': datetime.datetime(2019, 3, 26, 16, 10, 30, 187000), 'max_press': '98.34', 'min_press': '0.0', 'avg_press': '89.0', 'max_press_time': datetime.datetime(2019, 3, 19, 13, 21, 37, 156000), 'min_press_time': datetime.datetime(2019, 3, 19, 9, 8, 57, 52000), 'price': '2.28', 'use_volume_work': '179664.0', 'use_volume_std': '3896.0', 'use_money': '8882.88', 'sum_total_volume': '179664', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '16393.62', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '89.0', 'press_out': '89.0', 'temp_in': '8.0', 'temp_out': '8.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000019处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 1751
此查询区间,上一月最后一天内当前编号下总共抄表记录: 194
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000265'}]
0000000265
00056000000028 ☆ use_volume_std <0 置为0
00056000000028 ☆ sum_total_money <0 置为0
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000255')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000265', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 30, 10696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '129483', 'work_sum': '144628', 'max_std_flow': '312.15', 'min_std_flow': '0.0', 'avg_std_flow': '38.0', 'max_std_flow_time': datetime.datetime(2019, 3, 24, 7, 55, 53, 812000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 5, 3, 964000), 'max_work_flow': '338.95', 'min_work_flow': '0.0', 'avg_work_flow': '41.0', 'max_work_flow_time': datetime.datetime(2019, 3, 22, 6, 41, 54, 499000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 5, 3, 964000), 'max_temperature': '27.92', 'min_temperature': '0.0', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 3, 5, 1, 18, 58, 377000), 'min_temp_time': datetime.datetime(2019, 3, 17, 3, 0, 47, 583000), 'max_press': '98.64', 'min_press': '0.0', 'avg_press': '95.0', 'max_press_time': datetime.datetime(2019, 3, 31, 9, 46, 13, 264000), 'min_press_time': datetime.datetime(2019, 3, 17, 3, 0, 47, 583000), 'price': '1.52', 'use_volume_work': '144628.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '129483', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '92789.57', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '95.0', 'press_out': '95.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 2502
此查询区间,上一月最后一天内当前编号下总共抄表记录: 233
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000266'}]
0000000266
00056000000022 ☆ use_volume_std <0 置为0
00056000000022 ☆ sum_total_money <0 置为0
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000258')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000266', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 30, 334695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 20, 0, 2, 87000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 36, 18, 402000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 0, 2, 87000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 36, 18, 402000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 20, 0, 2, 87000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 36, 18, 402000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 20, 0, 2, 87000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 36, 18, 402000), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '6027', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '415.34', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000006
此查询区间,当前编号下总共抄表记录: 6349
此查询区间,上一月最后一天内当前编号下总共抄表记录: 233
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000267'}]
0000000267
00050000000006 ☆ use_volume_std <0 置为0
00050000000006 ☆ sum_total_money <0 置为0
00050000000006
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000246')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000267', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000006', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 30, 686727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '1000', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 39, 39, 337000), 'min_std_flow_time': datetime.datetime(2019, 3, 2, 15, 40, 46, 844000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 39, 39, 337000), 'min_work_flow_time': datetime.datetime(2019, 3, 2, 15, 40, 46, 844000), 'max_temperature': '35.91', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 4, 10, 44, 38, 793000), 'min_temp_time': datetime.datetime(2019, 3, 12, 8, 12, 45, 995000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 39, 39, 337000), 'min_press_time': datetime.datetime(2019, 3, 2, 15, 40, 46, 844000), 'price': '1.58', 'use_volume_work': '0.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1700.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00050000000006处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 2225
此查询区间,上一月最后一天内当前编号下总共抄表记录: 260
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000268'}]
0000000268
00056000000014 ☆ use_volume_std <0 置为0
00056000000014 ☆ sum_total_money <0 置为0
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000241')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000268', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 31, 103727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 52, 28, 989000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 55, 44, 809000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 52, 28, 989000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 55, 44, 809000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 52, 28, 989000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 55, 44, 809000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 52, 28, 989000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 55, 44, 809000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '4292', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1065.54', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000026
此查询区间,当前编号下总共抄表记录: 1247
此查询区间,上一月最后一天内当前编号下总共抄表记录: 303
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000269'}]
0000000269
00056000000026 ☆ use_volume_std <0 置为0
00056000000026 ☆ sum_total_money <0 置为0
00056000000026
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000252')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000269', 'rtu_no': '00050000000021', 'flmeter_no': '00056000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 31, 424707), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 42, 18, 675000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 38, 59, 322000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 42, 18, 675000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 38, 59, 322000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 42, 18, 675000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 38, 59, 322000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 42, 18, 675000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 38, 59, 322000), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '9695', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2642.67', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000026处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 2516
此查询区间,上一月最后一天内当前编号下总共抄表记录: 343
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000270'}]
0000000270
00056000000020 ☆ sum_total_money <0 置为0
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000256')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000270', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 31, 726695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '29933', 'work_sum': '32207', 'max_std_flow': '0.22', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 14, 32, 10, 703000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 47, 985000), 'max_work_flow': '0.24', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 14, 32, 10, 703000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 47, 985000), 'max_temperature': '100.89', 'min_temperature': '0.0', 'avg_temperature': '31.0', 'max_temp_time': datetime.datetime(2019, 3, 7, 2, 11, 58, 735000), 'min_temp_time': datetime.datetime(2019, 3, 4, 19, 58, 44, 313000), 'max_press': '101.89', 'min_press': '0.0', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 3, 14, 0, 57, 3, 286000), 'min_press_time': datetime.datetime(2019, 3, 7, 2, 11, 58, 735000), 'price': '1.59', 'use_volume_work': '32207.0', 'use_volume_std': '4.0', 'use_money': '6.36', 'sum_total_volume': '29933', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '461.6', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '31.0', 'temp_out': '31.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000007
此查询区间,当前编号下总共抄表记录: 5407
此查询区间,上一月最后一天内当前编号下总共抄表记录: 343
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000271'}]
0000000271
00050000000007 ☆ use_volume_std <0 置为0
00050000000007 ☆ sum_total_money <0 置为0
00050000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000259')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000271', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 32, 56695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '1000', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 44, 39, 792000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 10, 44, 39, 700000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 44, 39, 792000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 10, 44, 39, 700000), 'max_temperature': '35.91', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 2, 15, 40, 46, 938000), 'min_temp_time': datetime.datetime(2019, 3, 13, 16, 28, 23, 114000), 'max_press': '101.32', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 44, 39, 792000), 'min_press_time': datetime.datetime(2019, 3, 12, 16, 5, 9, 224000), 'price': '1.58', 'use_volume_work': '0.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '305.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00050000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 1678
此查询区间,上一月最后一天内当前编号下总共抄表记录: 374
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000272'}]
0000000272
00056000000023 ☆ sum_total_money <0 置为0
00056000000023
总列表长度: 0
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000272', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 32, 446695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '338581', 'work_sum': '174522', 'max_std_flow': '169.07', 'min_std_flow': '-2.7183877e+23', 'avg_std_flow': '5.0', 'max_std_flow_time': datetime.datetime(2019, 3, 12, 6, 17, 51, 900000), 'min_std_flow_time': datetime.datetime(2019, 3, 18, 18, 11, 42, 364000), 'max_work_flow': '181.23', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 3, 12, 6, 17, 51, 900000), 'min_work_flow_time': datetime.datetime(2019, 2, 28, 23, 58, 46, 570000), 'max_temperature': '97.65', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 18, 4, 34, 48, 599000), 'min_temp_time': datetime.datetime(2019, 3, 1, 6, 29, 51, 594000), 'max_press': '100.84', 'min_press': '0.0', 'avg_press': '95.0', 'max_press_time': datetime.datetime(2019, 3, 27, 13, 38, 43, 371000), 'min_press_time': datetime.datetime(2019, 3, 1, 6, 29, 51, 594000), 'price': '1.43', 'use_volume_work': '174522.0', 'use_volume_std': '144593.0', 'use_money': '206767.99', 'sum_total_volume': '174522', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '10020.67', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '95.0', 'press_out': '95.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 2193
此查询区间,上一月最后一天内当前编号下总共抄表记录: 410
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000273'}]
0000000273
00056000000027 ☆ sum_total_money <0 置为0
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000243')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000273', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 32, 705695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 40, 4, 211000), 'min_std_flow_time': datetime.datetime(2019, 2, 28, 23, 56, 31, 663000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 40, 4, 211000), 'min_work_flow_time': datetime.datetime(2019, 2, 28, 23, 56, 31, 663000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 40, 4, 211000), 'min_temp_time': datetime.datetime(2019, 2, 28, 23, 56, 31, 663000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 40, 4, 211000), 'min_press_time': datetime.datetime(2019, 2, 28, 23, 56, 31, 663000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '57514.0', 'use_money': '131131.92', 'sum_total_volume': '87443', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1467.28', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000030
此查询区间,当前编号下总共抄表记录: 150
此查询区间,上一月最后一天内当前编号下总共抄表记录: 410
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000274'}]
0000000274
00056000000030 ☆ use_volume_std <0 置为0
00056000000030 ☆ sum_total_volume is None 置为0
00056000000030
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000247')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000274', 'rtu_no': '00050000000025', 'flmeter_no': '00056000000030', 'customer_no': '00050000000022', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 33, 36697), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1.99', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 12, 16, 21, 187000), 'min_std_flow_time': datetime.datetime(2019, 3, 27, 13, 10, 48, 192000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 16, 1, 10, 308000), 'min_work_flow_time': datetime.datetime(2019, 3, 27, 13, 10, 48, 192000), 'max_temperature': '19.6', 'min_temperature': '11.3', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 11, 26, 56, 62000), 'min_temp_time': datetime.datetime(2019, 3, 31, 1, 21, 14, 725000), 'max_press': '100.8', 'min_press': '48.7', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 3, 29, 1, 21, 36, 828000), 'min_press_time': datetime.datetime(2019, 3, 31, 16, 1, 9, 288000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '63', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '26.0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000030处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 2213
此查询区间,上一月最后一天内当前编号下总共抄表记录: 452
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000275'}]
0000000275
00056000000025 ☆ sum_total_money <0 置为0
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000249')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000275', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 33, 327727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 20, 21, 873000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 37, 3, 526000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 20, 21, 873000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 37, 3, 526000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 20, 21, 873000), 'min_temp_time': datetime.datetime(2019, 3, 1, 1, 37, 3, 526000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 20, 21, 873000), 'min_press_time': datetime.datetime(2019, 3, 1, 1, 37, 3, 526000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '1186.0', 'use_money': '2704.08', 'sum_total_volume': '47674', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13252.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000017
此查询区间,当前编号下总共抄表记录: 2171
此查询区间,上一月最后一天内当前编号下总共抄表记录: 487
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000276'}]
0000000276
00056000000017 ☆ sum_total_money <0 置为0
00056000000017
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000239')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000276', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 33, 656696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '213982', 'work_sum': '221243', 'max_std_flow': '83.42', 'min_std_flow': '0.0', 'avg_std_flow': '8.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 0, 15, 5, 109000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 9, 915000), 'max_work_flow': '100.44', 'min_work_flow': '0.0', 'avg_work_flow': '10.0', 'max_work_flow_time': datetime.datetime(2019, 3, 27, 16, 44, 8, 671000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 9, 915000), 'max_temperature': '83.81', 'min_temperature': '0.0', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 17, 5, 57, 28, 677000), 'min_temp_time': datetime.datetime(2019, 3, 2, 18, 54, 58, 839000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 55, 3, 986000), 'min_press_time': datetime.datetime(2019, 3, 2, 18, 54, 58, 839000), 'price': '1.55', 'use_volume_work': '221243.0', 'use_volume_std': '174755.0', 'use_money': '270870.25', 'sum_total_volume': '221243', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26440.8', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000017处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 1818
此查询区间,上一月最后一天内当前编号下总共抄表记录: 530
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000277'}]
0000000277
00056000000013 ☆ sum_total_money <0 置为0
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000238')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000277', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 33, 994697), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '3', 'work_sum': '0', 'max_std_flow': '35.91', 'min_std_flow': '0.0', 'avg_std_flow': '29.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 22, 7, 227000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 9, 28, 93000), 'max_work_flow': '35.91', 'min_work_flow': '0.0', 'avg_work_flow': '29.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 22, 7, 227000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 9, 28, 93000), 'max_temperature': '35.91', 'min_temperature': '0.0', 'avg_temperature': '35.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 22, 7, 227000), 'min_temp_time': datetime.datetime(2019, 3, 3, 8, 13, 24, 987000), 'max_press': '101.32', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 22, 7, 227000), 'min_press_time': datetime.datetime(2019, 3, 3, 8, 13, 24, 987000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '48701.0', 'use_money': '111038.28', 'sum_total_volume': '95189', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1132.47', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000018
此查询区间,当前编号下总共抄表记录: 2186
此查询区间,上一月最后一天内当前编号下总共抄表记录: 565
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000278'}]
0000000278
00056000000018 ☆ sum_total_money <0 置为0
00056000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000257')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000278', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 34, 358727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '155787', 'work_sum': '155787', 'max_std_flow': '91.85', 'min_std_flow': '0.0', 'avg_std_flow': '4.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 21, 5, 7, 546000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 10, 962000), 'max_work_flow': '111.39', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 3, 17, 21, 6, 51, 802000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 10, 962000), 'max_temperature': '22.89', 'min_temperature': '8.84', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 1, 44, 8, 109000), 'min_temp_time': datetime.datetime(2019, 3, 12, 7, 33, 0, 61000), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 55, 4, 930000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 0, 10, 962000), 'price': '1.55', 'use_volume_work': '155787.0', 'use_volume_std': '109299.0', 'use_money': '169413.45', 'sum_total_volume': '155787', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '25562.97', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 2207
此查询区间,上一月最后一天内当前编号下总共抄表记录: 607
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000279'}]
0000000279
00056000000021 ☆ sum_total_money <0 置为0
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000240')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000279', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 34, 682695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '65349', 'work_sum': '70433', 'max_std_flow': '140.79', 'min_std_flow': '0.0', 'avg_std_flow': '8.0', 'max_std_flow_time': datetime.datetime(2019, 3, 18, 6, 22, 43, 36000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 49, 126000), 'max_work_flow': '151.57', 'min_work_flow': '0.0', 'avg_work_flow': '9.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 10, 8, 9, 829000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 49, 126000), 'max_temperature': '36.23', 'min_temperature': '0.0', 'avg_temperature': '32.0', 'max_temp_time': datetime.datetime(2019, 3, 7, 21, 50, 9, 145000), 'min_temp_time': datetime.datetime(2019, 3, 9, 4, 1, 0, 934000), 'max_press': '101.21', 'min_press': '0.0', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 3, 14, 1, 27, 13, 68000), 'min_press_time': datetime.datetime(2019, 3, 9, 4, 1, 0, 934000), 'price': '1.46', 'use_volume_work': '10035.0', 'use_volume_std': '9289.0', 'use_money': '13561.94', 'sum_total_volume': '65349', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '7804.58', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '32.0', 'temp_out': '32.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 1630
此查询区间,上一月最后一天内当前编号下总共抄表记录: 619
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000280'}]
0000000280
00056000000024 ☆ sum_total_money <0 置为0
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000248')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000280', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 35, 10726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '246780', 'work_sum': '246780', 'max_std_flow': '111.71', 'min_std_flow': '0.0', 'avg_std_flow': '18.0', 'max_std_flow_time': datetime.datetime(2019, 3, 24, 5, 49, 3, 749000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 18, 51, 243000), 'max_work_flow': '131.48', 'min_work_flow': '0.0', 'avg_work_flow': '21.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 18, 41, 35, 328000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 18, 51, 243000), 'max_temperature': '22.87', 'min_temperature': '12.69', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 16, 22, 37, 948000), 'min_temp_time': datetime.datetime(2019, 3, 1, 7, 25, 5, 711000), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 3, 31, 22, 2, 36, 491000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 18, 51, 243000), 'price': '1.43', 'use_volume_work': '186382.0', 'use_volume_std': '190720.0', 'use_money': '272729.6', 'sum_total_volume': '246780', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '6199.36', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 2217
此查询区间,上一月最后一天内当前编号下总共抄表记录: 657
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000281'}]
0000000281
00056000000029 ☆ use_volume_work <0 置为0
00056000000029 ☆ use_volume_std <0 置为0
00056000000029 ☆ sum_total_money <0 置为0
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000250')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000281', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 35, 351727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 22, 3, 36, 746000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 5, 54, 887000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 22, 3, 36, 746000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 5, 54, 887000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 22, 3, 36, 746000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 5, 54, 887000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 22, 3, 36, 746000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 5, 54, 887000), 'price': '1.61', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '25566', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5256.34', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
0005 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0007
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0007 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0009
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0009 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0011
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0011 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0012
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0012 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0016
💗 I am main()
总共抄表数据: 366
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0016 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 2
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00160000000001
此查询区间,当前编号下总共抄表记录: 273
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000009'}]
0000000009
00160000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0016', '00162019030000000008')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0016', 'srm_id': '00162019030000000009', 'rtu_no': 'FM0000000690', 'flmeter_no': '00160000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 36, 199698), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '69397063.950', 'work_sum': '16288079.880', 'max_std_flow': '4509.18', 'min_std_flow': '0.0', 'avg_std_flow': '1745.0', 'max_std_flow_time': datetime.datetime(2019, 3, 21, 12, 0, 25), 'min_std_flow_time': datetime.datetime(2019, 3, 29, 8, 0, 36), 'max_work_flow': '951.72', 'min_work_flow': '0.0', 'avg_work_flow': '372.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 12, 0, 26), 'min_work_flow_time': datetime.datetime(2019, 3, 29, 8, 0, 36), 'max_temperature': '14.226', 'min_temperature': '-2.066', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 3, 26, 16, 0, 24), 'min_temp_time': datetime.datetime(2019, 3, 22, 8, 0, 31), 'max_press': '462.211', 'min_press': '256.211', 'avg_press': '450.0', 'max_press_time': datetime.datetime(2019, 3, 23, 8, 0, 30), 'min_press_time': datetime.datetime(2019, 3, 31, 19, 0, 22), 'price': '0.000', 'use_volume_work': '104690.31000000052', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '450.0', 'press_out': '450.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00160000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
00166000000002
此查询区间,当前编号下总共抄表记录: 93
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000010'}]
0000000010
00166000000002 ☆ sum_total_volume is None 置为0
00166000000002
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0016', '00162019030000000007')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0016', 'srm_id': '00162019030000000010', 'rtu_no': '00160000000002', 'flmeter_no': '00166000000002', 'customer_no': '00160000000002', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 36, 482696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 52, 13, 421000), 'min_std_flow_time': datetime.datetime(2019, 3, 20, 11, 14, 44, 390000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 52, 13, 421000), 'min_work_flow_time': datetime.datetime(2019, 3, 20, 11, 14, 44, 390000), 'max_temperature': '26.5', 'min_temperature': '6.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 21, 16, 37, 1, 15000), 'min_temp_time': datetime.datetime(2019, 3, 30, 1, 22, 34, 906000), 'max_press': '102.1', 'min_press': '66.7', 'avg_press': '92.0', 'max_press_time': datetime.datetime(2019, 3, 22, 9, 9, 49, 328000), 'min_press_time': datetime.datetime(2019, 3, 22, 21, 28, 37, 609000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[温度异常][压力异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[温度异常][压力异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '46', 'press_in': '92.0', 'press_out': '92.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00166000000002处理好数据已写入oracle
----------------------------------------------------------------------------------------
0016 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0019
💗 I am main()
总共抄表数据: 10
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0019 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 2
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00196000000001
此查询区间,当前编号下总共抄表记录: 8
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0019', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0019', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000009'}]
0000000009
00196000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0019', '00192019030000000007')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0019', 'srm_id': '00192019030000000009', 'rtu_no': '00190000000001', 'flmeter_no': '00196000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 36, 837697), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '52236', 'work_sum': '48238', 'max_std_flow': '61.61', 'min_std_flow': '0.0', 'avg_std_flow': '10.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 9, 41, 24, 390000), 'min_std_flow_time': datetime.datetime(2019, 3, 30, 9, 35, 25, 906000), 'max_work_flow': '61.61', 'min_work_flow': '0.0', 'avg_work_flow': '10.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 9, 41, 24, 390000), 'min_work_flow_time': datetime.datetime(2019, 3, 30, 9, 35, 25, 906000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 9, 56, 24, 937000), 'min_temp_time': datetime.datetime(2019, 3, 30, 9, 35, 25, 906000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 30, 9, 56, 24, 937000), 'min_press_time': datetime.datetime(2019, 3, 30, 9, 35, 25, 906000), 'price': '0.0', 'use_volume_work': '1.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '00000000', 'fm_state_msg': '无外电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00196000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0019', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0019', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000010'}]
0000000010
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0019', '00192019030000000008')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0019', 'srm_id': '00192019030000000010', 'rtu_no': '00190000000001', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 37, 132697), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '52235', 'work_sum': '48237', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 9, 30, 24, 640000), 'min_std_flow_time': datetime.datetime(2019, 3, 30, 9, 27, 24, 140000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 9, 30, 24, 640000), 'min_work_flow_time': datetime.datetime(2019, 3, 30, 9, 27, 24, 140000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 9, 30, 24, 640000), 'min_temp_time': datetime.datetime(2019, 3, 30, 9, 27, 24, 140000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 30, 9, 30, 24, 640000), 'min_press_time': datetime.datetime(2019, 3, 30, 9, 27, 24, 140000), 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '00000000', 'fm_state_msg': '无外电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
0019 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0003
💗 I am main()
总共抄表数据: 60029
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 538
0003 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 60
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00036000000077
此查询区间,当前编号下总共抄表记录: 4798
此查询区间,上一月最后一天内当前编号下总共抄表记录: 21
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000241'}]
0000000241
00036000000077 ☆ sum_total_money <0 置为0
00036000000077
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000196')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000241', 'rtu_no': '00030000000118', 'flmeter_no': '00036000000077', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 40, 171727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '9', 'work_sum': '4', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 16, 25, 7, 640000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 15, 677000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 16, 25, 7, 640000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 15, 677000), 'max_temperature': '26.3', 'min_temperature': '10.9', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 12, 16, 28, 42, 130000), 'min_temp_time': datetime.datetime(2019, 3, 5, 6, 5, 58, 659000), 'max_press': '111.2', 'min_press': '100.9', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 12, 16, 28, 42, 130000), 'min_press_time': datetime.datetime(2019, 3, 11, 15, 34, 51, 45000), 'price': '2.39', 'use_volume_work': '4.0', 'use_volume_std': '9.0', 'use_money': '21.51', 'sum_total_volume': '9', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2526.2', 'remain_volume': '0.0', 'fm_state': '10000111', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,低电,阀关,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': '阀关', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '1.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000077处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000058
此查询区间,当前编号下总共抄表记录: 801
此查询区间,上一月最后一天内当前编号下总共抄表记录: 23
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000242'}]
0000000242
00036000000058 ☆ sum_total_volume is None 置为0
00036000000058
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000207')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000242', 'rtu_no': '00030000000100', 'flmeter_no': '00036000000058', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 40, 551699), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 19, 28, 59, 613000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 58, 726000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 28, 59, 613000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 58, 726000), 'max_temperature': '19.9', 'min_temperature': '15.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 22, 51, 29, 749000), 'min_temp_time': datetime.datetime(2019, 3, 31, 6, 23, 38, 734000), 'max_press': '123.7', 'min_press': '100.0', 'avg_press': '108.0', 'max_press_time': datetime.datetime(2019, 3, 31, 7, 24, 6, 488000), 'min_press_time': datetime.datetime(2019, 3, 20, 10, 26, 58, 796000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '108.0', 'press_out': '108.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '22.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000058处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000089
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一月最后一天内当前编号下总共抄表记录: 23
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000243'}]
0000000243
00036000000089 ☆ sum_total_volume is None 置为0
00036000000089
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000215')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000243', 'rtu_no': '00030000000129', 'flmeter_no': '00036000000089', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 40, 865726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 2, 59, 9, 968000), 'min_std_flow_time': datetime.datetime(2019, 3, 25, 19, 19, 36, 468000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 2, 59, 9, 968000), 'min_work_flow_time': datetime.datetime(2019, 3, 25, 19, 19, 36, 468000), 'max_temperature': '17.2', 'min_temperature': '0.0', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 3, 25, 19, 19, 36, 468000), 'min_temp_time': datetime.datetime(2019, 3, 26, 23, 33, 2, 781000), 'max_press': '101.4', 'min_press': '0.0', 'avg_press': '10.0', 'max_press_time': datetime.datetime(2019, 3, 25, 19, 19, 36, 468000), 'min_press_time': datetime.datetime(2019, 3, 26, 23, 33, 2, 781000), 'price': '0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '10.0', 'press_out': '10.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '31.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000089处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000007
此查询区间,当前编号下总共抄表记录: 464
此查询区间,上一月最后一天内当前编号下总共抄表记录: 23
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000244'}]
0000000244
00036000000007 ☆ sum_total_money <0 置为0
00036000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000211')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000244', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 41, 170727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '64', 'work_sum': '66', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 37, 896000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 41, 487000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 37, 896000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 41, 487000), 'max_temperature': '26.96', 'min_temperature': '26.96', 'avg_temperature': '26.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 13, 59, 37, 896000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 25, 41, 487000), 'max_press': '100.15', 'min_press': '100.15', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 14, 13, 59, 37, 896000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 25, 41, 487000), 'price': '1.0', 'use_volume_work': '66.0', 'use_volume_std': '60544.0', 'use_money': '60544.0', 'sum_total_volume': '60544', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '39520.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '26.0', 'temp_out': '26.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000050
此查询区间,当前编号下总共抄表记录: 25
此查询区间,上一月最后一天内当前编号下总共抄表记录: 29
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000245'}]
0000000245
00036000000050 ☆ sum_total_volume is None 置为0
00036000000050
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000218')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000245', 'rtu_no': '00030000000092', 'flmeter_no': '00036000000050', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 41, 546697), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 22, 0, 58, 57, 796000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 1, 54, 663000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 22, 0, 58, 57, 796000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 1, 54, 663000), 'max_temperature': '20.5', 'min_temperature': '10.9', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 22, 0, 58, 57, 796000), 'min_temp_time': datetime.datetime(2019, 3, 1, 5, 2, 36, 936000), 'max_press': '102.2', 'min_press': '101.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 1, 9, 5, 46, 571000), 'min_press_time': datetime.datetime(2019, 3, 2, 0, 57, 18, 844000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[余额不足关阀][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[余额不足关阀][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '50', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000050处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 6683
此查询区间,上一月最后一天内当前编号下总共抄表记录: 29
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000246'}]
0000000246
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000239')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000246', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 41, 862701), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '52235', 'work_sum': '48237', 'max_std_flow': '1556.47', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 11, 17, 6, 53, 383000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 56, 29, 456000), 'max_work_flow': '1572.91', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 11, 17, 6, 53, 383000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 56, 29, 456000), 'max_temperature': '35.91', 'min_temperature': '15.03', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 14, 16, 53, 36000), 'min_temp_time': datetime.datetime(2019, 3, 11, 6, 32, 40, 177000), 'max_press': '101.79', 'min_press': '98.55', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 23, 9, 25, 3, 78000), 'min_press_time': datetime.datetime(2019, 3, 20, 16, 26, 5, 546000), 'price': '2.39', 'use_volume_work': '48237.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '00000000', 'fm_state_msg': '无外电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000069
此查询区间,当前编号下总共抄表记录: 328
此查询区间,上一月最后一天内当前编号下总共抄表记录: 31
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000247'}]
0000000247
00036000000069 ☆ sum_total_volume is None 置为0
00036000000069
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000188')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000247', 'rtu_no': '00030000000111', 'flmeter_no': '00036000000069', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 42, 218726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '10', 'work_sum': '10', 'max_std_flow': '0.33', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 14, 23, 1, 421000), 'min_std_flow_time': datetime.datetime(2019, 1, 10, 18, 14, 34, 996000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 14, 51, 38, 484000), 'min_work_flow_time': datetime.datetime(2019, 1, 10, 18, 14, 34, 996000), 'max_temperature': '21.4', 'min_temperature': '0.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 18, 16, 1, 36, 864000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 21, 14, 398000), 'max_press': '102.4', 'min_press': '0.0', 'avg_press': '65.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 21, 4, 484000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 21, 14, 398000), 'price': '1.0', 'use_volume_work': '10.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 11.0, 'total_buy_volume': None, 'total_buy_money': '13', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '65.0', 'press_out': '65.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '12.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000069处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000021
此查询区间,当前编号下总共抄表记录: 274
此查询区间,上一月最后一天内当前编号下总共抄表记录: 32
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000248'}]
0000000248
00036000000021 ☆ sum_total_volume is None 置为0
00036000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000214')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000248', 'rtu_no': '00030000000055', 'flmeter_no': '00036000000021', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 42, 547727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 10, 6, 56, 93000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 56, 648000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 10, 6, 56, 93000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 56, 648000), 'max_temperature': '13.4', 'min_temperature': '0.0', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 3, 12, 14, 13, 12, 670000), 'min_temp_time': datetime.datetime(2019, 3, 27, 14, 12, 0, 258000), 'max_press': '103.2', 'min_press': '0.0', 'avg_press': '89.0', 'max_press_time': datetime.datetime(2019, 3, 7, 10, 49, 38, 795000), 'min_press_time': datetime.datetime(2019, 3, 27, 14, 12, 0, 258000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '26351', 'remain_money': '26351', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '89.0', 'press_out': '89.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000060
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一月最后一天内当前编号下总共抄表记录: 41
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000249'}]
0000000249
00036000000060 ☆ sum_total_volume is None 置为0
00036000000060
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000192')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000249', 'rtu_no': '00030000000102', 'flmeter_no': '00036000000060', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 42, 841695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 5, 22, 51, 115000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 27, 33, 377000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 1, 5, 22, 51, 115000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 27, 33, 377000), 'max_temperature': '11.6', 'min_temperature': '11.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 1, 9, 3, 42, 241000), 'min_temp_time': datetime.datetime(2019, 3, 1, 6, 23, 12, 935000), 'max_press': '102.1', 'min_press': '101.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 1, 8, 24, 2, 834000), 'min_press_time': datetime.datetime(2019, 3, 1, 6, 23, 12, 935000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000060处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000024
此查询区间,当前编号下总共抄表记录: 277
此查询区间,上一月最后一天内当前编号下总共抄表记录: 53
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000250'}]
0000000250
00036000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000222')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000250', 'rtu_no': None, 'flmeter_no': '00036000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 43, 128697), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '2579974.290', 'work_sum': '695543.720', 'max_std_flow': '142.31', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 2, 0, 23), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 23), 'max_work_flow': '32.28', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 2, 0, 23), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 23), 'max_temperature': '24.98', 'min_temperature': '3.336', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 27, 16, 0, 23), 'min_temp_time': datetime.datetime(2019, 3, 4, 8, 0, 27), 'max_press': '436.908', 'min_press': '100.653', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 3, 31, 2, 0, 23), 'min_press_time': datetime.datetime(2019, 3, 31, 6, 0, 26), 'price': '0.000', 'use_volume_work': '695543.72', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000003
此查询区间,当前编号下总共抄表记录: 6099
此查询区间,上一月最后一天内当前编号下总共抄表记录: 53
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000251'}]
0000000251
00036000000003 ☆ sum_total_money <0 置为0
00036000000003
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000199')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000251', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000003', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 43, 412699), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '80', 'work_sum': '83', 'max_std_flow': '1671.35', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 11, 18, 8, 45, 882000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 26, 362000), 'max_work_flow': '1689.07', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 11, 18, 8, 45, 882000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 26, 362000), 'max_temperature': '25.56', 'min_temperature': '0.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 12, 13, 32, 54, 116000), 'min_temp_time': datetime.datetime(2019, 3, 12, 14, 14, 53, 979000), 'max_press': '101.8', 'min_press': '0.0', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 23, 21, 52, 3, 671000), 'min_press_time': datetime.datetime(2019, 3, 12, 14, 14, 53, 979000), 'price': '2.39', 'use_volume_work': '83.0', 'use_volume_std': '80.0', 'use_money': '191.2', 'sum_total_volume': '80', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1426.0', 'remain_volume': '0.0', 'fm_state': '10000111', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,低电,阀关,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': '阀关', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000003处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000020
此查询区间,当前编号下总共抄表记录: 1164
此查询区间,上一月最后一天内当前编号下总共抄表记录: 53
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000252'}]
0000000252
00036000000020 ☆ sum_total_volume is None 置为0
00036000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000219')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000252', 'rtu_no': '00030000000051', 'flmeter_no': '00036000000020', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 43, 791729), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '71', 'work_sum': '84', 'max_std_flow': '594.04', 'min_std_flow': '0.0', 'avg_std_flow': '1.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 14, 41, 23, 161000), 'min_std_flow_time': datetime.datetime(2019, 3, 6, 11, 47, 27, 650000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 9, 6, 57, 760000), 'min_work_flow_time': datetime.datetime(2019, 3, 6, 11, 47, 27, 650000), 'max_temperature': '26.0', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 16, 30, 28, 193000), 'min_temp_time': datetime.datetime(2019, 3, 6, 19, 15, 45, 371000), 'max_press': '103.2', 'min_press': '0.0', 'avg_press': '71.0', 'max_press_time': datetime.datetime(2019, 3, 8, 11, 23, 4, 640000), 'min_press_time': datetime.datetime(2019, 3, 6, 19, 15, 45, 371000), 'price': '256.0', 'use_volume_work': '84.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '4144', 'remain_money': '4144', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '71.0', 'press_out': '71.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '22.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000062
此查询区间,当前编号下总共抄表记录: 551
此查询区间,上一月最后一天内当前编号下总共抄表记录: 80
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000253'}]
0000000253
00036000000062 ☆ sum_total_volume is None 置为0
00036000000062
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000226')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000253', 'rtu_no': '00030000000104', 'flmeter_no': '00036000000062', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 44, 90695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 13, 742000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 53, 210000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 13, 742000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 53, 210000), 'max_temperature': '19.9', 'min_temperature': '15.3', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 20, 35, 17, 578000), 'min_temp_time': datetime.datetime(2019, 3, 31, 1, 21, 13, 742000), 'max_press': '103.1', 'min_press': '99.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 7, 10, 24, 52, 766000), 'min_press_time': datetime.datetime(2019, 3, 11, 12, 29, 14, 536000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 899.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '99', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '24.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000062处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000056
此查询区间,当前编号下总共抄表记录: 136
此查询区间,上一月最后一天内当前编号下总共抄表记录: 83
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000254'}]
0000000254
00036000000056 ☆ sum_total_volume is None 置为0
00036000000056
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000181')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000254', 'rtu_no': '00030000000098', 'flmeter_no': '00036000000056', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 44, 381695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 0, 21, 9, 239000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 4, 304000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 0, 21, 9, 239000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 4, 304000), 'max_temperature': '24.7', 'min_temperature': '15.8', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 14, 23, 37, 708000), 'min_temp_time': datetime.datetime(2019, 3, 29, 6, 26, 12, 359000), 'max_press': '102.5', 'min_press': '89.4', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 3, 23, 13, 23, 55, 281000), 'min_press_time': datetime.datetime(2019, 3, 29, 8, 27, 11, 249000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '10.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000056处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000010
此查询区间,当前编号下总共抄表记录: 29
此查询区间,上一月最后一天内当前编号下总共抄表记录: 83
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000255'}]
0000000255
00036000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000204')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000255', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 44, 678716), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '69368791.950', 'work_sum': '16280059.520', 'max_std_flow': '3734.73', 'min_std_flow': '456.63', 'avg_std_flow': '2233.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 8, 0, 33), 'min_std_flow_time': datetime.datetime(2019, 3, 30, 8, 0, 30), 'max_work_flow': '774.38', 'min_work_flow': '94.58', 'avg_work_flow': '460.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 8, 0, 33), 'min_work_flow_time': datetime.datetime(2019, 3, 30, 8, 0, 31), 'max_temperature': '13.179', 'min_temperature': '-1.984', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 15, 0, 24), 'min_temp_time': datetime.datetime(2019, 3, 24, 8, 0, 51), 'max_press': '460.827', 'min_press': '450.109', 'avg_press': '455.0', 'max_press_time': datetime.datetime(2019, 3, 23, 23, 0, 23), 'min_press_time': datetime.datetime(2019, 3, 25, 8, 0, 30), 'price': '0.000', 'use_volume_work': '16280059.52', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '455.0', 'press_out': '455.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000065
此查询区间,当前编号下总共抄表记录: 756
此查询区间,上一月最后一天内当前编号下总共抄表记录: 101
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000256'}]
0000000256
00036000000065 ☆ sum_total_volume is None 置为0
00036000000065
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000194')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000256', 'rtu_no': '00030000000107', 'flmeter_no': '00036000000065', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 44, 981727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 19, 28, 15, 34000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 31, 52000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 28, 15, 34000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 31, 52000), 'max_temperature': '20.6', 'min_temperature': '10.9', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 4, 16, 33, 31, 778000), 'min_temp_time': datetime.datetime(2019, 3, 5, 6, 23, 13, 98000), 'max_press': '105.4', 'min_press': '100.1', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 1, 18, 25, 47, 229000), 'min_press_time': datetime.datetime(2019, 3, 20, 14, 27, 21, 937000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000065处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000009
此查询区间,当前编号下总共抄表记录: 551
此查询区间,上一月最后一天内当前编号下总共抄表记录: 101
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000257'}]
0000000257
00036000000009 ☆ sum_total_money <0 置为0
00036000000009
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000230')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000257', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000009', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 45, 278730), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 40, 239000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 43, 706000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 40, 239000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 43, 706000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 13, 59, 40, 239000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 25, 43, 706000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 14, 13, 59, 40, 239000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 25, 43, 706000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '19715.0', 'use_money': '19715.0', 'sum_total_volume': '19715', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '80335.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000009处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000080
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一月最后一天内当前编号下总共抄表记录: 101
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000258'}]
0000000258
00036000000080 ☆ sum_total_volume is None 置为0
00036000000080
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000185')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000258', 'rtu_no': '00030000000120', 'flmeter_no': '00036000000080', 'customer_no': '00030000000050', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 45, 705726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 26, 14, 6, 32, 78000), 'min_std_flow_time': datetime.datetime(2019, 3, 26, 14, 12, 52, 921000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 26, 14, 6, 32, 78000), 'min_work_flow_time': datetime.datetime(2019, 3, 26, 14, 12, 52, 921000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 26, 14, 6, 32, 78000), 'min_temp_time': datetime.datetime(2019, 3, 26, 14, 12, 52, 921000), 'max_press': '101.3', 'min_press': '101.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 26, 14, 6, 32, 78000), 'min_press_time': datetime.datetime(2019, 3, 26, 14, 12, 52, 921000), 'price': '2.5', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2200', 'remain_money': '2200', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[用户身份编号出错][电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[用户身份编号出错][电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '1.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000080处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000054
此查询区间,当前编号下总共抄表记录: 1703
此查询区间,上一月最后一天内当前编号下总共抄表记录: 104
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000259'}]
0000000259
00036000000054 ☆ sum_total_volume is None 置为0
00036000000054
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000201')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000259', 'rtu_no': '00030000000096', 'flmeter_no': '00036000000054', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 46, 9696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '7386', 'work_sum': '7158', 'max_std_flow': '1015.03', 'min_std_flow': '0.0', 'avg_std_flow': '189.0', 'max_std_flow_time': datetime.datetime(2019, 3, 25, 12, 38, 16, 468000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 22, 47, 975000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 0, 23, 22, 200000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 22, 47, 975000), 'max_temperature': '98.4', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 21, 9, 57, 48, 406000), 'min_temp_time': datetime.datetime(2019, 3, 8, 8, 58, 34, 794000), 'max_press': '105.8', 'min_press': '0.0', 'avg_press': '91.0', 'max_press_time': datetime.datetime(2019, 3, 7, 0, 20, 57, 602000), 'min_press_time': datetime.datetime(2019, 3, 8, 8, 58, 34, 794000), 'price': '1.0', 'use_volume_work': '7158.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 245.0, 'total_buy_volume': None, 'total_buy_money': '245', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '91.0', 'press_out': '91.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '20.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000054处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000039
此查询区间,当前编号下总共抄表记录: 108
此查询区间,上一月最后一天内当前编号下总共抄表记录: 104
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000260'}]
0000000260
00036000000039 ☆ sum_total_volume is None 置为0
00036000000039
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000187')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000260', 'rtu_no': '00030000000080', 'flmeter_no': '00036000000039', 'customer_no': '00030000000029', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 46, 423709), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 14, 30, 27, 93000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 52, 7, 159000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 14, 30, 27, 93000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 52, 7, 159000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 14, 30, 27, 93000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 52, 7, 159000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 28, 14, 30, 27, 93000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 52, 7, 159000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '12943', 'remain_money': '12943', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000039处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000075
此查询区间,当前编号下总共抄表记录: 4827
此查询区间,上一月最后一天内当前编号下总共抄表记录: 105
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000261'}]
0000000261
00036000000075 ☆ sum_total_money <0 置为0
00036000000075
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000210')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000261', 'rtu_no': '00030000000117', 'flmeter_no': '00036000000075', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 46, 780695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 7, 562000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 223000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 7, 562000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 223000), 'max_temperature': '25.1', 'min_temperature': '10.7', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 11, 16, 51, 14, 704000), 'min_temp_time': datetime.datetime(2019, 3, 4, 1, 20, 52, 339000), 'max_press': '127.9', 'min_press': '101.2', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 5, 23, 26, 31, 274000), 'min_press_time': datetime.datetime(2019, 3, 10, 1, 20, 57, 662000), 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2608.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000075处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000057
此查询区间,当前编号下总共抄表记录: 7
此查询区间,上一月最后一天内当前编号下总共抄表记录: 126
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000262'}]
0000000262
00036000000057 ☆ sum_total_volume is None 置为0
00036000000057
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000223')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000262', 'rtu_no': '00030000000099', 'flmeter_no': '00036000000057', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 47, 147696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 7, 9, 21, 552000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 51, 476000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 1, 7, 9, 21, 552000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 51, 476000), 'max_temperature': '22.2', 'min_temperature': '21.5', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 3, 1, 1, 8, 7, 299000), 'min_temp_time': datetime.datetime(2019, 3, 1, 7, 9, 21, 552000), 'max_press': '102.1', 'min_press': '101.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 1, 10, 9, 57, 340000), 'min_press_time': datetime.datetime(2019, 3, 1, 4, 8, 58, 492000), 'price': '1.0', 'use_volume_work': '5.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000057处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000088
此查询区间,当前编号下总共抄表记录: 134
此查询区间,上一月最后一天内当前编号下总共抄表记录: 126
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000263'}]
0000000263
00036000000088 ☆ sum_total_volume is None 置为0
00036000000088
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000229')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000263', 'rtu_no': '00030000000128', 'flmeter_no': '00036000000088', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 47, 477701), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 38, 37, 690000), 'min_std_flow_time': datetime.datetime(2019, 3, 26, 13, 38, 40, 218000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 38, 37, 690000), 'min_work_flow_time': datetime.datetime(2019, 3, 26, 13, 38, 40, 218000), 'max_temperature': '19.3', 'min_temperature': '15.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 11, 38, 38, 953000), 'min_temp_time': datetime.datetime(2019, 3, 27, 5, 38, 38, 203000), 'max_press': '102.3', 'min_press': '100.6', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 38, 37, 690000), 'min_press_time': datetime.datetime(2019, 3, 27, 16, 38, 40, 864000), 'price': '0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '31.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000088处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000044
此查询区间,当前编号下总共抄表记录: 703
此查询区间,上一月最后一天内当前编号下总共抄表记录: 157
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000264'}]
0000000264
00036000000044 ☆ sum_total_volume is None 置为0
00036000000044
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000221')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000264', 'rtu_no': '00030000000085', 'flmeter_no': '00036000000044', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 47, 788720), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 19, 31, 22, 931000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 50, 211000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 31, 22, 931000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 50, 211000), 'max_temperature': '20.2', 'min_temperature': '8.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 12, 13, 1, 58, 876000), 'min_temp_time': datetime.datetime(2019, 3, 1, 11, 29, 9, 956000), 'max_press': '127.9', 'min_press': '100.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 1, 17, 31, 44, 928000), 'min_press_time': datetime.datetime(2019, 3, 20, 14, 31, 16, 609000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000044处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000072
此查询区间,当前编号下总共抄表记录: 184
此查询区间,上一月最后一天内当前编号下总共抄表记录: 178
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000265'}]
0000000265
00036000000072 ☆ sum_total_volume is None 置为0
00036000000072
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000232')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000265', 'rtu_no': '00030000000115', 'flmeter_no': '00036000000072', 'customer_no': '00030000000002', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 48, 189727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 14, 787000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 2, 22, 369000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 14, 787000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 2, 22, 369000), 'max_temperature': '16.2', 'min_temperature': '10.7', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 1, 21, 5, 156000), 'min_temp_time': datetime.datetime(2019, 3, 4, 9, 3, 11, 656000), 'max_press': '102.3', 'min_press': '90.8', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 21, 11, 31000), 'min_press_time': datetime.datetime(2019, 3, 5, 17, 9, 15, 94000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '12.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000072处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000048
此查询区间,当前编号下总共抄表记录: 640
此查询区间,上一月最后一天内当前编号下总共抄表记录: 199
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000266'}]
0000000266
00036000000048 ☆ sum_total_volume is None 置为0
00036000000048 ☆ sum_total_money <0 置为0
00036000000048
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000203')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000266', 'rtu_no': '00030000000090', 'flmeter_no': '00036000000048', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 48, 521698), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 17, 30, 42, 157000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 30, 85000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 17, 30, 42, 157000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 30, 85000), 'max_temperature': '19.8', 'min_temperature': '15.1', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 17, 33, 11, 687000), 'min_temp_time': datetime.datetime(2019, 3, 31, 7, 25, 59, 134000), 'max_press': '102.6', 'min_press': '98.4', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 7, 9, 24, 1, 838000), 'min_press_time': datetime.datetime(2019, 3, 20, 11, 27, 2, 109000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '19.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000048处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000079
此查询区间,当前编号下总共抄表记录: 3596
此查询区间,上一月最后一天内当前编号下总共抄表记录: 199
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000267'}]
0000000267
00036000000079 ☆ sum_total_money <0 置为0
00036000000079
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000208')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000267', 'rtu_no': '00030000000119', 'flmeter_no': '00036000000079', 'customer_no': '00030000000049', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 48, 835726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '11', 'work_sum': '11', 'max_std_flow': '35.91', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 13, 14, 52, 57, 146000), 'min_std_flow_time': datetime.datetime(2019, 3, 3, 1, 21, 47, 103000), 'max_work_flow': '35.91', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 13, 14, 52, 57, 146000), 'min_work_flow_time': datetime.datetime(2019, 3, 3, 1, 21, 47, 103000), 'max_temperature': '35.91', 'min_temperature': '0.0', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 14, 52, 57, 146000), 'min_temp_time': datetime.datetime(2019, 3, 12, 16, 10, 35, 771000), 'max_press': '102.8', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 13, 9, 1, 5, 880000), 'min_press_time': datetime.datetime(2019, 3, 12, 16, 10, 35, 771000), 'price': '2.39', 'use_volume_work': '11.0', 'use_volume_std': '11.0', 'use_money': '26.29', 'sum_total_volume': '11', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2427.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000079处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000073
此查询区间,当前编号下总共抄表记录: 3344
此查询区间,上一月最后一天内当前编号下总共抄表记录: 200
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000268'}]
0000000268
00036000000073 ☆ sum_total_money <0 置为0
00036000000073
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000205')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000268', 'rtu_no': '00030000000116', 'flmeter_no': '00036000000073', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 49, 203699), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '31', 'work_sum': '16', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 8, 890000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 8, 817000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 8, 890000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 8, 817000), 'max_temperature': '22.46', 'min_temperature': '10.9', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 15, 1, 57, 958000), 'min_temp_time': datetime.datetime(2019, 3, 4, 1, 21, 8, 229000), 'max_press': '102.2', 'min_press': '101.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 8, 1, 22, 37, 12000), 'min_press_time': datetime.datetime(2019, 3, 10, 1, 21, 5, 365000), 'price': '2.39', 'use_volume_work': '16.0', 'use_volume_std': '31.0', 'use_money': '74.09', 'sum_total_volume': '31', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26377.18', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000073处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000014
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一月最后一天内当前编号下总共抄表记录: 200
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000269'}]
0000000269
00036000000014 ☆ sum_total_volume is None 置为0
00036000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000202')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000269', 'rtu_no': '00030000000045', 'flmeter_no': '00036000000014', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 49, 593695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '155', 'work_sum': '155', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 6, 11, 24, 2, 987000), 'min_std_flow_time': datetime.datetime(2019, 3, 6, 11, 22, 16, 613000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 6, 11, 24, 2, 987000), 'min_work_flow_time': datetime.datetime(2019, 3, 6, 11, 22, 16, 613000), 'max_temperature': '23.2', 'min_temperature': '0.0', 'avg_temperature': '9.0', 'max_temp_time': datetime.datetime(2019, 3, 6, 11, 33, 52, 296000), 'min_temp_time': datetime.datetime(2019, 3, 6, 11, 22, 16, 613000), 'max_press': '101.3', 'min_press': '0.0', 'avg_press': '42.0', 'max_press_time': datetime.datetime(2019, 3, 6, 11, 33, 52, 296000), 'min_press_time': datetime.datetime(2019, 3, 6, 11, 22, 16, 613000), 'price': '665.6', 'use_volume_work': '155.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1280.0, 'total_buy_volume': None, 'total_buy_money': '1280', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '50', 'press_in': '42.0', 'press_out': '42.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000101
此查询区间,当前编号下总共抄表记录: 130
此查询区间,上一月最后一天内当前编号下总共抄表记录: 200
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000270'}]
0000000270
00036000000101 ☆ sum_total_volume is None 置为0
00036000000101
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000206')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000270', 'rtu_no': '00030000000141', 'flmeter_no': '00036000000101', 'customer_no': '00030000000068', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 49, 970730), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 9, 32, 56, 874000), 'min_std_flow_time': datetime.datetime(2019, 3, 27, 16, 46, 58, 195000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 9, 32, 56, 874000), 'min_work_flow_time': datetime.datetime(2019, 3, 27, 16, 46, 58, 195000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 9, 32, 56, 874000), 'min_temp_time': datetime.datetime(2019, 3, 27, 16, 46, 58, 195000), 'max_press': '101.3', 'min_press': '101.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 28, 9, 32, 56, 874000), 'min_press_time': datetime.datetime(2019, 3, 27, 16, 46, 58, 195000), 'price': '0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '01', 'battery_voltage': None, 'battery_level': '0', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000101处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000053
此查询区间,当前编号下总共抄表记录: 1133
此查询区间,上一月最后一天内当前编号下总共抄表记录: 214
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000271'}]
0000000271
00036000000053 ☆ sum_total_volume is None 置为0
00036000000053
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000190')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000271', 'rtu_no': '00030000000095', 'flmeter_no': '00036000000053', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 50, 323695), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '23.28', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 16, 44, 19, 999000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 8, 757000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 43, 684000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 8, 757000), 'max_temperature': '20.7', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 13, 1, 40, 328000), 'min_temp_time': datetime.datetime(2019, 3, 25, 4, 27, 33, 390000), 'max_press': '102.7', 'min_press': '0.0', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 3, 23, 10, 27, 27, 874000), 'min_press_time': datetime.datetime(2019, 3, 30, 13, 6, 58, 273000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '53', 'remain_money': '53', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '21.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000053处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000028
此查询区间,当前编号下总共抄表记录: 273
此查询区间,上一月最后一天内当前编号下总共抄表记录: 226
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000272'}]
0000000272
00036000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000189')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000272', 'rtu_no': None, 'flmeter_no': '00036000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 50, 728727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '311688.030', 'work_sum': '287115.020', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 22, 0, 22), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 22, 0, 22), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'max_temperature': '20.0', 'min_temperature': '3.265', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 14, 0, 25), 'min_temp_time': datetime.datetime(2019, 3, 31, 6, 0, 23), 'max_press': '112.878', 'min_press': '101.325', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 30, 16, 0, 23), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'price': '0.000', 'use_volume_work': '287115.02', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000102
此查询区间,当前编号下总共抄表记录: 285
此查询区间,上一月最后一天内当前编号下总共抄表记录: 226
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000273'}]
0000000273
00036000000102 ☆ sum_total_volume is None 置为0
00036000000102
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000216')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000273', 'rtu_no': '00030000000142', 'flmeter_no': '00036000000102', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 51, 93727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '16777475', 'work_sum': '65796', 'max_std_flow': '521.09', 'min_std_flow': '0.0', 'avg_std_flow': '493.0', 'max_std_flow_time': datetime.datetime(2019, 4, 1, 21, 22, 39, 842000), 'min_std_flow_time': datetime.datetime(2019, 3, 27, 17, 6, 40, 542000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 1, 21, 22, 35, 592000), 'min_work_flow_time': datetime.datetime(2019, 3, 27, 17, 6, 40, 542000), 'max_temperature': '8.0', 'min_temperature': '-9.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 4, 1, 21, 22, 39, 810000), 'min_temp_time': datetime.datetime(2019, 4, 1, 21, 22, 39, 842000), 'max_press': '111.3', 'min_press': '0.0', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 4, 1, 21, 22, 39, 842000), 'min_press_time': datetime.datetime(2019, 3, 27, 17, 6, 40, 542000), 'price': '0', 'use_volume_work': '65796.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[IC卡密码与燃气表密码不一致][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[IC卡密码与燃气表密码不一致][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '29.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000102处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000081
此查询区间,当前编号下总共抄表记录: 131
此查询区间,上一月最后一天内当前编号下总共抄表记录: 226
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000274'}]
0000000274
00036000000081 ☆ sum_total_volume is None 置为0
00036000000081
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000183')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000274', 'rtu_no': '00030000000121', 'flmeter_no': '00036000000081', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 51, 465728), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '16777489', 'work_sum': '65810', 'max_std_flow': '529.17', 'min_std_flow': '0.0', 'avg_std_flow': '452.0', 'max_std_flow_time': datetime.datetime(2019, 4, 1, 16, 55, 42, 342000), 'min_std_flow_time': datetime.datetime(2019, 3, 25, 11, 42, 50, 984000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 1, 10, 11, 25, 978000), 'min_work_flow_time': datetime.datetime(2019, 3, 25, 11, 42, 50, 984000), 'max_temperature': '16.1', 'min_temperature': '-17.1', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 4, 1, 16, 55, 42, 310000), 'min_temp_time': datetime.datetime(2019, 4, 1, 16, 55, 42, 342000), 'max_press': '121.3', 'min_press': '0.0', 'avg_press': '91.0', 'max_press_time': datetime.datetime(2019, 4, 1, 16, 55, 42, 342000), 'min_press_time': datetime.datetime(2019, 3, 25, 11, 42, 50, 984000), 'price': '0', 'use_volume_work': '65810.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[IC卡密码与燃气表密码不一致][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[IC卡密码与燃气表密码不一致][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '91.0', 'press_out': '91.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '36.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000081处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000055
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一月最后一天内当前编号下总共抄表记录: 250
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000275'}]
0000000275
00036000000055 ☆ sum_total_volume is None 置为0
00036000000055
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000233')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000275', 'rtu_no': '00030000000097', 'flmeter_no': '00036000000055', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 51, 901699), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 5, 24, 38, 724000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 23, 5, 177000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 1, 5, 24, 38, 724000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 23, 5, 177000), 'max_temperature': '13.3', 'min_temperature': '10.9', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 1, 9, 26, 17, 91000), 'min_temp_time': datetime.datetime(2019, 3, 1, 6, 25, 6, 826000), 'max_press': '102.0', 'min_press': '98.9', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 1, 8, 25, 52, 241000), 'min_press_time': datetime.datetime(2019, 3, 1, 5, 24, 38, 724000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 8.0, 'total_buy_volume': None, 'total_buy_money': '16', 'remain_money': '8', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000055处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000047
此查询区间,当前编号下总共抄表记录: 392
此查询区间,上一月最后一天内当前编号下总共抄表记录: 259
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000276'}]
0000000276
00036000000047 ☆ sum_total_volume is None 置为0
00036000000047
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000184')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000276', 'rtu_no': '00030000000089', 'flmeter_no': '00036000000047', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 52, 235727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '12', 'work_sum': '12', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 20, 54, 18, 606000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 52, 13, 49000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 54, 18, 606000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 52, 13, 49000), 'max_temperature': '24.7', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 3, 22, 16, 10, 4, 968000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 52, 13, 49000), 'max_press': '102.2', 'min_press': '0.0', 'avg_press': '88.0', 'max_press_time': datetime.datetime(2019, 3, 23, 12, 16, 38, 15000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 52, 13, 49000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 21.0, 'total_buy_volume': None, 'total_buy_money': '119', 'remain_money': '98', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '32', 'press_in': '88.0', 'press_out': '88.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000047处理好数据已写入oracle
----------------------------------------------------------------------------------------
0800007983
此查询区间,当前编号下总共抄表记录: 54
此查询区间,上一月最后一天内当前编号下总共抄表记录: 261
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000277'}]
0000000277
0800007983 ☆ use_volume_work <0 置为0
0800007983 ☆ sum_total_volume is None 置为0
0800007983
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000240')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000277', 'rtu_no': '00030000000114', 'flmeter_no': '0800007983', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 52, 610729), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 25, 1, 21, 4, 343000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 270000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 25, 1, 21, 4, 343000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 270000), 'max_temperature': '15.8', 'min_temperature': '10.8', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 3, 21, 1, 20, 39, 999000), 'min_temp_time': datetime.datetime(2019, 3, 4, 1, 20, 47, 10000), 'max_press': '102.1', 'min_press': '100.4', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 21, 16, 499000), 'min_press_time': datetime.datetime(2019, 3, 21, 1, 21, 2, 468000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
0800007983处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000099
此查询区间,当前编号下总共抄表记录: 14
此查询区间,上一月最后一天内当前编号下总共抄表记录: 261
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000278'}]
0000000278
00036000000099 ☆ use_volume_work <0 置为0
00036000000099 ☆ sum_total_volume is None 置为0
00036000000099
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000217')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000278', 'rtu_no': '00030000000139', 'flmeter_no': '00036000000099', 'customer_no': '00030000000052', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 52, 986727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '1.42', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 13, 52, 53, 369000), 'min_std_flow_time': datetime.datetime(2019, 3, 29, 12, 43, 27, 437000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 15, 28, 40, 950000), 'min_work_flow_time': datetime.datetime(2019, 3, 29, 12, 43, 27, 437000), 'max_temperature': '19.9', 'min_temperature': '16.7', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 1, 21, 24, 765000), 'min_temp_time': datetime.datetime(2019, 3, 29, 12, 43, 27, 437000), 'max_press': '104.4', 'min_press': '100.2', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 30, 14, 28, 16, 892000), 'min_press_time': datetime.datetime(2019, 3, 29, 12, 46, 56, 656000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 6.0, 'total_buy_volume': None, 'total_buy_money': '7', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '22.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000099处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000070
此查询区间,当前编号下总共抄表记录: 290
此查询区间,上一月最后一天内当前编号下总共抄表记录: 271
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000279'}]
0000000279
00036000000070 ☆ use_volume_work <0 置为0
00036000000070 ☆ sum_total_volume is None 置为0
00036000000070
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000182')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000279', 'rtu_no': '00030000000112', 'flmeter_no': '00036000000070', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 53, 341724), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 9, 936000), 'min_std_flow_time': datetime.datetime(2019, 2, 28, 23, 59, 37, 211000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 9, 936000), 'min_work_flow_time': datetime.datetime(2019, 2, 28, 23, 59, 37, 211000), 'max_temperature': '22.9', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 6, 14, 9, 22, 920000), 'min_temp_time': datetime.datetime(2019, 3, 6, 9, 56, 31, 469000), 'max_press': '102.4', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 22, 45, 749000), 'min_press_time': datetime.datetime(2019, 3, 6, 9, 56, 31, 469000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000070处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000064
此查询区间,当前编号下总共抄表记录: 671
此查询区间,上一月最后一天内当前编号下总共抄表记录: 289
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000280'}]
0000000280
00036000000064 ☆ use_volume_work <0 置为0
00036000000064 ☆ sum_total_volume is None 置为0
00036000000064
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000197')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000280', 'rtu_no': '00030000000106', 'flmeter_no': '00036000000064', 'customer_no': '00030000000046', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 53, 684732), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.74', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 22, 26, 54, 317000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 130000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 17, 8, 13, 890000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 130000), 'max_temperature': '22.2', 'min_temperature': '-4.8', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 5, 9, 24, 11, 635000), 'min_temp_time': datetime.datetime(2019, 3, 4, 16, 33, 25, 278000), 'max_press': '109.2', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 23, 12, 18, 34, 156000), 'min_press_time': datetime.datetime(2019, 3, 5, 11, 34, 53, 276000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000064处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000052
此查询区间,当前编号下总共抄表记录: 665
此查询区间,上一月最后一天内当前编号下总共抄表记录: 309
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000281'}]
0000000281
00036000000052 ☆ sum_total_volume is None 置为0
00036000000052
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000186')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000281', 'rtu_no': '00030000000094', 'flmeter_no': '00036000000052', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 54, 35727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '6518', 'work_sum': '6320', 'max_std_flow': '19.2', 'min_std_flow': '0.0', 'avg_std_flow': '3.0', 'max_std_flow_time': datetime.datetime(2019, 3, 16, 10, 25, 14, 646000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 44, 633000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 35, 2, 796000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 44, 633000), 'max_temperature': '30.8', 'min_temperature': '15.4', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 17, 28, 39, 109000), 'min_temp_time': datetime.datetime(2019, 3, 22, 6, 22, 56, 312000), 'max_press': '105.7', 'min_press': '95.3', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 3, 7, 1, 21, 50, 793000), 'min_press_time': datetime.datetime(2019, 3, 29, 16, 29, 14, 984000), 'price': '1.0', 'use_volume_work': '6308.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '2.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000052处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000063
此查询区间,当前编号下总共抄表记录: 460
此查询区间,上一月最后一天内当前编号下总共抄表记录: 310
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000282'}]
0000000282
00036000000063 ☆ use_volume_work <0 置为0
00036000000063 ☆ sum_total_volume is None 置为0
00036000000063
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000227')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000282', 'rtu_no': '00030000000105', 'flmeter_no': '00036000000063', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 54, 389743), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.02', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 9, 10, 9, 387000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 59, 726000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 4, 13, 45000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 59, 726000), 'max_temperature': '16.3', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 3, 7, 15, 55, 23, 879000), 'min_temp_time': datetime.datetime(2019, 3, 2, 3, 41, 57, 646000), 'max_press': '102.3', 'min_press': '0.0', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 31, 22, 4, 45, 685000), 'min_press_time': datetime.datetime(2019, 3, 2, 3, 41, 57, 646000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '3.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000063处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000022
此查询区间,当前编号下总共抄表记录: 272
此查询区间,上一月最后一天内当前编号下总共抄表记录: 322
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000283'}]
0000000283
00036000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000191')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000283', 'rtu_no': None, 'flmeter_no': '00036000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 54, 764727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '1559304.890', 'work_sum': '442929.400', 'max_std_flow': '153.93', 'min_std_flow': '0.0', 'avg_std_flow': '76.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 10, 0, 21), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 23), 'max_work_flow': '36.47', 'min_work_flow': '0.0', 'avg_work_flow': '18.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 10, 0, 21), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 23), 'max_temperature': '20.421', 'min_temperature': '5.987', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 15, 14, 0, 24), 'min_temp_time': datetime.datetime(2019, 3, 1, 8, 0, 24), 'max_press': '443.732', 'min_press': '101.033', 'avg_press': '387.0', 'max_press_time': datetime.datetime(2019, 3, 27, 4, 0, 22), 'min_press_time': datetime.datetime(2019, 3, 2, 0, 0, 22), 'price': '0.000', 'use_volume_work': '442917.4', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '387.0', 'press_out': '387.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000066
此查询区间,当前编号下总共抄表记录: 269
此查询区间,上一月最后一天内当前编号下总共抄表记录: 329
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000284'}]
0000000284
00036000000066 ☆ sum_total_volume is None 置为0
00036000000066
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000236')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000284', 'rtu_no': '00030000000108', 'flmeter_no': '00036000000066', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 55, 125726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '41', 'work_sum': '39', 'max_std_flow': '4.3', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 23, 16, 7, 34, 749000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 14, 25, 26, 233000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 8, 6, 14, 141000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 9, 24, 40, 180000), 'max_temperature': '32.1', 'min_temperature': '4.6', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 15, 12, 24, 53, 911000), 'min_temp_time': datetime.datetime(2019, 3, 7, 23, 28, 57, 458000), 'max_press': '108.4', 'min_press': '92.1', 'avg_press': '105.0', 'max_press_time': datetime.datetime(2019, 3, 8, 8, 23, 17, 656000), 'min_press_time': datetime.datetime(2019, 3, 20, 14, 4, 3, 718000), 'price': '1.0', 'use_volume_work': '27.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '18.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000066处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000067
此查询区间,当前编号下总共抄表记录: 482
此查询区间,上一月最后一天内当前编号下总共抄表记录: 361
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000285'}]
0000000285
00036000000067 ☆ use_volume_work <0 置为0
00036000000067 ☆ sum_total_volume is None 置为0
00036000000067
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000224')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000285', 'rtu_no': '00030000000109', 'flmeter_no': '00036000000067', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 55, 452694), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 17, 0, 8, 584000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 10, 49, 109000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 17, 0, 8, 584000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 10, 49, 109000), 'max_temperature': '22.7', 'min_temperature': '12.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 5, 17, 34, 13, 251000), 'min_temp_time': datetime.datetime(2019, 3, 4, 8, 26, 48, 38000), 'max_press': '105.8', 'min_press': '100.4', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 11, 14, 59, 35, 156000), 'min_press_time': datetime.datetime(2019, 3, 21, 1, 22, 17, 234000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000067处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000043
此查询区间,当前编号下总共抄表记录: 69
此查询区间,上一月最后一天内当前编号下总共抄表记录: 371
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000286'}]
0000000286
00036000000043 ☆ use_volume_work <0 置为0
00036000000043 ☆ sum_total_volume is None 置为0
00036000000043
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000225')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000286', 'rtu_no': '00030000000084', 'flmeter_no': '00036000000043', 'customer_no': '00030000000035', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 55, 791727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 0, 20, 59, 782000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 1, 45, 181000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 0, 20, 59, 782000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 1, 45, 181000), 'max_temperature': '14.7', 'min_temperature': '8.1', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 27, 0, 20, 37, 328000), 'min_temp_time': datetime.datetime(2019, 3, 1, 11, 25, 2, 47000), 'max_press': '102.7', 'min_press': '90.1', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 7, 0, 21, 9, 243000), 'min_press_time': datetime.datetime(2019, 3, 10, 23, 25, 18, 693000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '8.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000043处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000013
此查询区间,当前编号下总共抄表记录: 5268
此查询区间,上一月最后一天内当前编号下总共抄表记录: 371
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000287'}]
0000000287
00036000000013 ☆ sum_total_money <0 置为0
00036000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000195')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000287', 'rtu_no': '00030000000018', 'flmeter_no': '00036000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 56, 159702), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '2073', 'work_sum': '173', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 6, 187000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 1, 206000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 6, 187000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 1, 206000), 'max_temperature': '22.0', 'min_temperature': '20.0', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 17, 55, 6, 187000), 'min_temp_time': datetime.datetime(2019, 3, 4, 9, 52, 26, 613000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 29, 17, 55, 6, 187000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 25, 1, 206000), 'price': '2.39', 'use_volume_work': '161.0', 'use_volume_std': '2073.0', 'use_money': '4954.47', 'sum_total_volume': '2073', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1949.4', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000023
此查询区间,当前编号下总共抄表记录: 273
此查询区间,上一月最后一天内当前编号下总共抄表记录: 383
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000288'}]
0000000288
00036000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000220')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000288', 'rtu_no': None, 'flmeter_no': '00036000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 56, 610726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '187556.770', 'work_sum': '73774.320', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 16, 0, 24), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 16, 0, 24), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'max_temperature': '26.86', 'min_temperature': '1.332', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 3, 27, 16, 0, 22), 'min_temp_time': datetime.datetime(2019, 3, 1, 8, 0, 25), 'max_press': '112.372', 'min_press': '100.91', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 3, 1, 14, 0, 25), 'min_press_time': datetime.datetime(2019, 3, 29, 6, 0, 22), 'price': '0.000', 'use_volume_work': '73762.32', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000068
此查询区间,当前编号下总共抄表记录: 468
此查询区间,上一月最后一天内当前编号下总共抄表记录: 418
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000289'}]
0000000289
00036000000068 ☆ use_volume_work <0 置为0
00036000000068 ☆ sum_total_volume is None 置为0
00036000000068
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000228')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000289', 'rtu_no': '00030000000110', 'flmeter_no': '00036000000068', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 56, 952727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '2', 'work_sum': '2', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 26, 1, 20, 56, 859000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 7, 26, 357000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 26, 1, 20, 56, 859000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 7, 26, 357000), 'max_temperature': '22.2', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 3, 5, 12, 27, 6, 357000), 'min_temp_time': datetime.datetime(2019, 3, 14, 15, 55, 14, 818000), 'max_press': '106.4', 'min_press': '0.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 8, 3, 40, 2, 673000), 'min_press_time': datetime.datetime(2019, 3, 14, 15, 55, 14, 818000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[电量不足关阀][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[电量不足关阀][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000068处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000004
此查询区间,当前编号下总共抄表记录: 5275
此查询区间,上一月最后一天内当前编号下总共抄表记录: 418
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000290'}]
0000000290
00036000000004 ☆ sum_total_money <0 置为0
00036000000004
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000212')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000290', 'rtu_no': '00030000000018', 'flmeter_no': '00036000000004', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 57, 307727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '60364', 'work_sum': '51790', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 16, 25, 6, 296000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 27, 534000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 16, 25, 6, 296000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 27, 534000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 16, 25, 6, 296000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 26, 27, 534000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 29, 16, 25, 6, 296000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 26, 27, 534000), 'price': '2.39', 'use_volume_work': '51778.0', 'use_volume_std': '60364.0', 'use_money': '144269.96', 'sum_total_volume': '60364', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '52000.2', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000004处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000051
此查询区间,当前编号下总共抄表记录: 1002
此查询区间,上一月最后一天内当前编号下总共抄表记录: 441
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000291'}]
0000000291
00036000000051 ☆ use_volume_work <0 置为0
00036000000051 ☆ sum_total_volume is None 置为0
00036000000051
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000193')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000291', 'rtu_no': '00030000000093', 'flmeter_no': '00036000000051', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 57, 823696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 22, 977000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 40, 772000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 22, 977000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 40, 772000), 'max_temperature': '19.8', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 19, 46, 49, 187000), 'min_temp_time': datetime.datetime(2019, 3, 2, 9, 27, 56, 971000), 'max_press': '106.6', 'min_press': '99.6', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 23, 8, 25, 25, 562000), 'min_press_time': datetime.datetime(2019, 3, 20, 14, 30, 36, 906000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '21.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000051处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000040
此查询区间,当前编号下总共抄表记录: 473
此查询区间,上一月最后一天内当前编号下总共抄表记录: 473
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000292'}]
0000000292
00036000000040 ☆ use_volume_work <0 置为0
00036000000040 ☆ sum_total_volume is None 置为0
00036000000040
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000237')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000292', 'rtu_no': '00030000000081', 'flmeter_no': '00036000000040', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 58, 209696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '13.01', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 21, 12, 25, 56, 828000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 22, 9, 881000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 13, 7, 50, 882000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 22, 9, 881000), 'max_temperature': '23.4', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 11, 14, 14, 0, 271000), 'min_temp_time': datetime.datetime(2019, 3, 5, 13, 10, 27, 951000), 'max_press': '114.0', 'min_press': '0.0', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 3, 8, 21, 42, 34, 952000), 'min_press_time': datetime.datetime(2019, 3, 5, 13, 10, 27, 951000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000040处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000008
此查询区间,当前编号下总共抄表记录: 551
此查询区间,上一月最后一天内当前编号下总共抄表记录: 473
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000293'}]
0000000293
00036000000008 ☆ use_volume_work <0 置为0
00036000000008 ☆ sum_total_money <0 置为0
00036000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000198')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000293', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 58, 545698), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 38, 786000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 42, 502000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 38, 786000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 42, 502000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 13, 59, 38, 786000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 25, 42, 502000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 14, 13, 59, 38, 786000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 25, 42, 502000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '48420.0', 'use_money': '48420.0', 'sum_total_volume': '48420', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '51651.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000061
此查询区间,当前编号下总共抄表记录: 765
此查询区间,上一月最后一天内当前编号下总共抄表记录: 499
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000294'}]
0000000294
00036000000061 ☆ use_volume_work <0 置为0
00036000000061 ☆ sum_total_volume is None 置为0
00036000000061
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000234')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000294', 'rtu_no': '00030000000103', 'flmeter_no': '00036000000061', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 58, 887727), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 47, 106000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 39, 364000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 47, 106000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 39, 364000), 'max_temperature': '15.5', 'min_temperature': '10.7', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 16, 28, 36, 100000), 'min_temp_time': datetime.datetime(2019, 3, 4, 7, 23, 52, 570000), 'max_press': '105.9', 'min_press': '99.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 1, 10, 24, 55, 915000), 'min_press_time': datetime.datetime(2019, 3, 20, 15, 26, 47, 281000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000061处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000045
此查询区间,当前编号下总共抄表记录: 43
此查询区间,上一月最后一天内当前编号下总共抄表记录: 502
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000295'}]
0000000295
00036000000045 ☆ use_volume_work <0 置为0
00036000000045 ☆ sum_total_volume is None 置为0
00036000000045
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000209')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000295', 'rtu_no': '00030000000086', 'flmeter_no': '00036000000045', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 59, 253696), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 10, 15, 44, 264000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 10, 15, 58, 838000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 10, 15, 44, 264000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 10, 15, 58, 838000), 'max_temperature': '18.6', 'min_temperature': '18.6', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 10, 15, 44, 264000), 'min_temp_time': datetime.datetime(2019, 3, 1, 10, 15, 58, 838000), 'max_press': '102.2', 'min_press': '102.2', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 31, 10, 15, 44, 264000), 'min_press_time': datetime.datetime(2019, 3, 1, 10, 15, 58, 838000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '37', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000045处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000018
此查询区间,当前编号下总共抄表记录: 660
此查询区间,上一月最后一天内当前编号下总共抄表记录: 505
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000296'}]
0000000296
00036000000018 ☆ sum_total_volume is None 置为0
00036000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000213')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000296', 'rtu_no': '00030000000049', 'flmeter_no': '00036000000018', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 59, 590726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '98', 'work_sum': '98', 'max_std_flow': '1001.02', 'min_std_flow': '0.0', 'avg_std_flow': '51.0', 'max_std_flow_time': datetime.datetime(2019, 3, 19, 16, 30, 56, 562000), 'min_std_flow_time': datetime.datetime(2019, 3, 6, 11, 41, 22, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 2, 22, 12, 378000), 'min_work_flow_time': datetime.datetime(2019, 3, 6, 11, 41, 22, 840000), 'max_temperature': '2491.0', 'min_temperature': '0.0', 'avg_temperature': '23.0', 'max_temp_time': datetime.datetime(2019, 3, 26, 8, 54, 31, 953000), 'min_temp_time': datetime.datetime(2019, 3, 6, 15, 30, 49, 666000), 'max_press': '103.0', 'min_press': '0.0', 'avg_press': '85.0', 'max_press_time': datetime.datetime(2019, 3, 7, 20, 15, 39, 19000), 'min_press_time': datetime.datetime(2019, 3, 6, 15, 30, 49, 666000), 'price': '0.01', 'use_volume_work': '86.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '14', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[预留][电量不足关阀][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[预留][电量不足关阀][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '65', 'press_in': '85.0', 'press_out': '85.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '22.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000011
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一月最后一天内当前编号下总共抄表记录: 505
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000297'}]
0000000297
00036000000011
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000231')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000297', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000011', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 59, 953726), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '69322376.950', 'work_sum': '16270391.670', 'max_std_flow': '685.94', 'min_std_flow': '685.94', 'avg_std_flow': '685.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_std_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'max_work_flow': '141.87', 'min_work_flow': '141.87', 'avg_work_flow': '141.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_work_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'max_temperature': '4.89', 'min_temperature': '4.89', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_temp_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'max_press': '460.439', 'min_press': '460.439', 'avg_press': '460.0', 'max_press_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_press_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'price': '0.000', 'use_volume_work': '16270379.67', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '460.0', 'press_out': '460.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000011处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000012
此查询区间,当前编号下总共抄表记录: 63
此查询区间,上一月最后一天内当前编号下总共抄表记录: 507
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000298'}]
0000000298
00036000000012 ☆ sum_total_volume is None 置为0
00036000000012
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000200')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000298', 'rtu_no': '00030000000043', 'flmeter_no': '00036000000012', 'customer_no': '00030000000005', 'report_time': datetime.datetime(2019, 4, 5, 16, 59, 0, 294720), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '6837', 'work_sum': '6828', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 22, 53, 996000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 1, 661000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 22, 53, 996000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 1, 661000), 'max_temperature': '15.5', 'min_temperature': '11.5', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 1, 20, 55, 578000), 'min_temp_time': datetime.datetime(2019, 3, 4, 1, 20, 51, 323000), 'max_press': '102.3', 'min_press': '100.2', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 21, 32, 718000), 'min_press_time': datetime.datetime(2019, 3, 6, 16, 55, 28, 200000), 'price': '1.0', 'use_volume_work': '6816.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2999', 'remain_money': '2999', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000012处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000059
此查询区间,当前编号下总共抄表记录: 682
此查询区间,上一月最后一天内当前编号下总共抄表记录: 535
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000299'}]
0000000299
00036000000059 ☆ use_volume_work <0 置为0
00036000000059 ☆ sum_total_volume is None 置为0
00036000000059
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000238')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000299', 'rtu_no': '00030000000101', 'flmeter_no': '00036000000059', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 59, 0, 655728), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '10', 'work_sum': '10', 'max_std_flow': '17.99', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 26, 14, 24, 52, 156000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 12, 21, 233000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 5, 865000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 12, 21, 233000), 'max_temperature': '21.2', 'min_temperature': '0.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 6, 5, 7, 2, 613000), 'min_temp_time': datetime.datetime(2019, 3, 25, 15, 31, 46, 531000), 'max_press': '106.5', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 22, 7, 32, 59, 828000), 'min_press_time': datetime.datetime(2019, 3, 25, 15, 31, 46, 531000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 11.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '4', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000059处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000038
此查询区间,当前编号下总共抄表记录: 680
此查询区间,上一月最后一天内当前编号下总共抄表记录: 538
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000300'}]
0000000300
00036000000038 ☆ use_volume_work <0 置为0
00036000000038 ☆ sum_total_volume is None 置为0
00036000000038
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000235')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000300', 'rtu_no': '00030000000079', 'flmeter_no': '00036000000038', 'customer_no': '00030000000016', 'report_time': datetime.datetime(2019, 4, 5, 16, 59, 0, 993708), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 35, 48, 574000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 24, 32, 973000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 35, 48, 574000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 24, 32, 973000), 'max_temperature': '15.4', 'min_temperature': '8.2', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 27, 19, 46, 4, 203000), 'min_temp_time': datetime.datetime(2019, 3, 1, 12, 27, 46, 704000), 'max_press': '103.3', 'min_press': '99.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 23, 9, 26, 41, 984000), 'min_press_time': datetime.datetime(2019, 3, 20, 15, 39, 47, 281000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000038处理好数据已写入oracle
----------------------------------------------------------------------------------------
0003 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0002
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0002 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0010
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0010 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0018
💗 I am main()
总共抄表数据: 211
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0018 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00186000000001
此查询区间,当前编号下总共抄表记录: 211
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000005'}]
0000000005
00186000000001 ☆ sum_total_volume is None 置为0
00186000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0018', '00182019030000000004')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0018', 'srm_id': '00182019030000000005', 'rtu_no': '00180000000001', 'flmeter_no': '00186000000001', 'customer_no': '00180000000001', 'report_time': datetime.datetime(2019, 4, 5, 16, 59, 1, 847699), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '15.7', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 13, 46, 34, 265000), 'min_std_flow_time': datetime.datetime(2019, 3, 25, 16, 23, 46, 453000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 18, 972000), 'min_work_flow_time': datetime.datetime(2019, 3, 25, 16, 23, 46, 453000), 'max_temperature': '20.0', 'min_temperature': '0.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 0, 28, 50, 578000), 'min_temp_time': datetime.datetime(2019, 3, 25, 16, 23, 46, 453000), 'max_press': '101.5', 'min_press': '0.0', 'avg_press': '91.0', 'max_press_time': datetime.datetime(2019, 3, 28, 10, 32, 21, 218000), 'min_press_time': datetime.datetime(2019, 3, 25, 16, 23, 46, 453000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '100', 'remain_money': '100', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '91.0', 'press_out': '91.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '21.0', 'srm_status': '1'}]
insert sys_serial_no ok
00186000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0018 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0006
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0006 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0013
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0013 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0014
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0014 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
all done-月报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-04-05 16:58:24.546702
程序运行结束时间: 2019-04-05 16:59:02.549767
整个程序运行总时间: 38 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 3e-07
程序运行结束time.clock(): 38.0026865
整个程序运行总时间time.clock()差: 38.0026862 秒
----------------------------------------------------------------------------------------
============================================================================================================================================================分隔符
此机构: 0008
💗 I am main()
总共抄表数据: 741
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0008 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00086000000008
此查询区间,当前编号下总共抄表记录: 741
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000008'}]
0000000008
00086000000008 ☆ sum_total_volume is None 置为0
00086000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0008', '00082019030000000007')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0008', 'srm_id': '00082019030000000008', 'rtu_no': '00080000000003', 'flmeter_no': '00086000000008', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 46, 538450), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 22, 31, 26, 505000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 14, 32, 35, 565000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 22, 31, 26, 505000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 14, 32, 35, 565000), 'max_temperature': '21.1', 'min_temperature': '15.0', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 18, 16, 31, 48, 989000), 'min_temp_time': datetime.datetime(2019, 3, 31, 5, 22, 57, 198000), 'max_press': '103.4', 'min_press': '99.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 7, 11, 31, 30, 661000), 'min_press_time': datetime.datetime(2019, 3, 20, 11, 26, 56, 906000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '100', 'remain_money': '100', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00086000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
0008 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0015
💗 I am main()
总共抄表数据: 41
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0015 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00156000000001
此查询区间,当前编号下总共抄表记录: 41
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0015', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0015', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000006'}]
0000000006
00156000000001 ☆ use_volume_work <0 置为0
00156000000001 ☆ sum_total_volume is None 置为0
00156000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0015', '00152019030000000005')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0015', 'srm_id': '00152019030000000006', 'rtu_no': '00150000000001', 'flmeter_no': '00156000000001', 'customer_no': '00150000000001', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 46, 976449), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 15, 20, 14, 55, 114000), 'min_std_flow_time': datetime.datetime(2019, 3, 12, 16, 42, 13, 927000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 15, 20, 14, 55, 114000), 'min_work_flow_time': datetime.datetime(2019, 3, 12, 16, 42, 13, 927000), 'max_temperature': '28.9', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 16, 56, 15, 630000), 'min_temp_time': datetime.datetime(2019, 3, 12, 17, 4, 58, 302000), 'max_press': '102.2', 'min_press': '0.0', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 3, 15, 10, 8, 46, 474000), 'min_press_time': datetime.datetime(2019, 3, 12, 17, 4, 58, 302000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 15.0, 'total_buy_volume': None, 'total_buy_money': '20', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '5.0', 'srm_status': '1'}]
insert sys_serial_no ok
00156000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0015 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0017
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0017 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0005
💗 I am main()
总共抄表数据: 55412
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 656
0005 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 22
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00056000000019
此查询区间,当前编号下总共抄表记录: 2147
此查询区间,上一月最后一天内当前编号下总共抄表记录: 39
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000262'}]
0000000262
00056000000019 ☆ sum_total_money <0 置为0
00056000000019
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000246')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000262', 'rtu_no': '00050000000016', 'flmeter_no': '00056000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 50, 83448), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '195381', 'work_sum': '179664', 'max_std_flow': '104.61', 'min_std_flow': '0.0', 'avg_std_flow': '2.0', 'max_std_flow_time': datetime.datetime(2019, 3, 22, 8, 21, 40, 984000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 36, 766000), 'max_work_flow': '114.82', 'min_work_flow': '0.0', 'avg_work_flow': '3.0', 'max_work_flow_time': datetime.datetime(2019, 3, 19, 8, 8, 48, 911000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 36, 766000), 'max_temperature': '12.79', 'min_temperature': '1.36', 'avg_temperature': '8.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 19, 42, 53, 624000), 'min_temp_time': datetime.datetime(2019, 3, 3, 8, 46, 37, 822000), 'max_press': '98.34', 'min_press': '87.11', 'avg_press': '89.0', 'max_press_time': datetime.datetime(2019, 3, 19, 13, 21, 37, 156000), 'min_press_time': datetime.datetime(2019, 3, 3, 18, 50, 46, 261000), 'price': '2.28', 'use_volume_work': '179664.0', 'use_volume_std': '3896.0', 'use_money': '8882.88', 'sum_total_volume': '179664', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '16393.62', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '89.0', 'press_out': '89.0', 'temp_in': '8.0', 'temp_out': '8.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000019处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 1630
此查询区间,上一月最后一天内当前编号下总共抄表记录: 12
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000263'}]
0000000263
00056000000024 ☆ sum_total_money <0 置为0
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000261')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000263', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 50, 398480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '246780', 'work_sum': '246780', 'max_std_flow': '111.71', 'min_std_flow': '0.0', 'avg_std_flow': '18.0', 'max_std_flow_time': datetime.datetime(2019, 3, 24, 5, 49, 3, 749000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 18, 51, 243000), 'max_work_flow': '131.48', 'min_work_flow': '0.0', 'avg_work_flow': '21.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 18, 41, 35, 328000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 18, 51, 243000), 'max_temperature': '22.87', 'min_temperature': '12.69', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 16, 22, 37, 948000), 'min_temp_time': datetime.datetime(2019, 3, 1, 7, 25, 5, 711000), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 3, 31, 22, 2, 36, 491000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 18, 51, 243000), 'price': '1.43', 'use_volume_work': '19390.0', 'use_volume_std': '19390.0', 'use_money': '27727.7', 'sum_total_volume': '246780', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '6199.36', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 2513
此查询区间,上一月最后一天内当前编号下总共抄表记录: 40
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000264'}]
0000000264
00056000000020 ☆ sum_total_money <0 置为0
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000249')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000264', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 50, 693479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '29933', 'work_sum': '32207', 'max_std_flow': '0.22', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 14, 32, 10, 703000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 47, 985000), 'max_work_flow': '0.24', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 14, 32, 10, 703000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 47, 985000), 'max_temperature': '33.96', 'min_temperature': '20.0', 'avg_temperature': '31.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 22, 0, 47, 640000), 'min_temp_time': datetime.datetime(2019, 3, 3, 8, 15, 6, 34000), 'max_press': '101.89', 'min_press': '93.17', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 3, 14, 0, 57, 3, 286000), 'min_press_time': datetime.datetime(2019, 3, 19, 7, 41, 8, 755000), 'price': '1.59', 'use_volume_work': '32207.0', 'use_volume_std': '4.0', 'use_money': '6.36', 'sum_total_volume': '29933', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '461.6', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '31.0', 'temp_out': '31.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 2220
此查询区间,上一月最后一天内当前编号下总共抄表记录: 27
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000265'}]
0000000265
00056000000014 ☆ sum_total_money <0 置为0
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000244')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000265', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 50, 992504), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 52, 28, 989000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 55, 44, 809000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 52, 28, 989000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 55, 44, 809000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 52, 28, 989000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 55, 44, 809000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 52, 28, 989000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 55, 44, 809000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '562.0', 'use_money': '1281.36', 'sum_total_volume': '4292', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1065.54', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 2497
此查询区间,上一月最后一天内当前编号下总共抄表记录: 39
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000266'}]
0000000266
00056000000022 ☆ sum_total_money <0 置为0
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000239')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000266', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 51, 301480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 20, 0, 2, 87000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 36, 18, 402000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 0, 2, 87000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 36, 18, 402000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 20, 0, 2, 87000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 36, 18, 402000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 20, 0, 2, 87000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 36, 18, 402000), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '327.0', 'use_money': '526.47', 'sum_total_volume': '6027', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '415.34', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000015
此查询区间,当前编号下总共抄表记录: 2511
此查询区间,上一月最后一天内当前编号下总共抄表记录: 35
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000267'}]
0000000267
00056000000015 ☆ sum_total_money <0 置为0
00056000000015
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000253')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000267', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000015', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 51, 627458), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '337378', 'work_sum': '245624', 'max_std_flow': '102.94', 'min_std_flow': '0.0', 'avg_std_flow': '5.0', 'max_std_flow_time': datetime.datetime(2019, 3, 25, 7, 30, 43, 859000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 0, 33, 164000), 'max_work_flow': '121.75', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 21, 10, 4, 124000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 0, 33, 164000), 'max_temperature': '20.52', 'min_temperature': '6.75', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 18, 10, 4, 269000), 'min_temp_time': datetime.datetime(2019, 3, 3, 8, 34, 24, 893000), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 50, 1, 928000), 'min_press_time': datetime.datetime(2019, 3, 1, 1, 0, 33, 164000), 'price': '1.55', 'use_volume_work': '8228.0', 'use_volume_std': '8228.0', 'use_money': '12753.4', 'sum_total_volume': '245624', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '44459.28', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000015处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 1749
此查询区间,上一月最后一天内当前编号下总共抄表记录: 41
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000268'}]
0000000268
00056000000028 ☆ sum_total_money <0 置为0
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000250')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000268', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 51, 975480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '129483', 'work_sum': '144628', 'max_std_flow': '312.15', 'min_std_flow': '0.0', 'avg_std_flow': '38.0', 'max_std_flow_time': datetime.datetime(2019, 3, 24, 7, 55, 53, 812000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 5, 3, 964000), 'max_work_flow': '338.95', 'min_work_flow': '0.0', 'avg_work_flow': '41.0', 'max_work_flow_time': datetime.datetime(2019, 3, 22, 6, 41, 54, 499000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 5, 3, 964000), 'max_temperature': '27.92', 'min_temperature': '11.92', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 3, 5, 1, 18, 58, 377000), 'min_temp_time': datetime.datetime(2019, 3, 24, 7, 55, 53, 812000), 'max_press': '98.64', 'min_press': '75.6', 'avg_press': '95.0', 'max_press_time': datetime.datetime(2019, 3, 31, 9, 46, 13, 264000), 'min_press_time': datetime.datetime(2019, 3, 19, 8, 46, 54, 99000), 'price': '1.52', 'use_volume_work': '39417.0', 'use_volume_std': '31183.0', 'use_money': '47398.16', 'sum_total_volume': '129483', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '92789.57', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '95.0', 'press_out': '95.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000016
此查询区间,当前编号下总共抄表记录: 2191
此查询区间,上一月最后一天内当前编号下总共抄表记录: 37
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000269'}]
0000000269
00056000000016 ☆ sum_total_money <0 置为0
00056000000016
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000258')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000269', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 52, 266481), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '462833', 'work_sum': '266207', 'max_std_flow': '103.91', 'min_std_flow': '0.0', 'avg_std_flow': '6.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 45, 4, 167000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 0, 34, 243000), 'max_work_flow': '124.88', 'min_work_flow': '0.0', 'avg_work_flow': '7.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 45, 4, 167000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 0, 34, 243000), 'max_temperature': '21.92', 'min_temperature': '5.97', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 18, 15, 7, 468000), 'min_temp_time': datetime.datetime(2019, 3, 3, 8, 34, 25, 799000), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 50, 3, 306000), 'min_press_time': datetime.datetime(2019, 3, 1, 1, 0, 34, 243000), 'price': '1.55', 'use_volume_work': '8396.0', 'use_volume_std': '8396.0', 'use_money': '13013.8', 'sum_total_volume': '266207', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '36502.84', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000016处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 2208
此查询区间,上一月最后一天内当前编号下总共抄表记录: 41
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000270'}]
0000000270
00056000000025 ☆ sum_total_money <0 置为0
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000251')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000270', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 52, 578481), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 20, 21, 873000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 37, 3, 526000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 20, 21, 873000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 37, 3, 526000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 20, 21, 873000), 'min_temp_time': datetime.datetime(2019, 3, 1, 1, 37, 3, 526000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 20, 21, 873000), 'min_press_time': datetime.datetime(2019, 3, 1, 1, 37, 3, 526000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '1186.0', 'use_money': '2704.08', 'sum_total_volume': '47674', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13252.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 1817
此查询区间,上一月最后一天内当前编号下总共抄表记录: 43
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000271'}]
0000000271
00056000000013 ☆ sum_total_money <0 置为0
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000255')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000271', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 52, 901473), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '3', 'work_sum': '0', 'max_std_flow': '35.91', 'min_std_flow': '0.0', 'avg_std_flow': '29.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 22, 7, 227000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 9, 28, 93000), 'max_work_flow': '35.91', 'min_work_flow': '0.0', 'avg_work_flow': '29.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 22, 7, 227000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 9, 28, 93000), 'max_temperature': '35.91', 'min_temperature': '35.91', 'avg_temperature': '35.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 22, 7, 227000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 9, 28, 93000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 22, 7, 227000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 9, 28, 93000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '4836.0', 'use_money': '11026.08', 'sum_total_volume': '95189', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1132.47', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000030
此查询区间,当前编号下总共抄表记录: 150
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000272'}]
0000000272
00056000000030 ☆ sum_total_volume is None 置为0
00056000000030
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000240')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000272', 'rtu_no': '00050000000025', 'flmeter_no': '00056000000030', 'customer_no': '00050000000022', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 53, 172457), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1.99', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 12, 16, 21, 187000), 'min_std_flow_time': datetime.datetime(2019, 3, 27, 13, 10, 48, 192000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 16, 1, 10, 308000), 'min_work_flow_time': datetime.datetime(2019, 3, 27, 13, 10, 48, 192000), 'max_temperature': '19.6', 'min_temperature': '11.3', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 11, 26, 56, 62000), 'min_temp_time': datetime.datetime(2019, 3, 31, 1, 21, 14, 725000), 'max_press': '100.8', 'min_press': '48.7', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 3, 29, 1, 21, 36, 828000), 'min_press_time': datetime.datetime(2019, 3, 31, 16, 1, 9, 288000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '63', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '26.0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000030处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 2520
此查询区间,上一月最后一天内当前编号下总共抄表记录: 42
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000273'}]
0000000273
00056000000010 ☆ sum_total_money <0 置为0
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000242')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000273', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 53, 499479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '629047', 'work_sum': '629047', 'max_std_flow': '176.36', 'min_std_flow': '-193.0', 'avg_std_flow': '22.0', 'max_std_flow_time': datetime.datetime(2019, 3, 19, 8, 29, 14, 677000), 'min_std_flow_time': datetime.datetime(2019, 3, 15, 17, 22, 34, 630000), 'max_work_flow': '205.86', 'min_work_flow': '0.0', 'avg_work_flow': '26.0', 'max_work_flow_time': datetime.datetime(2019, 3, 19, 8, 29, 14, 677000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 26, 43, 503000), 'max_temperature': '84.47', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 11, 8, 20, 37, 255000), 'min_temp_time': datetime.datetime(2019, 3, 15, 17, 22, 34, 630000), 'max_press': '84.0', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 20, 9, 37, 348000), 'min_press_time': datetime.datetime(2019, 3, 11, 8, 20, 37, 255000), 'price': '1.52', 'use_volume_work': '28033.0', 'use_volume_std': '28033.0', 'use_money': '42610.16', 'sum_total_volume': '629047', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3763.34', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000017
此查询区间,当前编号下总共抄表记录: 2163
此查询区间,上一月最后一天内当前编号下总共抄表记录: 35
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000274'}]
0000000274
00056000000017 ☆ sum_total_money <0 置为0
00056000000017
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000245')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000274', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 53, 869480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '213982', 'work_sum': '221243', 'max_std_flow': '83.42', 'min_std_flow': '0.0', 'avg_std_flow': '8.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 0, 15, 5, 109000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 9, 915000), 'max_work_flow': '100.44', 'min_work_flow': '0.0', 'avg_work_flow': '10.0', 'max_work_flow_time': datetime.datetime(2019, 3, 27, 16, 44, 8, 671000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 9, 915000), 'max_temperature': '22.15', 'min_temperature': '7.6', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 18, 5, 8, 593000), 'min_temp_time': datetime.datetime(2019, 3, 2, 7, 47, 16, 866000), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 55, 3, 986000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 0, 9, 915000), 'price': '1.55', 'use_volume_work': '9948.0', 'use_volume_std': '9948.0', 'use_money': '15419.4', 'sum_total_volume': '221243', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26440.8', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000017处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000008
此查询区间,当前编号下总共抄表记录: 5624
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000275'}]
0000000275
00050000000008 ☆ use_volume_std <0 置为0
00050000000008 ☆ sum_total_money <0 置为0
00050000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000252')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000275', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 54, 183472), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '23', 'work_sum': '29', 'max_std_flow': '0.0', 'min_std_flow': '-2107801.5', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 49, 42, 346000), 'min_std_flow_time': datetime.datetime(2019, 3, 13, 19, 29, 40, 5000), 'max_work_flow': '20.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 13, 19, 29, 40, 5000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 14, 44, 877000), 'max_temperature': '20.0', 'min_temperature': '-2.03', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 49, 42, 346000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 14, 44, 877000), 'max_press': '565.96', 'min_press': '0.0', 'avg_press': '114.0', 'max_press_time': datetime.datetime(2019, 3, 5, 11, 27, 52, 390000), 'min_press_time': datetime.datetime(2019, 3, 5, 16, 29, 3, 610000), 'price': '1.58', 'use_volume_work': '29.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '23', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '500.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '114.0', 'press_out': '114.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00050000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 2212
此查询区间,上一月最后一天内当前编号下总共抄表记录: 38
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000276'}]
0000000276
00056000000029 ☆ sum_total_money <0 置为0
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000248')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000276', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 54, 568452), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 22, 3, 36, 746000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 5, 54, 887000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 22, 3, 36, 746000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 5, 54, 887000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 22, 3, 36, 746000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 5, 54, 887000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 22, 3, 36, 746000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 5, 54, 887000), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '1795.0', 'use_money': '2889.95', 'sum_total_volume': '25566', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5256.34', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000006
此查询区间,当前编号下总共抄表记录: 6349
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000277'}]
0000000277
00050000000006 ☆ sum_total_money <0 置为0
00050000000006
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000243')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000277', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000006', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 54, 926451), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '1000', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 39, 39, 337000), 'min_std_flow_time': datetime.datetime(2019, 3, 2, 15, 40, 46, 844000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 39, 39, 337000), 'min_work_flow_time': datetime.datetime(2019, 3, 2, 15, 40, 46, 844000), 'max_temperature': '35.91', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 4, 10, 44, 38, 793000), 'min_temp_time': datetime.datetime(2019, 3, 12, 8, 12, 45, 995000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 39, 39, 337000), 'min_press_time': datetime.datetime(2019, 3, 2, 15, 40, 46, 844000), 'price': '1.58', 'use_volume_work': '0.0', 'use_volume_std': '1000.0', 'use_money': '1580.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1700.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00050000000006处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 2193
此查询区间,上一月最后一天内当前编号下总共抄表记录: 36
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000278'}]
0000000278
00056000000027 ☆ sum_total_money <0 置为0
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000241')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000278', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 55, 261480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 40, 4, 211000), 'min_std_flow_time': datetime.datetime(2019, 2, 28, 23, 56, 31, 663000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 40, 4, 211000), 'min_work_flow_time': datetime.datetime(2019, 2, 28, 23, 56, 31, 663000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 40, 4, 211000), 'min_temp_time': datetime.datetime(2019, 2, 28, 23, 56, 31, 663000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 40, 4, 211000), 'min_press_time': datetime.datetime(2019, 2, 28, 23, 56, 31, 663000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '4059.0', 'use_money': '9254.52', 'sum_total_volume': '87443', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1467.28', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 1672
此查询区间,上一月最后一天内当前编号下总共抄表记录: 31
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000279'}]
0000000279
00056000000023 ☆ sum_total_money <0 置为0
00056000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000238')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000279', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 55, 570482), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '338581', 'work_sum': '174522', 'max_std_flow': '169.07', 'min_std_flow': '0.0', 'avg_std_flow': '5.0', 'max_std_flow_time': datetime.datetime(2019, 3, 12, 6, 17, 51, 900000), 'min_std_flow_time': datetime.datetime(2019, 2, 28, 23, 58, 46, 570000), 'max_work_flow': '181.23', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 3, 12, 6, 17, 51, 900000), 'min_work_flow_time': datetime.datetime(2019, 2, 28, 23, 58, 46, 570000), 'max_temperature': '24.11', 'min_temperature': '6.92', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 22, 49, 7, 374000), 'min_temp_time': datetime.datetime(2019, 3, 3, 6, 41, 45, 852000), 'max_press': '100.84', 'min_press': '88.08', 'avg_press': '96.0', 'max_press_time': datetime.datetime(2019, 3, 27, 13, 38, 43, 371000), 'min_press_time': datetime.datetime(2019, 3, 19, 18, 52, 7, 484000), 'price': '1.43', 'use_volume_work': '174522.0', 'use_volume_std': '6311.0', 'use_money': '9024.73', 'sum_total_volume': '174522', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '10020.67', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000026
此查询区间,当前编号下总共抄表记录: 1247
此查询区间,上一月最后一天内当前编号下总共抄表记录: 43
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000280'}]
0000000280
00056000000026 ☆ sum_total_money <0 置为0
00056000000026
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000260')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000280', 'rtu_no': '00050000000021', 'flmeter_no': '00056000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 55, 905449), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 42, 18, 675000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 38, 59, 322000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 42, 18, 675000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 38, 59, 322000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 21, 42, 18, 675000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 38, 59, 322000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 42, 18, 675000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 38, 59, 322000), 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '598.0', 'use_money': '962.78', 'sum_total_volume': '9695', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2642.67', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000026处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000018
此查询区间,当前编号下总共抄表记录: 2186
此查询区间,上一月最后一天内当前编号下总共抄表记录: 35
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000281'}]
0000000281
00056000000018 ☆ sum_total_money <0 置为0
00056000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000259')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000281', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 56, 186480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '155787', 'work_sum': '155787', 'max_std_flow': '91.85', 'min_std_flow': '0.0', 'avg_std_flow': '4.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 21, 5, 7, 546000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 10, 962000), 'max_work_flow': '111.39', 'min_work_flow': '0.0', 'avg_work_flow': '5.0', 'max_work_flow_time': datetime.datetime(2019, 3, 17, 21, 6, 51, 802000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 10, 962000), 'max_temperature': '22.89', 'min_temperature': '8.84', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 1, 44, 8, 109000), 'min_temp_time': datetime.datetime(2019, 3, 12, 7, 33, 0, 61000), 'max_press': '83.5', 'min_press': '83.5', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 55, 4, 930000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 0, 10, 962000), 'price': '1.55', 'use_volume_work': '6902.0', 'use_volume_std': '6902.0', 'use_money': '10698.1', 'sum_total_volume': '155787', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '25562.97', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 2206
此查询区间,上一月最后一天内当前编号下总共抄表记录: 42
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000282'}]
0000000282
00056000000021 ☆ sum_total_money <0 置为0
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000257')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000282', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 56, 461452), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '65349', 'work_sum': '70433', 'max_std_flow': '140.79', 'min_std_flow': '0.0', 'avg_std_flow': '8.0', 'max_std_flow_time': datetime.datetime(2019, 3, 18, 6, 22, 43, 36000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 49, 126000), 'max_work_flow': '151.57', 'min_work_flow': '0.0', 'avg_work_flow': '9.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 10, 8, 9, 829000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 29, 49, 126000), 'max_temperature': '36.23', 'min_temperature': '19.0', 'avg_temperature': '32.0', 'max_temp_time': datetime.datetime(2019, 3, 7, 21, 50, 9, 145000), 'min_temp_time': datetime.datetime(2019, 3, 18, 6, 22, 43, 36000), 'max_press': '101.21', 'min_press': '94.52', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 3, 14, 1, 27, 13, 68000), 'min_press_time': datetime.datetime(2019, 3, 28, 19, 26, 26, 890000), 'price': '1.46', 'use_volume_work': '10035.0', 'use_volume_std': '9289.0', 'use_money': '13561.94', 'sum_total_volume': '65349', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '7804.58', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '32.0', 'temp_out': '32.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000007
此查询区间,当前编号下总共抄表记录: 5407
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000283'}]
0000000283
00050000000007 ☆ sum_total_money <0 置为0
00050000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019030000000254')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019030000000283', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 56, 740447), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '1000', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 44, 39, 792000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 10, 44, 39, 700000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 44, 39, 792000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 10, 44, 39, 700000), 'max_temperature': '35.91', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 2, 15, 40, 46, 938000), 'min_temp_time': datetime.datetime(2019, 3, 13, 16, 28, 23, 114000), 'max_press': '101.32', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 44, 39, 792000), 'min_press_time': datetime.datetime(2019, 3, 12, 16, 5, 9, 224000), 'price': '1.58', 'use_volume_work': '0.0', 'use_volume_std': '1000.0', 'use_money': '1580.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '305.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00050000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
0005 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0007
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0007 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0009
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0009 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0011
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0011 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0012
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0012 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0016
💗 I am main()
总共抄表数据: 366
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0016 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 2
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00160000000001
此查询区间,当前编号下总共抄表记录: 273
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000009'}]
0000000009
00160000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0016', '00162019030000000008')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0016', 'srm_id': '00162019030000000009', 'rtu_no': 'FM0000000690', 'flmeter_no': '00160000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 57, 638451), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '69397063.950', 'work_sum': '16288079.880', 'max_std_flow': '4509.18', 'min_std_flow': '0.0', 'avg_std_flow': '1745.0', 'max_std_flow_time': datetime.datetime(2019, 3, 21, 12, 0, 25), 'min_std_flow_time': datetime.datetime(2019, 3, 29, 8, 0, 36), 'max_work_flow': '951.72', 'min_work_flow': '0.0', 'avg_work_flow': '372.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 12, 0, 26), 'min_work_flow_time': datetime.datetime(2019, 3, 29, 8, 0, 36), 'max_temperature': '14.226', 'min_temperature': '-2.066', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 3, 26, 16, 0, 24), 'min_temp_time': datetime.datetime(2019, 3, 22, 8, 0, 31), 'max_press': '462.211', 'min_press': '256.211', 'avg_press': '450.0', 'max_press_time': datetime.datetime(2019, 3, 23, 8, 0, 30), 'min_press_time': datetime.datetime(2019, 3, 31, 19, 0, 22), 'price': '0.000', 'use_volume_work': '104690.31000000052', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '450.0', 'press_out': '450.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00160000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
00166000000002
此查询区间,当前编号下总共抄表记录: 93
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000010'}]
0000000010
00166000000002 ☆ sum_total_volume is None 置为0
00166000000002
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0016', '00162019030000000007')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0016', 'srm_id': '00162019030000000010', 'rtu_no': '00160000000002', 'flmeter_no': '00166000000002', 'customer_no': '00160000000002', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 57, 988447), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 52, 13, 421000), 'min_std_flow_time': datetime.datetime(2019, 3, 20, 11, 14, 44, 390000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 52, 13, 421000), 'min_work_flow_time': datetime.datetime(2019, 3, 20, 11, 14, 44, 390000), 'max_temperature': '26.5', 'min_temperature': '6.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 21, 16, 37, 1, 15000), 'min_temp_time': datetime.datetime(2019, 3, 30, 1, 22, 34, 906000), 'max_press': '102.1', 'min_press': '66.7', 'avg_press': '92.0', 'max_press_time': datetime.datetime(2019, 3, 22, 9, 9, 49, 328000), 'min_press_time': datetime.datetime(2019, 3, 22, 21, 28, 37, 609000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[温度异常][压力异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[温度异常][压力异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '46', 'press_in': '92.0', 'press_out': '92.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00166000000002处理好数据已写入oracle
----------------------------------------------------------------------------------------
0016 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0019
💗 I am main()
总共抄表数据: 10
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0019 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 2
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00196000000001
此查询区间,当前编号下总共抄表记录: 8
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0019', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0019', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000009'}]
0000000009
00196000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0019', '00192019030000000008')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0019', 'srm_id': '00192019030000000009', 'rtu_no': '00190000000001', 'flmeter_no': '00196000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 58, 353451), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '52236', 'work_sum': '48238', 'max_std_flow': '61.61', 'min_std_flow': '0.0', 'avg_std_flow': '10.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 9, 41, 24, 390000), 'min_std_flow_time': datetime.datetime(2019, 3, 30, 9, 35, 25, 906000), 'max_work_flow': '61.61', 'min_work_flow': '0.0', 'avg_work_flow': '10.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 9, 41, 24, 390000), 'min_work_flow_time': datetime.datetime(2019, 3, 30, 9, 35, 25, 906000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 9, 56, 24, 937000), 'min_temp_time': datetime.datetime(2019, 3, 30, 9, 35, 25, 906000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 30, 9, 56, 24, 937000), 'min_press_time': datetime.datetime(2019, 3, 30, 9, 35, 25, 906000), 'price': '0.0', 'use_volume_work': '1.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '00000000', 'fm_state_msg': '无外电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00196000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0019', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0019', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000010'}]
0000000010
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0019', '00192019030000000007')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0019', 'srm_id': '00192019030000000010', 'rtu_no': '00190000000001', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 58, 631603), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '52235', 'work_sum': '48237', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 9, 30, 24, 640000), 'min_std_flow_time': datetime.datetime(2019, 3, 30, 9, 27, 24, 140000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 9, 30, 24, 640000), 'min_work_flow_time': datetime.datetime(2019, 3, 30, 9, 27, 24, 140000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 9, 30, 24, 640000), 'min_temp_time': datetime.datetime(2019, 3, 30, 9, 27, 24, 140000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 30, 9, 30, 24, 640000), 'min_press_time': datetime.datetime(2019, 3, 30, 9, 27, 24, 140000), 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '00000000', 'fm_state_msg': '无外电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
0019 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0003
💗 I am main()
总共抄表数据: 60029
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 538
0003 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 60
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00036000000011
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000241'}]
0000000241
00036000000011
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000204')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000241', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000011', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 1, 553464), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '69322376.950', 'work_sum': '16270391.670', 'max_std_flow': '685.94', 'min_std_flow': '685.94', 'avg_std_flow': '685.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_std_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'max_work_flow': '141.87', 'min_work_flow': '141.87', 'avg_work_flow': '141.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_work_flow_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'max_temperature': '4.89', 'min_temperature': '4.89', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_temp_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'max_press': '460.439', 'min_press': '460.439', 'avg_press': '460.0', 'max_press_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'min_press_time': datetime.datetime(2019, 3, 29, 23, 0, 22), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '460.0', 'press_out': '460.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000011处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000054
此查询区间,当前编号下总共抄表记录: 1703
此查询区间,上一月最后一天内当前编号下总共抄表记录: 3
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000242'}]
0000000242
00036000000054 ☆ sum_total_volume is None 置为0
00036000000054
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000233')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000242', 'rtu_no': '00030000000096', 'flmeter_no': '00036000000054', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 1, 859481), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '7386', 'work_sum': '7158', 'max_std_flow': '1015.03', 'min_std_flow': '0.0', 'avg_std_flow': '189.0', 'max_std_flow_time': datetime.datetime(2019, 3, 25, 12, 38, 16, 468000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 22, 47, 975000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 0, 23, 22, 200000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 22, 47, 975000), 'max_temperature': '98.4', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 21, 9, 57, 48, 406000), 'min_temp_time': datetime.datetime(2019, 3, 8, 8, 58, 34, 794000), 'max_press': '105.8', 'min_press': '0.0', 'avg_press': '91.0', 'max_press_time': datetime.datetime(2019, 3, 7, 0, 20, 57, 602000), 'min_press_time': datetime.datetime(2019, 3, 8, 8, 58, 34, 794000), 'price': '1.0', 'use_volume_work': '2920.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 245.0, 'total_buy_volume': None, 'total_buy_money': '245', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '91.0', 'press_out': '91.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '20.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000054处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000012
此查询区间,当前编号下总共抄表记录: 63
此查询区间,上一月最后一天内当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000243'}]
0000000243
00036000000012 ☆ sum_total_volume is None 置为0
00036000000012
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000196')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000243', 'rtu_no': '00030000000043', 'flmeter_no': '00036000000012', 'customer_no': '00030000000005', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 2, 194479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '6837', 'work_sum': '6828', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 22, 53, 996000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 1, 661000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 22, 53, 996000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 1, 661000), 'max_temperature': '15.5', 'min_temperature': '11.5', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 1, 20, 55, 578000), 'min_temp_time': datetime.datetime(2019, 3, 4, 1, 20, 51, 323000), 'max_press': '102.3', 'min_press': '100.2', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 21, 32, 718000), 'min_press_time': datetime.datetime(2019, 3, 6, 16, 55, 28, 200000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2999', 'remain_money': '2999', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000012处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000058
此查询区间,当前编号下总共抄表记录: 801
此查询区间,上一月最后一天内当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000244'}]
0000000244
00036000000058 ☆ sum_total_volume is None 置为0
00036000000058
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000189')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000244', 'rtu_no': '00030000000100', 'flmeter_no': '00036000000058', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 2, 487449), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 19, 28, 59, 613000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 58, 726000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 28, 59, 613000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 58, 726000), 'max_temperature': '19.9', 'min_temperature': '15.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 22, 51, 29, 749000), 'min_temp_time': datetime.datetime(2019, 3, 31, 6, 23, 38, 734000), 'max_press': '123.7', 'min_press': '100.0', 'avg_press': '108.0', 'max_press_time': datetime.datetime(2019, 3, 31, 7, 24, 6, 488000), 'min_press_time': datetime.datetime(2019, 3, 20, 10, 26, 58, 796000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '108.0', 'press_out': '108.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '22.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000058处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000051
此查询区间,当前编号下总共抄表记录: 1002
此查询区间,上一月最后一天内当前编号下总共抄表记录: 23
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000245'}]
0000000245
00036000000051 ☆ sum_total_volume is None 置为0
00036000000051
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000181')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000245', 'rtu_no': '00030000000093', 'flmeter_no': '00036000000051', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 2, 802448), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 22, 977000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 40, 772000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 22, 977000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 40, 772000), 'max_temperature': '19.8', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 19, 46, 49, 187000), 'min_temp_time': datetime.datetime(2019, 3, 2, 9, 27, 56, 971000), 'max_press': '106.6', 'min_press': '99.6', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 23, 8, 25, 25, 562000), 'min_press_time': datetime.datetime(2019, 3, 20, 14, 30, 36, 906000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '21.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000051处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000020
此查询区间,当前编号下总共抄表记录: 1164
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000246'}]
0000000246
00036000000020 ☆ sum_total_volume is None 置为0
00036000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000230')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000246', 'rtu_no': '00030000000051', 'flmeter_no': '00036000000020', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 3, 148480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '71', 'work_sum': '84', 'max_std_flow': '594.04', 'min_std_flow': '0.0', 'avg_std_flow': '1.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 14, 41, 23, 161000), 'min_std_flow_time': datetime.datetime(2019, 3, 6, 11, 47, 27, 650000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 9, 6, 57, 760000), 'min_work_flow_time': datetime.datetime(2019, 3, 6, 11, 47, 27, 650000), 'max_temperature': '26.0', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 16, 30, 28, 193000), 'min_temp_time': datetime.datetime(2019, 3, 6, 19, 15, 45, 371000), 'max_press': '103.2', 'min_press': '0.0', 'avg_press': '71.0', 'max_press_time': datetime.datetime(2019, 3, 8, 11, 23, 4, 640000), 'min_press_time': datetime.datetime(2019, 3, 6, 19, 15, 45, 371000), 'price': '256.0', 'use_volume_work': '84.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '4144', 'remain_money': '4144', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '71.0', 'press_out': '71.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '22.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000010
此查询区间,当前编号下总共抄表记录: 29
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000247'}]
0000000247
00036000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000195')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000247', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 3, 468474), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '69368791.950', 'work_sum': '16280059.520', 'max_std_flow': '3734.73', 'min_std_flow': '456.63', 'avg_std_flow': '2233.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 8, 0, 33), 'min_std_flow_time': datetime.datetime(2019, 3, 30, 8, 0, 30), 'max_work_flow': '774.38', 'min_work_flow': '94.58', 'avg_work_flow': '460.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 8, 0, 33), 'min_work_flow_time': datetime.datetime(2019, 3, 30, 8, 0, 31), 'max_temperature': '13.179', 'min_temperature': '-1.984', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 15, 0, 24), 'min_temp_time': datetime.datetime(2019, 3, 24, 8, 0, 51), 'max_press': '460.827', 'min_press': '450.109', 'avg_press': '455.0', 'max_press_time': datetime.datetime(2019, 3, 23, 23, 0, 23), 'min_press_time': datetime.datetime(2019, 3, 25, 8, 0, 30), 'price': '0.000', 'use_volume_work': '67861.69999999925', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '455.0', 'press_out': '455.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000048
此查询区间,当前编号下总共抄表记录: 640
此查询区间,上一月最后一天内当前编号下总共抄表记录: 21
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000248'}]
0000000248
00036000000048 ☆ sum_total_volume is None 置为0
00036000000048 ☆ sum_total_money <0 置为0
00036000000048
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000187')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000248', 'rtu_no': '00030000000090', 'flmeter_no': '00036000000048', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 3, 790478), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 17, 30, 42, 157000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 30, 85000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 17, 30, 42, 157000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 30, 85000), 'max_temperature': '19.8', 'min_temperature': '15.1', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 17, 33, 11, 687000), 'min_temp_time': datetime.datetime(2019, 3, 31, 7, 25, 59, 134000), 'max_press': '102.6', 'min_press': '98.4', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 7, 9, 24, 1, 838000), 'min_press_time': datetime.datetime(2019, 3, 20, 11, 27, 2, 109000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '19.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000048处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000057
此查询区间,当前编号下总共抄表记录: 7
此查询区间,上一月最后一天内当前编号下总共抄表记录: 21
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000249'}]
0000000249
00036000000057 ☆ sum_total_volume is None 置为0
00036000000057
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000227')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000249', 'rtu_no': '00030000000099', 'flmeter_no': '00036000000057', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 4, 98480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 7, 9, 21, 552000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 51, 476000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 1, 7, 9, 21, 552000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 51, 476000), 'max_temperature': '22.2', 'min_temperature': '21.5', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 3, 1, 1, 8, 7, 299000), 'min_temp_time': datetime.datetime(2019, 3, 1, 7, 9, 21, 552000), 'max_press': '102.1', 'min_press': '101.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 1, 10, 9, 57, 340000), 'min_press_time': datetime.datetime(2019, 3, 1, 4, 8, 58, 492000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000057处理好数据已写入oracle
----------------------------------------------------------------------------------------
0800007983
此查询区间,当前编号下总共抄表记录: 54
此查询区间,上一月最后一天内当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000250'}]
0000000250
0800007983 ☆ sum_total_volume is None 置为0
0800007983
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000185')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000250', 'rtu_no': '00030000000114', 'flmeter_no': '0800007983', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 4, 394480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 25, 1, 21, 4, 343000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 270000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 25, 1, 21, 4, 343000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 270000), 'max_temperature': '15.8', 'min_temperature': '10.8', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 3, 21, 1, 20, 39, 999000), 'min_temp_time': datetime.datetime(2019, 3, 4, 1, 20, 47, 10000), 'max_press': '102.1', 'min_press': '100.4', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 21, 16, 499000), 'min_press_time': datetime.datetime(2019, 3, 21, 1, 21, 2, 468000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
0800007983处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000022
此查询区间,当前编号下总共抄表记录: 272
此查询区间,上一月最后一天内当前编号下总共抄表记录: 12
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000251'}]
0000000251
00036000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000192')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000251', 'rtu_no': None, 'flmeter_no': '00036000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 4, 761479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '1559304.890', 'work_sum': '442929.400', 'max_std_flow': '153.93', 'min_std_flow': '0.0', 'avg_std_flow': '76.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 10, 0, 21), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 23), 'max_work_flow': '36.47', 'min_work_flow': '0.0', 'avg_work_flow': '18.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 10, 0, 21), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 23), 'max_temperature': '20.421', 'min_temperature': '5.987', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 15, 14, 0, 24), 'min_temp_time': datetime.datetime(2019, 3, 1, 8, 0, 24), 'max_press': '443.732', 'min_press': '101.033', 'avg_press': '387.0', 'max_press_time': datetime.datetime(2019, 3, 27, 4, 0, 22), 'min_press_time': datetime.datetime(2019, 3, 2, 0, 0, 22), 'price': '0.000', 'use_volume_work': '11494.300000000047', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '387.0', 'press_out': '387.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000070
此查询区间,当前编号下总共抄表记录: 290
此查询区间,上一月最后一天内当前编号下总共抄表记录: 10
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000252'}]
0000000252
00036000000070 ☆ use_volume_work <0 置为0
00036000000070 ☆ sum_total_volume is None 置为0
00036000000070
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000197')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000252', 'rtu_no': '00030000000112', 'flmeter_no': '00036000000070', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 5, 90450), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 9, 936000), 'min_std_flow_time': datetime.datetime(2019, 2, 28, 23, 59, 37, 211000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 9, 936000), 'min_work_flow_time': datetime.datetime(2019, 2, 28, 23, 59, 37, 211000), 'max_temperature': '22.9', 'min_temperature': '0.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 6, 14, 9, 22, 920000), 'min_temp_time': datetime.datetime(2019, 3, 6, 9, 56, 31, 469000), 'max_press': '102.4', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 22, 45, 749000), 'min_press_time': datetime.datetime(2019, 3, 6, 9, 56, 31, 469000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000070处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000045
此查询区间,当前编号下总共抄表记录: 43
此查询区间,上一月最后一天内当前编号下总共抄表记录: 3
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000253'}]
0000000253
00036000000045 ☆ use_volume_work <0 置为0
00036000000045 ☆ sum_total_volume is None 置为0
00036000000045
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000209')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000253', 'rtu_no': '00030000000086', 'flmeter_no': '00036000000045', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 5, 368479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 10, 15, 44, 264000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 10, 15, 58, 838000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 10, 15, 44, 264000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 10, 15, 58, 838000), 'max_temperature': '18.6', 'min_temperature': '18.6', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 31, 10, 15, 44, 264000), 'min_temp_time': datetime.datetime(2019, 3, 1, 10, 15, 58, 838000), 'max_press': '102.2', 'min_press': '102.2', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 31, 10, 15, 44, 264000), 'min_press_time': datetime.datetime(2019, 3, 1, 10, 15, 58, 838000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '37', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000045处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000069
此查询区间,当前编号下总共抄表记录: 328
此查询区间,上一月最后一天内当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000254'}]
0000000254
00036000000069 ☆ sum_total_volume is None 置为0
00036000000069
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000222')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000254', 'rtu_no': '00030000000111', 'flmeter_no': '00036000000069', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 5, 720480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '10', 'work_sum': '10', 'max_std_flow': '0.33', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 14, 23, 1, 421000), 'min_std_flow_time': datetime.datetime(2019, 1, 10, 18, 14, 34, 996000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 14, 51, 38, 484000), 'min_work_flow_time': datetime.datetime(2019, 1, 10, 18, 14, 34, 996000), 'max_temperature': '21.4', 'min_temperature': '0.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 18, 16, 1, 36, 864000), 'min_temp_time': datetime.datetime(2019, 3, 1, 0, 21, 14, 398000), 'max_press': '102.4', 'min_press': '0.0', 'avg_press': '65.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 21, 4, 484000), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 21, 14, 398000), 'price': '1.0', 'use_volume_work': '10.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 11.0, 'total_buy_volume': None, 'total_buy_money': '13', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '65.0', 'press_out': '65.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '12.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000069处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000007
此查询区间,当前编号下总共抄表记录: 464
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000255'}]
0000000255
00036000000007 ☆ sum_total_money <0 置为0
00036000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000225')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000255', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 6, 2480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '64', 'work_sum': '66', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 37, 896000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 41, 487000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 37, 896000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 41, 487000), 'max_temperature': '26.96', 'min_temperature': '26.96', 'avg_temperature': '26.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 13, 59, 37, 896000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 25, 41, 487000), 'max_press': '100.15', 'min_press': '100.15', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 14, 13, 59, 37, 896000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 25, 41, 487000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '46.0', 'use_money': '46.0', 'sum_total_volume': '60544', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '39520.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '26.0', 'temp_out': '26.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000038
此查询区间,当前编号下总共抄表记录: 680
此查询区间,上一月最后一天内当前编号下总共抄表记录: 3
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000256'}]
0000000256
00036000000038 ☆ sum_total_volume is None 置为0
00036000000038
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000200')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000256', 'rtu_no': '00030000000079', 'flmeter_no': '00036000000038', 'customer_no': '00030000000016', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 6, 336488), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 35, 48, 574000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 24, 32, 973000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 35, 48, 574000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 24, 32, 973000), 'max_temperature': '15.4', 'min_temperature': '8.2', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 27, 19, 46, 4, 203000), 'min_temp_time': datetime.datetime(2019, 3, 1, 12, 27, 46, 704000), 'max_press': '103.3', 'min_press': '99.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 23, 9, 26, 41, 984000), 'min_press_time': datetime.datetime(2019, 3, 20, 15, 39, 47, 281000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000038处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000039
此查询区间,当前编号下总共抄表记录: 108
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000257'}]
0000000257
00036000000039 ☆ sum_total_volume is None 置为0
00036000000039
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000202')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000257', 'rtu_no': '00030000000080', 'flmeter_no': '00036000000039', 'customer_no': '00030000000029', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 6, 672483), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 14, 30, 27, 93000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 52, 7, 159000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 14, 30, 27, 93000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 52, 7, 159000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 14, 30, 27, 93000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 52, 7, 159000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 28, 14, 30, 27, 93000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 52, 7, 159000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '12943', 'remain_money': '12943', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000039处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000050
此查询区间,当前编号下总共抄表记录: 25
此查询区间,上一月最后一天内当前编号下总共抄表记录: 6
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000258'}]
0000000258
00036000000050 ☆ sum_total_volume is None 置为0
00036000000050
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000219')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000258', 'rtu_no': '00030000000092', 'flmeter_no': '00036000000050', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 7, 73448), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 22, 0, 58, 57, 796000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 1, 54, 663000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 22, 0, 58, 57, 796000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 1, 54, 663000), 'max_temperature': '20.5', 'min_temperature': '10.9', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 22, 0, 58, 57, 796000), 'min_temp_time': datetime.datetime(2019, 3, 1, 5, 2, 36, 936000), 'max_press': '102.2', 'min_press': '101.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 1, 9, 5, 46, 571000), 'min_press_time': datetime.datetime(2019, 3, 2, 0, 57, 18, 844000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[余额不足关阀][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[余额不足关阀][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '50', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000050处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000065
此查询区间,当前编号下总共抄表记录: 756
此查询区间,上一月最后一天内当前编号下总共抄表记录: 18
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000259'}]
0000000259
00036000000065 ☆ sum_total_volume is None 置为0
00036000000065
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000220')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000259', 'rtu_no': '00030000000107', 'flmeter_no': '00036000000065', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 7, 421485), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 19, 28, 15, 34000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 31, 52000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 28, 15, 34000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 31, 52000), 'max_temperature': '20.6', 'min_temperature': '10.9', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 4, 16, 33, 31, 778000), 'min_temp_time': datetime.datetime(2019, 3, 5, 6, 23, 13, 98000), 'max_press': '105.4', 'min_press': '100.1', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 1, 18, 25, 47, 229000), 'min_press_time': datetime.datetime(2019, 3, 20, 14, 27, 21, 937000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000065处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000067
此查询区间,当前编号下总共抄表记录: 482
此查询区间,上一月最后一天内当前编号下总共抄表记录: 32
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000260'}]
0000000260
00036000000067 ☆ sum_total_volume is None 置为0
00036000000067
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000183')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000260', 'rtu_no': '00030000000109', 'flmeter_no': '00036000000067', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 7, 722452), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 17, 0, 8, 584000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 10, 49, 109000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 17, 0, 8, 584000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 10, 49, 109000), 'max_temperature': '22.7', 'min_temperature': '12.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 5, 17, 34, 13, 251000), 'min_temp_time': datetime.datetime(2019, 3, 4, 8, 26, 48, 38000), 'max_press': '105.8', 'min_press': '100.4', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 11, 14, 59, 35, 156000), 'min_press_time': datetime.datetime(2019, 3, 21, 1, 22, 17, 234000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000067处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000018
此查询区间,当前编号下总共抄表记录: 660
此查询区间,上一月最后一天内当前编号下总共抄表记录: 3
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000261'}]
0000000261
00036000000018 ☆ use_volume_work <0 置为0
00036000000018 ☆ sum_total_volume is None 置为0
00036000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000206')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000261', 'rtu_no': '00030000000049', 'flmeter_no': '00036000000018', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 8, 38448), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '98', 'work_sum': '98', 'max_std_flow': '1001.02', 'min_std_flow': '0.0', 'avg_std_flow': '51.0', 'max_std_flow_time': datetime.datetime(2019, 3, 19, 16, 30, 56, 562000), 'min_std_flow_time': datetime.datetime(2019, 3, 6, 11, 41, 22, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 2, 22, 12, 378000), 'min_work_flow_time': datetime.datetime(2019, 3, 6, 11, 41, 22, 840000), 'max_temperature': '2491.0', 'min_temperature': '0.0', 'avg_temperature': '23.0', 'max_temp_time': datetime.datetime(2019, 3, 26, 8, 54, 31, 953000), 'min_temp_time': datetime.datetime(2019, 3, 6, 15, 30, 49, 666000), 'max_press': '103.0', 'min_press': '0.0', 'avg_press': '85.0', 'max_press_time': datetime.datetime(2019, 3, 7, 20, 15, 39, 19000), 'min_press_time': datetime.datetime(2019, 3, 6, 15, 30, 49, 666000), 'price': '0.01', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '14', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[预留][电量不足关阀][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[预留][电量不足关阀][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '65', 'press_in': '85.0', 'press_out': '85.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '22.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000061
此查询区间,当前编号下总共抄表记录: 765
此查询区间,上一月最后一天内当前编号下总共抄表记录: 26
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000262'}]
0000000262
00036000000061 ☆ sum_total_volume is None 置为0
00036000000061
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000223')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000262', 'rtu_no': '00030000000103', 'flmeter_no': '00036000000061', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 8, 372481), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 47, 106000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 39, 364000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 47, 106000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 39, 364000), 'max_temperature': '15.5', 'min_temperature': '10.7', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 16, 28, 36, 100000), 'min_temp_time': datetime.datetime(2019, 3, 4, 7, 23, 52, 570000), 'max_press': '105.9', 'min_press': '99.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 1, 10, 24, 55, 915000), 'min_press_time': datetime.datetime(2019, 3, 20, 15, 26, 47, 281000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000061处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000003
此查询区间,当前编号下总共抄表记录: 6099
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000263'}]
0000000263
00036000000003 ☆ sum_total_money <0 置为0
00036000000003
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000193')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000263', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000003', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 8, 710479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '80', 'work_sum': '83', 'max_std_flow': '1671.35', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 11, 18, 8, 45, 882000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 26, 362000), 'max_work_flow': '1689.07', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 11, 18, 8, 45, 882000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 26, 362000), 'max_temperature': '25.56', 'min_temperature': '0.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 12, 13, 32, 54, 116000), 'min_temp_time': datetime.datetime(2019, 3, 12, 14, 14, 53, 979000), 'max_press': '101.8', 'min_press': '0.0', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 23, 21, 52, 3, 671000), 'min_press_time': datetime.datetime(2019, 3, 12, 14, 14, 53, 979000), 'price': '2.39', 'use_volume_work': '8.0', 'use_volume_std': '7.0', 'use_money': '16.73', 'sum_total_volume': '80', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1426.0', 'remain_volume': '0.0', 'fm_state': '10000111', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,低电,阀关,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': '阀关', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000003处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000102
此查询区间,当前编号下总共抄表记录: 285
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000264'}]
0000000264
00036000000102 ☆ sum_total_volume is None 置为0
00036000000102
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000217')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000264', 'rtu_no': '00030000000142', 'flmeter_no': '00036000000102', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 9, 27482), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '16777475', 'work_sum': '65796', 'max_std_flow': '521.09', 'min_std_flow': '0.0', 'avg_std_flow': '493.0', 'max_std_flow_time': datetime.datetime(2019, 4, 1, 21, 22, 39, 842000), 'min_std_flow_time': datetime.datetime(2019, 3, 27, 17, 6, 40, 542000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 1, 21, 22, 35, 592000), 'min_work_flow_time': datetime.datetime(2019, 3, 27, 17, 6, 40, 542000), 'max_temperature': '8.0', 'min_temperature': '-9.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 4, 1, 21, 22, 39, 810000), 'min_temp_time': datetime.datetime(2019, 4, 1, 21, 22, 39, 842000), 'max_press': '111.3', 'min_press': '0.0', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 4, 1, 21, 22, 39, 842000), 'min_press_time': datetime.datetime(2019, 3, 27, 17, 6, 40, 542000), 'price': '0', 'use_volume_work': '3.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[IC卡密码与燃气表密码不一致][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[IC卡密码与燃气表密码不一致][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '29.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000102处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000077
此查询区间,当前编号下总共抄表记录: 4798
此查询区间,上一月最后一天内当前编号下总共抄表记录: 21
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000265'}]
0000000265
00036000000077 ☆ sum_total_money <0 置为0
00036000000077
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000190')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000265', 'rtu_no': '00030000000118', 'flmeter_no': '00036000000077', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 9, 347450), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '9', 'work_sum': '4', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 16, 25, 7, 640000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 15, 677000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 16, 25, 7, 640000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 15, 677000), 'max_temperature': '26.3', 'min_temperature': '10.9', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 12, 16, 28, 42, 130000), 'min_temp_time': datetime.datetime(2019, 3, 5, 6, 5, 58, 659000), 'max_press': '111.2', 'min_press': '100.9', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 12, 16, 28, 42, 130000), 'min_press_time': datetime.datetime(2019, 3, 11, 15, 34, 51, 45000), 'price': '2.39', 'use_volume_work': '4.0', 'use_volume_std': '9.0', 'use_money': '21.51', 'sum_total_volume': '9', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2526.2', 'remain_volume': '0.0', 'fm_state': '10000111', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,低电,阀关,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': '阀关', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '1.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000077处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000063
此查询区间,当前编号下总共抄表记录: 460
此查询区间,上一月最后一天内当前编号下总共抄表记录: 1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000266'}]
0000000266
00036000000063 ☆ sum_total_volume is None 置为0
00036000000063
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000236')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000266', 'rtu_no': '00030000000105', 'flmeter_no': '00036000000063', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 9, 713480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.02', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 9, 10, 9, 387000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 59, 726000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 4, 13, 45000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 59, 726000), 'max_temperature': '16.3', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 3, 7, 15, 55, 23, 879000), 'min_temp_time': datetime.datetime(2019, 3, 2, 3, 41, 57, 646000), 'max_press': '102.3', 'min_press': '0.0', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 31, 22, 4, 45, 685000), 'min_press_time': datetime.datetime(2019, 3, 2, 3, 41, 57, 646000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '3.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000063处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000021
此查询区间,当前编号下总共抄表记录: 274
此查询区间,上一月最后一天内当前编号下总共抄表记录: 1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000267'}]
0000000267
00036000000021 ☆ sum_total_volume is None 置为0
00036000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000186')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000267', 'rtu_no': '00030000000055', 'flmeter_no': '00036000000021', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 10, 34480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 10, 6, 56, 93000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 56, 648000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 10, 6, 56, 93000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 56, 648000), 'max_temperature': '13.4', 'min_temperature': '0.0', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 3, 12, 14, 13, 12, 670000), 'min_temp_time': datetime.datetime(2019, 3, 27, 14, 12, 0, 258000), 'max_press': '103.2', 'min_press': '0.0', 'avg_press': '89.0', 'max_press_time': datetime.datetime(2019, 3, 7, 10, 49, 38, 795000), 'min_press_time': datetime.datetime(2019, 3, 27, 14, 12, 0, 258000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '26351', 'remain_money': '26351', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '89.0', 'press_out': '89.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000013
此查询区间,当前编号下总共抄表记录: 5268
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000268'}]
0000000268
00036000000013 ☆ use_volume_work <0 置为0
00036000000013 ☆ use_volume_std <0 置为0
00036000000013 ☆ sum_total_money <0 置为0
00036000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000182')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000268', 'rtu_no': '00030000000018', 'flmeter_no': '00036000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 10, 333451), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '2073', 'work_sum': '173', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 6, 187000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 1, 206000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 6, 187000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 1, 206000), 'max_temperature': '22.0', 'min_temperature': '20.0', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 17, 55, 6, 187000), 'min_temp_time': datetime.datetime(2019, 3, 4, 9, 52, 26, 613000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 29, 17, 55, 6, 187000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 25, 1, 206000), 'price': '2.39', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '2073', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1949.4', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000044
此查询区间,当前编号下总共抄表记录: 703
此查询区间,上一月最后一天内当前编号下总共抄表记录: 31
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000269'}]
0000000269
00036000000044 ☆ sum_total_volume is None 置为0
00036000000044
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000238')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000269', 'rtu_no': '00030000000085', 'flmeter_no': '00036000000044', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 10, 727450), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 19, 31, 22, 931000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 50, 211000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 31, 22, 931000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 50, 211000), 'max_temperature': '20.2', 'min_temperature': '8.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 12, 13, 1, 58, 876000), 'min_temp_time': datetime.datetime(2019, 3, 1, 11, 29, 9, 956000), 'max_press': '127.9', 'min_press': '100.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 1, 17, 31, 44, 928000), 'min_press_time': datetime.datetime(2019, 3, 20, 14, 31, 16, 609000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000044处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000009
此查询区间,当前编号下总共抄表记录: 551
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000270'}]
0000000270
00036000000009 ☆ sum_total_money <0 置为0
00036000000009
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000216')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000270', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000009', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 11, 36487), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 40, 239000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 43, 706000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 40, 239000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 43, 706000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 13, 59, 40, 239000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 25, 43, 706000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 14, 13, 59, 40, 239000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 25, 43, 706000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '41.0', 'use_money': '41.0', 'sum_total_volume': '19715', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '80335.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000009处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000055
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一月最后一天内当前编号下总共抄表记录: 24
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000271'}]
0000000271
00036000000055 ☆ sum_total_volume is None 置为0
00036000000055
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000239')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000271', 'rtu_no': '00030000000097', 'flmeter_no': '00036000000055', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 11, 375448), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 5, 24, 38, 724000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 23, 5, 177000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 1, 5, 24, 38, 724000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 23, 5, 177000), 'max_temperature': '13.3', 'min_temperature': '10.9', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 1, 9, 26, 17, 91000), 'min_temp_time': datetime.datetime(2019, 3, 1, 6, 25, 6, 826000), 'max_press': '102.0', 'min_press': '98.9', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 1, 8, 25, 52, 241000), 'min_press_time': datetime.datetime(2019, 3, 1, 5, 24, 38, 724000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 8.0, 'total_buy_volume': None, 'total_buy_money': '16', 'remain_money': '8', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000055处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000014
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000272'}]
0000000272
00036000000014 ☆ sum_total_volume is None 置为0
00036000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000224')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000272', 'rtu_no': '00030000000045', 'flmeter_no': '00036000000014', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 11, 658480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '155', 'work_sum': '155', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 6, 11, 24, 2, 987000), 'min_std_flow_time': datetime.datetime(2019, 3, 6, 11, 22, 16, 613000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 6, 11, 24, 2, 987000), 'min_work_flow_time': datetime.datetime(2019, 3, 6, 11, 22, 16, 613000), 'max_temperature': '23.2', 'min_temperature': '0.0', 'avg_temperature': '9.0', 'max_temp_time': datetime.datetime(2019, 3, 6, 11, 33, 52, 296000), 'min_temp_time': datetime.datetime(2019, 3, 6, 11, 22, 16, 613000), 'max_press': '101.3', 'min_press': '0.0', 'avg_press': '42.0', 'max_press_time': datetime.datetime(2019, 3, 6, 11, 33, 52, 296000), 'min_press_time': datetime.datetime(2019, 3, 6, 11, 22, 16, 613000), 'price': '665.6', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1280.0, 'total_buy_volume': None, 'total_buy_money': '1280', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '50', 'press_in': '42.0', 'press_out': '42.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000081
此查询区间,当前编号下总共抄表记录: 131
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000273'}]
0000000273
00036000000081 ☆ sum_total_volume is None 置为0
00036000000081
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000231')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000273', 'rtu_no': '00030000000121', 'flmeter_no': '00036000000081', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 11, 928455), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '16777489', 'work_sum': '65810', 'max_std_flow': '529.17', 'min_std_flow': '0.0', 'avg_std_flow': '452.0', 'max_std_flow_time': datetime.datetime(2019, 4, 1, 16, 55, 42, 342000), 'min_std_flow_time': datetime.datetime(2019, 3, 25, 11, 42, 50, 984000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 4, 1, 10, 11, 25, 978000), 'min_work_flow_time': datetime.datetime(2019, 3, 25, 11, 42, 50, 984000), 'max_temperature': '16.1', 'min_temperature': '-17.1', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 4, 1, 16, 55, 42, 310000), 'min_temp_time': datetime.datetime(2019, 4, 1, 16, 55, 42, 342000), 'max_press': '121.3', 'min_press': '0.0', 'avg_press': '91.0', 'max_press_time': datetime.datetime(2019, 4, 1, 16, 55, 42, 342000), 'min_press_time': datetime.datetime(2019, 3, 25, 11, 42, 50, 984000), 'price': '0', 'use_volume_work': '65810.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[IC卡密码与燃气表密码不一致][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[IC卡密码与燃气表密码不一致][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '91.0', 'press_out': '91.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '36.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000081处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000060
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一月最后一天内当前编号下总共抄表记录: 9
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000274'}]
0000000274
00036000000060 ☆ sum_total_volume is None 置为0
00036000000060
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000203')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000274', 'rtu_no': '00030000000102', 'flmeter_no': '00036000000060', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 12, 216480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 5, 22, 51, 115000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 27, 33, 377000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 1, 5, 22, 51, 115000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 27, 33, 377000), 'max_temperature': '11.6', 'min_temperature': '11.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 1, 9, 3, 42, 241000), 'min_temp_time': datetime.datetime(2019, 3, 1, 6, 23, 12, 935000), 'max_press': '102.1', 'min_press': '101.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 1, 8, 24, 2, 834000), 'min_press_time': datetime.datetime(2019, 3, 1, 6, 23, 12, 935000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000060处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000072
此查询区间,当前编号下总共抄表记录: 184
此查询区间,上一月最后一天内当前编号下总共抄表记录: 21
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000275'}]
0000000275
00036000000072 ☆ sum_total_volume is None 置为0
00036000000072
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000234')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000275', 'rtu_no': '00030000000115', 'flmeter_no': '00036000000072', 'customer_no': '00030000000002', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 12, 544483), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 14, 787000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 2, 22, 369000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 14, 787000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 2, 22, 369000), 'max_temperature': '16.2', 'min_temperature': '10.7', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 1, 21, 5, 156000), 'min_temp_time': datetime.datetime(2019, 3, 4, 9, 3, 11, 656000), 'max_press': '102.3', 'min_press': '90.8', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 24, 1, 21, 11, 31000), 'min_press_time': datetime.datetime(2019, 3, 5, 17, 9, 15, 94000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '12.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000072处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000024
此查询区间,当前编号下总共抄表记录: 277
此查询区间,上一月最后一天内当前编号下总共抄表记录: 12
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000276'}]
0000000276
00036000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000198')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000276', 'rtu_no': None, 'flmeter_no': '00036000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 12, 879480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '2579974.290', 'work_sum': '695543.720', 'max_std_flow': '142.31', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 2, 0, 23), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 23), 'max_work_flow': '32.28', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 2, 0, 23), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 23), 'max_temperature': '24.98', 'min_temperature': '3.336', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 27, 16, 0, 23), 'min_temp_time': datetime.datetime(2019, 3, 4, 8, 0, 27), 'max_press': '436.908', 'min_press': '100.653', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 3, 31, 2, 0, 23), 'min_press_time': datetime.datetime(2019, 3, 31, 6, 0, 26), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000088
此查询区间,当前编号下总共抄表记录: 134
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000277'}]
0000000277
00036000000088 ☆ sum_total_volume is None 置为0
00036000000088
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000210')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000277', 'rtu_no': '00030000000128', 'flmeter_no': '00036000000088', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 13, 177448), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 21, 38, 37, 690000), 'min_std_flow_time': datetime.datetime(2019, 3, 26, 13, 38, 40, 218000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 21, 38, 37, 690000), 'min_work_flow_time': datetime.datetime(2019, 3, 26, 13, 38, 40, 218000), 'max_temperature': '19.3', 'min_temperature': '15.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 11, 38, 38, 953000), 'min_temp_time': datetime.datetime(2019, 3, 27, 5, 38, 38, 203000), 'max_press': '102.3', 'min_press': '100.6', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 31, 21, 38, 37, 690000), 'min_press_time': datetime.datetime(2019, 3, 27, 16, 38, 40, 864000), 'price': '0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '31.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000088处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000062
此查询区间,当前编号下总共抄表记录: 551
此查询区间,上一月最后一天内当前编号下总共抄表记录: 27
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000278'}]
0000000278
00036000000062 ☆ sum_total_volume is None 置为0
00036000000062
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000213')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000278', 'rtu_no': '00030000000104', 'flmeter_no': '00036000000062', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 13, 505450), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 13, 742000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 53, 210000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 13, 742000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 53, 210000), 'max_temperature': '19.9', 'min_temperature': '15.3', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 20, 35, 17, 578000), 'min_temp_time': datetime.datetime(2019, 3, 31, 1, 21, 13, 742000), 'max_press': '103.1', 'min_press': '99.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 7, 10, 24, 52, 766000), 'min_press_time': datetime.datetime(2019, 3, 11, 12, 29, 14, 536000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 899.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '99', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '24.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000062处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000101
此查询区间,当前编号下总共抄表记录: 130
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000279'}]
0000000279
00036000000101 ☆ sum_total_volume is None 置为0
00036000000101
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000201')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000279', 'rtu_no': '00030000000141', 'flmeter_no': '00036000000101', 'customer_no': '00030000000068', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 13, 822480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 9, 32, 56, 874000), 'min_std_flow_time': datetime.datetime(2019, 3, 27, 16, 46, 58, 195000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 28, 9, 32, 56, 874000), 'min_work_flow_time': datetime.datetime(2019, 3, 27, 16, 46, 58, 195000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 28, 9, 32, 56, 874000), 'min_temp_time': datetime.datetime(2019, 3, 27, 16, 46, 58, 195000), 'max_press': '101.3', 'min_press': '101.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 28, 9, 32, 56, 874000), 'min_press_time': datetime.datetime(2019, 3, 27, 16, 46, 58, 195000), 'price': '0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '01', 'battery_voltage': None, 'battery_level': '0', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000101处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000075
此查询区间,当前编号下总共抄表记录: 4827
此查询区间,上一月最后一天内当前编号下总共抄表记录: 1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000280'}]
0000000280
00036000000075 ☆ sum_total_money <0 置为0
00036000000075
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000208')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000280', 'rtu_no': '00030000000117', 'flmeter_no': '00036000000075', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 14, 129448), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 7, 562000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 223000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 7, 562000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 223000), 'max_temperature': '25.1', 'min_temperature': '10.7', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 11, 16, 51, 14, 704000), 'min_temp_time': datetime.datetime(2019, 3, 4, 1, 20, 52, 339000), 'max_press': '127.9', 'min_press': '101.2', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 5, 23, 26, 31, 274000), 'min_press_time': datetime.datetime(2019, 3, 10, 1, 20, 57, 662000), 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2608.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000075处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000064
此查询区间,当前编号下总共抄表记录: 671
此查询区间,上一月最后一天内当前编号下总共抄表记录: 18
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000281'}]
0000000281
00036000000064 ☆ sum_total_volume is None 置为0
00036000000064
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000240')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000281', 'rtu_no': '00030000000106', 'flmeter_no': '00036000000064', 'customer_no': '00030000000046', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 14, 473480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.74', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 1, 22, 26, 54, 317000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 130000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 17, 8, 13, 890000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 13, 130000), 'max_temperature': '22.2', 'min_temperature': '-4.8', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 5, 9, 24, 11, 635000), 'min_temp_time': datetime.datetime(2019, 3, 4, 16, 33, 25, 278000), 'max_press': '109.2', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 23, 12, 18, 34, 156000), 'min_press_time': datetime.datetime(2019, 3, 5, 11, 34, 53, 276000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000064处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000008
此查询区间,当前编号下总共抄表记录: 551
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000282'}]
0000000282
00036000000008 ☆ sum_total_money <0 置为0
00036000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000228')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000282', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 14, 812479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 38, 786000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 42, 502000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 14, 13, 59, 38, 786000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 25, 42, 502000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 3, 14, 13, 59, 38, 786000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 25, 42, 502000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 3, 14, 13, 59, 38, 786000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 25, 42, 502000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '35.0', 'use_money': '35.0', 'sum_total_volume': '48420', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '51651.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000047
此查询区间,当前编号下总共抄表记录: 392
此查询区间,上一月最后一天内当前编号下总共抄表记录: 9
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000283'}]
0000000283
00036000000047 ☆ sum_total_volume is None 置为0
00036000000047
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000191')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000283', 'rtu_no': '00030000000089', 'flmeter_no': '00036000000047', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 15, 195479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '12', 'work_sum': '12', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 20, 54, 18, 606000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 52, 13, 49000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 54, 18, 606000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 52, 13, 49000), 'max_temperature': '24.7', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 3, 22, 16, 10, 4, 968000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 52, 13, 49000), 'max_press': '102.2', 'min_press': '0.0', 'avg_press': '88.0', 'max_press_time': datetime.datetime(2019, 3, 23, 12, 16, 38, 15000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 52, 13, 49000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 21.0, 'total_buy_volume': None, 'total_buy_money': '119', 'remain_money': '98', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '32', 'press_in': '88.0', 'press_out': '88.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000047处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000066
此查询区间,当前编号下总共抄表记录: 269
此查询区间,上一月最后一天内当前编号下总共抄表记录: 7
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000284'}]
0000000284
00036000000066 ☆ use_volume_work <0 置为0
00036000000066 ☆ sum_total_volume is None 置为0
00036000000066
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000221')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000284', 'rtu_no': '00030000000108', 'flmeter_no': '00036000000066', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 15, 551480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '41', 'work_sum': '39', 'max_std_flow': '4.3', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 23, 16, 7, 34, 749000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 14, 25, 26, 233000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 8, 6, 14, 141000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 9, 24, 40, 180000), 'max_temperature': '32.1', 'min_temperature': '4.6', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 3, 15, 12, 24, 53, 911000), 'min_temp_time': datetime.datetime(2019, 3, 7, 23, 28, 57, 458000), 'max_press': '108.4', 'min_press': '92.1', 'avg_press': '105.0', 'max_press_time': datetime.datetime(2019, 3, 8, 8, 23, 17, 656000), 'min_press_time': datetime.datetime(2019, 3, 20, 14, 4, 3, 718000), 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '18.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000066处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000053
此查询区间,当前编号下总共抄表记录: 1133
此查询区间,上一月最后一天内当前编号下总共抄表记录: 14
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000285'}]
0000000285
00036000000053 ☆ sum_total_volume is None 置为0
00036000000053
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000235')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000285', 'rtu_no': '00030000000095', 'flmeter_no': '00036000000053', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 15, 889481), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '23.28', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 16, 44, 19, 999000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 8, 757000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 20, 29, 43, 684000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 8, 757000), 'max_temperature': '20.7', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 13, 1, 40, 328000), 'min_temp_time': datetime.datetime(2019, 3, 25, 4, 27, 33, 390000), 'max_press': '102.7', 'min_press': '0.0', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 3, 23, 10, 27, 27, 874000), 'min_press_time': datetime.datetime(2019, 3, 30, 13, 6, 58, 273000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '53', 'remain_money': '53', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '21.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000053处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000052
此查询区间,当前编号下总共抄表记录: 665
此查询区间,上一月最后一天内当前编号下总共抄表记录: 20
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000286'}]
0000000286
00036000000052 ☆ sum_total_volume is None 置为0
00036000000052
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000214')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000286', 'rtu_no': '00030000000094', 'flmeter_no': '00036000000052', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 16, 260447), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '6518', 'work_sum': '6320', 'max_std_flow': '19.2', 'min_std_flow': '0.0', 'avg_std_flow': '3.0', 'max_std_flow_time': datetime.datetime(2019, 3, 16, 10, 25, 14, 646000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 44, 633000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 19, 35, 2, 796000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 20, 44, 633000), 'max_temperature': '30.8', 'min_temperature': '15.4', 'avg_temperature': '22.0', 'max_temp_time': datetime.datetime(2019, 3, 19, 17, 28, 39, 109000), 'min_temp_time': datetime.datetime(2019, 3, 22, 6, 22, 56, 312000), 'max_press': '105.7', 'min_press': '95.3', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 3, 7, 1, 21, 50, 793000), 'min_press_time': datetime.datetime(2019, 3, 29, 16, 29, 14, 984000), 'price': '1.0', 'use_volume_work': '2573.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '2.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000052处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000028
此查询区间,当前编号下总共抄表记录: 273
此查询区间,上一月最后一天内当前编号下总共抄表记录: 12
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000287'}]
0000000287
00036000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000215')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000287', 'rtu_no': None, 'flmeter_no': '00036000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 16, 635480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '311688.030', 'work_sum': '287115.020', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 22, 0, 22), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 22, 0, 22), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'max_temperature': '20.0', 'min_temperature': '3.265', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 14, 0, 25), 'min_temp_time': datetime.datetime(2019, 3, 31, 6, 0, 23), 'max_press': '112.878', 'min_press': '101.325', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 30, 16, 0, 23), 'min_press_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'price': '0.000', 'use_volume_work': '40.36000000004424', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000040
此查询区间,当前编号下总共抄表记录: 473
此查询区间,上一月最后一天内当前编号下总共抄表记录: 32
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000288'}]
0000000288
00036000000040 ☆ sum_total_volume is None 置为0
00036000000040
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000211')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000288', 'rtu_no': '00030000000081', 'flmeter_no': '00036000000040', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 17, 24480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '13.01', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 21, 12, 25, 56, 828000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 22, 9, 881000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 13, 7, 50, 882000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 22, 9, 881000), 'max_temperature': '23.4', 'min_temperature': '0.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 3, 11, 14, 14, 0, 271000), 'min_temp_time': datetime.datetime(2019, 3, 5, 13, 10, 27, 951000), 'max_press': '114.0', 'min_press': '0.0', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 3, 8, 21, 42, 34, 952000), 'min_press_time': datetime.datetime(2019, 3, 5, 13, 10, 27, 951000), 'price': '1.0', 'use_volume_work': '5.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000040处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 6683
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000289'}]
0000000289
00036000000005 ☆ use_volume_std <0 置为0
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000232')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000289', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 17, 389480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '52235', 'work_sum': '48237', 'max_std_flow': '1556.47', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 11, 17, 6, 53, 383000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 56, 29, 456000), 'max_work_flow': '1572.91', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 11, 17, 6, 53, 383000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 56, 29, 456000), 'max_temperature': '35.91', 'min_temperature': '15.03', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 14, 16, 53, 36000), 'min_temp_time': datetime.datetime(2019, 3, 11, 6, 32, 40, 177000), 'max_press': '101.79', 'min_press': '98.55', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 23, 9, 25, 3, 78000), 'min_press_time': datetime.datetime(2019, 3, 20, 16, 26, 5, 546000), 'price': '2.39', 'use_volume_work': '47958.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.0', 'remain_volume': '0.0', 'fm_state': '00000000', 'fm_state_msg': '无外电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000073
此查询区间,当前编号下总共抄表记录: 3344
此查询区间,上一月最后一天内当前编号下总共抄表记录: 1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000290'}]
0000000290
00036000000073 ☆ sum_total_money <0 置为0
00036000000073
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000226')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000290', 'rtu_no': '00030000000116', 'flmeter_no': '00036000000073', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 17, 753450), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '31', 'work_sum': '16', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 8, 890000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 8, 817000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 17, 55, 8, 890000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 1, 21, 8, 817000), 'max_temperature': '22.46', 'min_temperature': '10.9', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 15, 1, 57, 958000), 'min_temp_time': datetime.datetime(2019, 3, 4, 1, 21, 8, 229000), 'max_press': '102.2', 'min_press': '101.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 8, 1, 22, 37, 12000), 'min_press_time': datetime.datetime(2019, 3, 10, 1, 21, 5, 365000), 'price': '2.39', 'use_volume_work': '16.0', 'use_volume_std': '31.0', 'use_money': '74.09', 'sum_total_volume': '31', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26377.18', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000073处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000080
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000291'}]
0000000291
00036000000080 ☆ sum_total_volume is None 置为0
00036000000080
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000194')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000291', 'rtu_no': '00030000000120', 'flmeter_no': '00036000000080', 'customer_no': '00030000000050', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 18, 241481), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 26, 14, 6, 32, 78000), 'min_std_flow_time': datetime.datetime(2019, 3, 26, 14, 12, 52, 921000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 26, 14, 6, 32, 78000), 'min_work_flow_time': datetime.datetime(2019, 3, 26, 14, 12, 52, 921000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 26, 14, 6, 32, 78000), 'min_temp_time': datetime.datetime(2019, 3, 26, 14, 12, 52, 921000), 'max_press': '101.3', 'min_press': '101.3', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 26, 14, 6, 32, 78000), 'min_press_time': datetime.datetime(2019, 3, 26, 14, 12, 52, 921000), 'price': '2.5', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2200', 'remain_money': '2200', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[用户身份编号出错][电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[用户身份编号出错][电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '1.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000080处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000004
此查询区间,当前编号下总共抄表记录: 5275
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000292'}]
0000000292
00036000000004 ☆ sum_total_money <0 置为0
00036000000004
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000237')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000292', 'rtu_no': '00030000000018', 'flmeter_no': '00036000000004', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 18, 556479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '60364', 'work_sum': '51790', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 29, 16, 25, 6, 296000), 'min_std_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 27, 534000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 29, 16, 25, 6, 296000), 'min_work_flow_time': datetime.datetime(2019, 3, 4, 11, 26, 27, 534000), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 16, 25, 6, 296000), 'min_temp_time': datetime.datetime(2019, 3, 4, 11, 26, 27, 534000), 'max_press': '101.32', 'min_press': '101.32', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 29, 16, 25, 6, 296000), 'min_press_time': datetime.datetime(2019, 3, 4, 11, 26, 27, 534000), 'price': '2.39', 'use_volume_work': '7.0', 'use_volume_std': '7.0', 'use_money': '16.73', 'sum_total_volume': '60364', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '52000.2', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000004处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000043
此查询区间,当前编号下总共抄表记录: 69
此查询区间,上一月最后一天内当前编号下总共抄表记录: 10
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000293'}]
0000000293
00036000000043 ☆ sum_total_volume is None 置为0
00036000000043
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000184')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000293', 'rtu_no': '00030000000084', 'flmeter_no': '00036000000043', 'customer_no': '00030000000035', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 18, 916461), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 0, 20, 59, 782000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 1, 45, 181000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 0, 20, 59, 782000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 1, 45, 181000), 'max_temperature': '14.7', 'min_temperature': '8.1', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 3, 27, 0, 20, 37, 328000), 'min_temp_time': datetime.datetime(2019, 3, 1, 11, 25, 2, 47000), 'max_press': '102.7', 'min_press': '90.1', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 3, 7, 0, 21, 9, 243000), 'min_press_time': datetime.datetime(2019, 3, 10, 23, 25, 18, 693000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '8.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000043处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000079
此查询区间,当前编号下总共抄表记录: 3596
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000294'}]
0000000294
00036000000079 ☆ sum_total_money <0 置为0
00036000000079
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000207')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000294', 'rtu_no': '00030000000119', 'flmeter_no': '00036000000079', 'customer_no': '00030000000049', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 19, 266480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '11', 'work_sum': '11', 'max_std_flow': '35.91', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 13, 14, 52, 57, 146000), 'min_std_flow_time': datetime.datetime(2019, 3, 3, 1, 21, 47, 103000), 'max_work_flow': '35.91', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 13, 14, 52, 57, 146000), 'min_work_flow_time': datetime.datetime(2019, 3, 3, 1, 21, 47, 103000), 'max_temperature': '35.91', 'min_temperature': '0.0', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 14, 52, 57, 146000), 'min_temp_time': datetime.datetime(2019, 3, 12, 16, 10, 35, 771000), 'max_press': '102.8', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 13, 9, 1, 5, 880000), 'min_press_time': datetime.datetime(2019, 3, 12, 16, 10, 35, 771000), 'price': '2.39', 'use_volume_work': '11.0', 'use_volume_std': '11.0', 'use_money': '26.29', 'sum_total_volume': '11', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2427.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000079处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000099
此查询区间,当前编号下总共抄表记录: 14
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000295'}]
0000000295
00036000000099 ☆ sum_total_volume is None 置为0
00036000000099
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000218')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000295', 'rtu_no': '00030000000139', 'flmeter_no': '00036000000099', 'customer_no': '00030000000052', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 19, 661480), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '1.42', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 13, 52, 53, 369000), 'min_std_flow_time': datetime.datetime(2019, 3, 29, 12, 43, 27, 437000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 15, 28, 40, 950000), 'min_work_flow_time': datetime.datetime(2019, 3, 29, 12, 43, 27, 437000), 'max_temperature': '19.9', 'min_temperature': '16.7', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 30, 1, 21, 24, 765000), 'min_temp_time': datetime.datetime(2019, 3, 29, 12, 43, 27, 437000), 'max_press': '104.4', 'min_press': '100.2', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 30, 14, 28, 16, 892000), 'min_press_time': datetime.datetime(2019, 3, 29, 12, 46, 56, 656000), 'price': '1.0', 'use_volume_work': '2.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 6.0, 'total_buy_volume': None, 'total_buy_money': '7', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '22.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000099处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000059
此查询区间,当前编号下总共抄表记录: 682
此查询区间,上一月最后一天内当前编号下总共抄表记录: 28
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000296'}]
0000000296
00036000000059 ☆ sum_total_volume is None 置为0
00036000000059
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000229')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000296', 'rtu_no': '00030000000101', 'flmeter_no': '00036000000059', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 20, 53477), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '10', 'work_sum': '10', 'max_std_flow': '17.99', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 26, 14, 24, 52, 156000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 12, 21, 233000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 5, 865000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 12, 21, 233000), 'max_temperature': '21.2', 'min_temperature': '0.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 6, 5, 7, 2, 613000), 'min_temp_time': datetime.datetime(2019, 3, 25, 15, 31, 46, 531000), 'max_press': '106.5', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 3, 22, 7, 32, 59, 828000), 'min_press_time': datetime.datetime(2019, 3, 25, 15, 31, 46, 531000), 'price': '1.0', 'use_volume_work': '10.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 11.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '4', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000059处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000023
此查询区间,当前编号下总共抄表记录: 273
此查询区间,上一月最后一天内当前编号下总共抄表记录: 12
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000297'}]
0000000297
00036000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000212')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000297', 'rtu_no': None, 'flmeter_no': '00036000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 20, 380457), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '187556.770', 'work_sum': '73774.320', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 16, 0, 24), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 16, 0, 24), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 0, 25), 'max_temperature': '26.86', 'min_temperature': '1.332', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 3, 27, 16, 0, 22), 'min_temp_time': datetime.datetime(2019, 3, 1, 8, 0, 25), 'max_press': '112.372', 'min_press': '100.91', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 3, 1, 14, 0, 25), 'min_press_time': datetime.datetime(2019, 3, 29, 6, 0, 22), 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000089
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000298'}]
0000000298
00036000000089 ☆ sum_total_volume is None 置为0
00036000000089
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000188')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000298', 'rtu_no': '00030000000129', 'flmeter_no': '00036000000089', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 20, 724479), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 30, 2, 59, 9, 968000), 'min_std_flow_time': datetime.datetime(2019, 3, 25, 19, 19, 36, 468000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 30, 2, 59, 9, 968000), 'min_work_flow_time': datetime.datetime(2019, 3, 25, 19, 19, 36, 468000), 'max_temperature': '17.2', 'min_temperature': '0.0', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 3, 25, 19, 19, 36, 468000), 'min_temp_time': datetime.datetime(2019, 3, 26, 23, 33, 2, 781000), 'max_press': '101.4', 'min_press': '0.0', 'avg_press': '10.0', 'max_press_time': datetime.datetime(2019, 3, 25, 19, 19, 36, 468000), 'min_press_time': datetime.datetime(2019, 3, 26, 23, 33, 2, 781000), 'price': '0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '10.0', 'press_out': '10.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '31.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000089处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000056
此查询区间,当前编号下总共抄表记录: 136
此查询区间,上一月最后一天内当前编号下总共抄表记录: 3
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000299'}]
0000000299
00036000000056 ☆ sum_total_volume is None 置为0
00036000000056
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000205')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000299', 'rtu_no': '00030000000098', 'flmeter_no': '00036000000056', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 21, 67467), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 31, 0, 21, 9, 239000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 4, 304000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 0, 21, 9, 239000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 21, 4, 304000), 'max_temperature': '24.7', 'min_temperature': '15.8', 'avg_temperature': '19.0', 'max_temp_time': datetime.datetime(2019, 3, 13, 14, 23, 37, 708000), 'min_temp_time': datetime.datetime(2019, 3, 29, 6, 26, 12, 359000), 'max_press': '102.5', 'min_press': '89.4', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 3, 23, 13, 23, 55, 281000), 'min_press_time': datetime.datetime(2019, 3, 29, 8, 27, 11, 249000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '10.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000056处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000068
此查询区间,当前编号下总共抄表记录: 468
此查询区间,上一月最后一天内当前编号下总共抄表记录: 35
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000300'}]
0000000300
00036000000068 ☆ sum_total_volume is None 置为0
00036000000068
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019030000000199')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019030000000300', 'rtu_no': '00030000000110', 'flmeter_no': '00036000000068', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 21, 411482), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '2', 'work_sum': '2', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 26, 1, 20, 56, 859000), 'min_std_flow_time': datetime.datetime(2019, 3, 1, 0, 7, 26, 357000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 26, 1, 20, 56, 859000), 'min_work_flow_time': datetime.datetime(2019, 3, 1, 0, 7, 26, 357000), 'max_temperature': '22.2', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 3, 5, 12, 27, 6, 357000), 'min_temp_time': datetime.datetime(2019, 3, 14, 15, 55, 14, 818000), 'max_press': '106.4', 'min_press': '0.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 3, 8, 3, 40, 2, 673000), 'min_press_time': datetime.datetime(2019, 3, 14, 15, 55, 14, 818000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[电量不足关阀][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[电量不足关阀][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000068处理好数据已写入oracle
----------------------------------------------------------------------------------------
0003 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0002
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0002 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0010
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0010 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0018
💗 I am main()
总共抄表数据: 211
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0018 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00186000000001
此查询区间,当前编号下总共抄表记录: 211
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000005'}]
0000000005
00186000000001 ☆ sum_total_volume is None 置为0
00186000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0018', '00182019030000000004')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0018', 'srm_id': '00182019030000000005', 'rtu_no': '00180000000001', 'flmeter_no': '00186000000001', 'customer_no': '00180000000001', 'report_time': datetime.datetime(2019, 4, 6, 12, 4, 22, 162486), 'year': '2019', 'month': '03', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '15.7', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 3, 28, 13, 46, 34, 265000), 'min_std_flow_time': datetime.datetime(2019, 3, 25, 16, 23, 46, 453000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 3, 31, 1, 21, 18, 972000), 'min_work_flow_time': datetime.datetime(2019, 3, 25, 16, 23, 46, 453000), 'max_temperature': '20.0', 'min_temperature': '0.0', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 3, 29, 0, 28, 50, 578000), 'min_temp_time': datetime.datetime(2019, 3, 25, 16, 23, 46, 453000), 'max_press': '101.5', 'min_press': '0.0', 'avg_press': '91.0', 'max_press_time': datetime.datetime(2019, 3, 28, 10, 32, 21, 218000), 'min_press_time': datetime.datetime(2019, 3, 25, 16, 23, 46, 453000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '100', 'remain_money': '100', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '91.0', 'press_out': '91.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '21.0', 'srm_status': '1'}]
insert sys_serial_no ok
00186000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0018 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0006
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0006 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0013
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0013 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0014
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0014 ['2019-03-01 00:00:00', '2019-03-31 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
all done-月报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-04-06 12:03:46.338480
程序运行结束时间: 2019-04-06 12:04:22.793448
整个程序运行总时间: 36 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 4e-07
程序运行结束time.clock(): 36.4552256
整个程序运行总时间time.clock()差: 36.4552252 秒
----------------------------------------------------------------------------------------
