============================================================================================================================================================分隔符
此机构: 0008
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0008 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0015
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0015 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0017
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0017 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0005
💗 I am main()
总共抄表数据: 14341
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 482
0005 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 18
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00056000000017
此查询区间,当前编号下总共抄表记录: 1261
此查询区间,上一月最后一天内当前编号下总共抄表记录: 45
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000433'}]
0000000433
00056000000017
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000429')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000433', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 40, 805185), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '192923', 'work_sum': '211295', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 36, 688000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 33, 12, 793000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 36, 688000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 33, 12, 793000), 'max_temperature': '18.13', 'min_temperature': '0.0', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 56, 36, 688000), 'min_temp_time': datetime.datetime(2019, 2, 21, 15, 54, 4, 319000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 56, 36, 688000), 'min_press_time': datetime.datetime(2019, 2, 21, 15, 54, 4, 319000), 'price': '1.55', 'use_volume_work': '9971.0', 'use_volume_std': '13336.0', 'use_money': '20670.8', 'sum_total_volume': '211295', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '14008.73', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000017处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000026
此查询区间,当前编号下总共抄表记录: 393
此查询区间,上一月最后一天内当前编号下总共抄表记录: 45
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000434'}]
0000000434
00056000000026
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000427')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000434', 'rtu_no': '00050000000021', 'flmeter_no': '00056000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 41, 75153), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 13, 10, 420000), 'min_std_flow_time': datetime.datetime(2019, 2, 21, 10, 7, 19, 603000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 13, 10, 420000), 'min_work_flow_time': datetime.datetime(2019, 2, 21, 10, 7, 19, 603000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 13, 10, 420000), 'min_temp_time': datetime.datetime(2019, 2, 21, 10, 7, 19, 603000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 13, 10, 420000), 'min_press_time': datetime.datetime(2019, 2, 21, 10, 7, 19, 603000), 'price': '1.61', 'use_volume_work': '-201324.0', 'use_volume_std': '-179587.0', 'use_money': '-289135.07', 'sum_total_volume': '9097', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2317.45', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000026处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 396
此查询区间,上一月最后一天内当前编号下总共抄表记录: 45
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000435'}]
0000000435
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000423')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000435', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 41, 365182), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 16, 7, 218000), 'min_std_flow_time': datetime.datetime(2019, 2, 21, 10, 23, 9, 90000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 16, 7, 218000), 'min_work_flow_time': datetime.datetime(2019, 2, 21, 10, 23, 9, 90000), 'max_temperature': '33.26', 'min_temperature': '20.0', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 2, 23, 21, 36, 0, 407000), 'min_temp_time': datetime.datetime(2019, 2, 20, 19, 18, 58, 990000), 'max_press': '101.65', 'min_press': '95.23', 'avg_press': '98.0', 'max_press_time': datetime.datetime(2019, 2, 23, 1, 30, 11, 563000), 'min_press_time': datetime.datetime(2019, 2, 18, 18, 11, 2, 382000), 'price': '1.59', 'use_volume_work': '-201324.0', 'use_volume_std': '-179587.0', 'use_money': '-285543.33', 'sum_total_volume': '29929', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '467.96', 'remain_volume': '0.0', 'fm_state': '20', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 813
此查询区间,上一月最后一天内当前编号下总共抄表记录: 79
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000436'}]
0000000436
00056000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000415')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000436', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 41, 635183), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 11, 11, 7, 831000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 19, 0, 236000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 11, 11, 7, 831000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 19, 0, 236000), 'max_temperature': '21.94', 'min_temperature': '0.0', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 22, 58, 41, 303000), 'min_temp_time': datetime.datetime(2019, 2, 3, 20, 23, 0, 842000), 'max_press': '99.25', 'min_press': '0.0', 'avg_press': '94.0', 'max_press_time': datetime.datetime(2019, 2, 22, 3, 37, 1, 573000), 'min_press_time': datetime.datetime(2019, 2, 3, 20, 23, 0, 842000), 'price': '1.43', 'use_volume_work': '-201324.0', 'use_volume_std': '-179587.0', 'use_money': '-256809.41', 'sum_total_volume': '168211', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3199.14', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '94.0', 'press_out': '94.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 1067
此查询区间,上一月最后一天内当前编号下总共抄表记录: 116
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000437'}]
0000000437
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000421')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000437', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 41, 894762), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '56060', 'work_sum': '60398', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 16, 8, 406000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 14, 24, 669000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 16, 8, 406000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 14, 24, 669000), 'max_temperature': '35.78', 'min_temperature': '18.45', 'avg_temperature': '30.0', 'max_temp_time': datetime.datetime(2019, 2, 23, 21, 36, 1, 454000), 'min_temp_time': datetime.datetime(2019, 2, 28, 6, 20, 0, 52000), 'max_press': '101.15', 'min_press': '94.38', 'avg_press': '97.0', 'max_press_time': datetime.datetime(2019, 2, 20, 17, 18, 46, 548000), 'min_press_time': datetime.datetime(2019, 2, 1, 18, 23, 19, 825000), 'price': '1.46', 'use_volume_work': '7046.0', 'use_volume_std': '6578.0', 'use_money': '9603.88', 'sum_total_volume': '56060', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '21366.52', 'remain_volume': '0.0', 'fm_state': '39', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000015
此查询区间,当前编号下总共抄表记录: 1179
此查询区间,上一月最后一天内当前编号下总共抄表记录: 160
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000438'}]
0000000438
00056000000015
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000430')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000438', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000015', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 42, 254792), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '316722', 'work_sum': '237396', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 1, 56, 10, 74000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 38, 54, 417000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 1, 56, 10, 74000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 38, 54, 417000), 'max_temperature': '16.65', 'min_temperature': '0.0', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 22, 29, 33, 231000), 'min_temp_time': datetime.datetime(2019, 2, 21, 21, 56, 7, 546000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 2, 28, 1, 56, 10, 74000), 'min_press_time': datetime.datetime(2019, 2, 21, 21, 56, 7, 546000), 'price': '1.55', 'use_volume_work': '12139.0', 'use_volume_std': '34656.0', 'use_money': '53716.8', 'sum_total_volume': '237396', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '21624.69', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000015处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 377
此查询区间,上一月最后一天内当前编号下总共抄表记录: 160
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000439'}]
0000000439
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000418')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000439', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 42, 564764), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 5, 31, 320000), 'min_std_flow_time': datetime.datetime(2019, 2, 10, 9, 5, 46, 11000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 5, 31, 320000), 'min_work_flow_time': datetime.datetime(2019, 2, 10, 9, 5, 46, 11000), 'max_temperature': '35.91', 'min_temperature': '0.0', 'avg_temperature': '35.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 22, 5, 31, 320000), 'min_temp_time': datetime.datetime(2019, 2, 10, 9, 5, 46, 11000), 'max_press': '101.32', 'min_press': '0.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 25, 22, 5, 31, 320000), 'min_press_time': datetime.datetime(2019, 2, 10, 9, 5, 46, 11000), 'price': '2.28', 'use_volume_work': '-225257.0', 'use_volume_std': '-282066.0', 'use_money': '-643110.48', 'sum_total_volume': '90353', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '758.55', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000018
此查询区间,当前编号下总共抄表记录: 1374
此查询区间,上一月最后一天内当前编号下总共抄表记录: 212
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000440'}]
0000000440
00056000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000431')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000440', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 42, 864887), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '148885', 'work_sum': '148885', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 37, 781000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 8, 45, 975000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 37, 781000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 8, 45, 975000), 'max_temperature': '19.65', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 21, 17, 54, 40, 350000), 'min_temp_time': datetime.datetime(2019, 2, 7, 23, 11, 43, 194000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 56, 37, 781000), 'min_press_time': datetime.datetime(2019, 2, 7, 23, 11, 43, 194000), 'price': '1.55', 'use_volume_work': '8452.0', 'use_volume_std': '8452.0', 'use_money': '13100.6', 'sum_total_volume': '148885', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '11504.22', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0c', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000019
此查询区间,当前编号下总共抄表记录: 1041
此查询区间,上一月最后一天内当前编号下总共抄表记录: 252
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000441'}]
0000000441
00056000000019
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000422')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000441', 'rtu_no': '00050000000016', 'flmeter_no': '00056000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 43, 154776), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 20, 44, 284000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 32, 55, 341000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 20, 44, 284000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 32, 55, 341000), 'max_temperature': '32.15', 'min_temperature': '0.0', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 2, 20, 12, 41, 49, 583000), 'min_temp_time': datetime.datetime(2019, 2, 4, 11, 32, 55, 341000), 'max_press': '91.12', 'min_press': '0.0', 'avg_press': '89.0', 'max_press_time': datetime.datetime(2019, 2, 25, 9, 13, 3, 171000), 'min_press_time': datetime.datetime(2019, 2, 4, 2, 59, 57, 357000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '175768', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '15276.5', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '89.0', 'press_out': '89.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000019处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 1029
此查询区间,上一月最后一天内当前编号下总共抄表记录: 289
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000442'}]
0000000442
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000426')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000442', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 43, 434768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 32, 26, 794000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 17, 23, 996000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 32, 26, 794000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 17, 23, 996000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 32, 26, 794000), 'min_temp_time': datetime.datetime(2019, 2, 2, 1, 17, 23, 996000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 32, 26, 794000), 'min_press_time': datetime.datetime(2019, 2, 2, 1, 17, 23, 996000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '46488', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5240.76', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 988
此查询区间,上一月最后一天内当前编号下总共抄表记录: 319
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000443'}]
0000000443
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000432')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000443', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 43, 704886), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 37, 12, 157000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 2, 29, 40, 57000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 37, 12, 157000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 2, 29, 40, 57000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 37, 12, 157000), 'min_temp_time': datetime.datetime(2019, 2, 4, 2, 29, 40, 57000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 37, 12, 157000), 'min_press_time': datetime.datetime(2019, 2, 4, 2, 29, 40, 57000), 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '3730', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '69000.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '06', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 472
此查询区间,上一月最后一天内当前编号下总共抄表记录: 338
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000444'}]
0000000444
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000416')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000444', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 43, 984771), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '227390', 'work_sum': '227390', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 6, 29, 44, 376000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 53, 37, 465000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 6, 29, 44, 376000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 53, 37, 465000), 'max_temperature': '21.48', 'min_temperature': '9.76', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 13, 13, 57, 56, 370000), 'min_temp_time': datetime.datetime(2019, 2, 1, 6, 14, 13, 903000), 'max_press': '86.29', 'min_press': '86.29', 'avg_press': '86.0', 'max_press_time': datetime.datetime(2019, 2, 26, 6, 29, 44, 376000), 'min_press_time': datetime.datetime(2019, 2, 2, 0, 53, 37, 465000), 'price': '1.43', 'use_volume_work': '23328.0', 'use_volume_std': '23328.0', 'use_money': '33359.04', 'sum_total_volume': '227390', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '12466.47', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 323
此查询区间,上一月最后一天内当前编号下总共抄表记录: 338
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000445'}]
0000000445
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000419')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000445', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 44, 354733), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 43, 14, 52000), 'min_std_flow_time': datetime.datetime(2019, 2, 21, 9, 56, 38, 790000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 43, 14, 52000), 'min_work_flow_time': datetime.datetime(2019, 2, 21, 9, 56, 38, 790000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 43, 14, 52000), 'min_temp_time': datetime.datetime(2019, 2, 21, 9, 56, 38, 790000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 43, 14, 52000), 'min_press_time': datetime.datetime(2019, 2, 21, 9, 56, 38, 790000), 'price': '2.28', 'use_volume_work': '-204062.0', 'use_volume_std': '-204062.0', 'use_money': '-465261.36', 'sum_total_volume': '83384', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '4721.8', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 911
此查询区间,上一月最后一天内当前编号下总共抄表记录: 369
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000446'}]
0000000446
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000424')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000446', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 44, 624734), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '93783', 'work_sum': '105211', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 47, 11, 899000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 29, 14, 289000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 47, 11, 899000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 29, 14, 289000), 'max_temperature': '26.28', 'min_temperature': '11.37', 'avg_temperature': '21.0', 'max_temp_time': datetime.datetime(2019, 2, 14, 1, 2, 59, 960000), 'min_temp_time': datetime.datetime(2019, 2, 20, 7, 41, 12, 481000), 'max_press': '98.23', 'min_press': '87.19', 'avg_press': '95.0', 'max_press_time': datetime.datetime(2019, 2, 9, 22, 51, 51, 547000), 'min_press_time': datetime.datetime(2019, 2, 19, 19, 38, 51, 368000), 'price': '1.52', 'use_volume_work': '-98851.0', 'use_volume_std': '-110279.0', 'use_money': '-167624.08', 'sum_total_volume': '98300', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '8535700.0', 'remain_volume': '0.0', 'fm_state': '21', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '36', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '95.0', 'press_out': '95.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000016
此查询区间,当前编号下总共抄表记录: 1136
此查询区间,上一月最后一天内当前编号下总共抄表记录: 415
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000447'}]
0000000447
00056000000016
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000428')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000447', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 44, 934734), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '441599', 'work_sum': '257811', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 35, 672000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 38, 55, 214000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 56, 35, 672000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 38, 55, 214000), 'max_temperature': '83.5', 'min_temperature': '0.0', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 24, 19, 35, 33, 551000), 'min_temp_time': datetime.datetime(2019, 2, 19, 18, 56, 35, 709000), 'max_press': '83.5', 'min_press': '0.0', 'avg_press': '83.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 56, 35, 672000), 'min_press_time': datetime.datetime(2019, 2, 19, 18, 56, 35, 709000), 'price': '1.55', 'use_volume_work': '53749.0', 'use_volume_std': '237537.0', 'use_money': '368182.35', 'sum_total_volume': '257811', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13928.65', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000016处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 222
此查询区间,上一月最后一天内当前编号下总共抄表记录: 415
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000448'}]
0000000448
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000425')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000448', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 45, 204769), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 18, 16, 10, 197000), 'min_std_flow_time': datetime.datetime(2019, 2, 24, 16, 7, 55, 140000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 18, 16, 10, 197000), 'min_work_flow_time': datetime.datetime(2019, 2, 24, 16, 7, 55, 140000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 27, 18, 16, 10, 197000), 'min_temp_time': datetime.datetime(2019, 2, 24, 16, 7, 55, 140000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 27, 18, 16, 10, 197000), 'min_press_time': datetime.datetime(2019, 2, 24, 16, 7, 55, 140000), 'price': '1.61', 'use_volume_work': '-204062.0', 'use_volume_std': '-204062.0', 'use_money': '-328539.82', 'sum_total_volume': '23771', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '8146.29', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 434
此查询区间,上一月最后一天内当前编号下总共抄表记录: 449
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000449'}]
0000000449
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000420')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000449', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 45, 514735), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 7, 17, 306000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 45, 21, 215000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 7, 17, 306000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 45, 21, 215000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 21, 7, 17, 306000), 'min_temp_time': datetime.datetime(2019, 2, 2, 0, 45, 21, 215000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 7, 17, 306000), 'min_press_time': datetime.datetime(2019, 2, 2, 0, 45, 21, 215000), 'price': '1.61', 'use_volume_work': '-204062.0', 'use_volume_std': '-204062.0', 'use_money': '-328539.82', 'sum_total_volume': '5700', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '137.7', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 925
此查询区间,上一月最后一天内当前编号下总共抄表记录: 482
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000450'}]
0000000450
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0005', '00052019020000000417')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0005', 'srm_id': '00052019020000000450', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 45, 804770), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '601014', 'work_sum': '601014', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 18, 55, 81000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 53, 55, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 18, 55, 81000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 53, 55, 840000), 'max_temperature': '19.58', 'min_temperature': '5.57', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 13, 21, 8, 46, 602000), 'min_temp_time': datetime.datetime(2019, 2, 10, 9, 40, 6, 71000), 'max_press': '84.0', 'min_press': '84.0', 'avg_press': '84.0', 'max_press_time': datetime.datetime(2019, 2, 25, 21, 18, 55, 81000), 'min_press_time': datetime.datetime(2019, 2, 2, 1, 53, 55, 840000), 'price': '1.52', 'use_volume_work': '396952.0', 'use_volume_std': '396952.0', 'use_money': '603367.04', 'sum_total_volume': '601014', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '6374.5', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '80', 'valve_state_msg': '开阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '84.0', 'press_out': '84.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
0005 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0007
💗 I am main()
总共抄表数据: 10
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 1
0007 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00076000000001
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一月最后一天内当前编号下总共抄表记录: 1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0007', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0007', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000015'}]
0000000015
00076000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0007', '00072019020000000014')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0007', 'srm_id': '00072019020000000015', 'rtu_no': '00070000000001', 'flmeter_no': '00076000000001', 'customer_no': '00070000000001', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 46, 184744), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '781', 'work_sum': '777', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 8, 23, 32, 20, 694000), 'min_std_flow_time': datetime.datetime(2019, 2, 1, 23, 32, 1, 996000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 8, 23, 32, 20, 694000), 'min_work_flow_time': datetime.datetime(2019, 2, 1, 23, 32, 1, 996000), 'max_temperature': '12.4', 'min_temperature': '1.5', 'avg_temperature': '6.0', 'max_temp_time': datetime.datetime(2019, 2, 2, 23, 32, 4, 512000), 'min_temp_time': datetime.datetime(2019, 2, 8, 23, 32, 20, 694000), 'max_press': '103.4', 'min_press': '98.3', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 2, 23, 32, 4, 512000), 'min_press_time': datetime.datetime(2019, 2, 8, 23, 32, 20, 694000), 'price': '3.09', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 103.0, 'total_buy_volume': None, 'total_buy_money': '2192', 'remain_money': '2089', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '6.0', 'temp_out': '6.0', 'rssi': '10.0', 'srm_status': '1'}]
insert sys_serial_no ok
00076000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0007 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0009
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0009 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0011
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0011 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0012
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0012 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0016
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0016 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0003
💗 I am main()
总共抄表数据: 16121
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 537
0003 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 开始进行计算月报表数据处理
不同的表计号共有个数: 47
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00036000000008
此查询区间,当前编号下总共抄表记录: 70
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000584'}]
0000000584
00036000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000541')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000584', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 47, 774734), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 13, 16, 58, 29, 653000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 37, 29, 851000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 13, 16, 58, 29, 653000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 37, 29, 851000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 13, 16, 58, 29, 653000), 'min_temp_time': datetime.datetime(2019, 2, 4, 12, 37, 29, 851000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 13, 16, 58, 29, 653000), 'min_press_time': datetime.datetime(2019, 2, 4, 12, 37, 29, 851000), 'price': '0.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '48385', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '51686.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '81', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000055
此查询区间,当前编号下总共抄表记录: 84
此查询区间,上一月最后一天内当前编号下总共抄表记录: 6
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000585'}]
0000000585
00036000000055
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000569')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000585', 'rtu_no': '00030000000097', 'flmeter_no': '00036000000055', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 48, 64778), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 23, 43, 516000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 52, 21, 856000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 23, 43, 516000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 52, 21, 856000), 'max_temperature': '11.3', 'min_temperature': '9.1', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 18, 30, 56, 733000), 'min_temp_time': datetime.datetime(2019, 2, 17, 0, 51, 21, 228000), 'max_press': '103.0', 'min_press': '97.7', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 12, 0, 51, 35, 891000), 'min_press_time': datetime.datetime(2019, 2, 28, 22, 32, 27, 852000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 8.0, 'total_buy_volume': None, 'total_buy_money': '16', 'remain_money': '8', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000055处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000072
此查询区间,当前编号下总共抄表记录: 559
此查询区间,上一月最后一天内当前编号下总共抄表记录: 34
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000586'}]
0000000586
00036000000072
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000578')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000586', 'rtu_no': '00030000000115', 'flmeter_no': '00036000000072', 'customer_no': '00030000000002', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 48, 424731), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 58, 55, 607000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 49, 39, 414000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 58, 55, 607000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 49, 39, 414000), 'max_temperature': '20.4', 'min_temperature': '8.9', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 22, 1, 21, 36, 242000), 'min_temp_time': datetime.datetime(2019, 2, 11, 7, 20, 14, 316000), 'max_press': '103.3', 'min_press': '94.8', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 10, 20, 46, 983000), 'min_press_time': datetime.datetime(2019, 2, 26, 15, 50, 45, 363000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000072处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000059
此查询区间,当前编号下总共抄表记录: 458
此查询区间,上一月最后一天内当前编号下总共抄表记录: 36
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000587'}]
0000000587
00036000000059
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000562')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000587', 'rtu_no': '00030000000101', 'flmeter_no': '00036000000059', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 48, 714763), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 5, 34, 836000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 29, 46, 856000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 5, 34, 836000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 29, 46, 856000), 'max_temperature': '23.9', 'min_temperature': '8.0', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 16, 10, 57, 162000), 'min_temp_time': datetime.datetime(2019, 2, 12, 7, 24, 50, 17000), 'max_press': '105.3', 'min_press': '100.7', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 21, 19, 28, 16, 232000), 'min_press_time': datetime.datetime(2019, 2, 3, 1, 36, 19, 200000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000059处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000044
此查询区间,当前编号下总共抄表记录: 531
此查询区间,上一月最后一天内当前编号下总共抄表记录: 56
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000588'}]
0000000588
00036000000044
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000571')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000588', 'rtu_no': '00030000000085', 'flmeter_no': '00036000000044', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 49, 94733), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 50, 1, 354000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 28, 7, 320000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 50, 1, 354000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 28, 7, 320000), 'max_temperature': '8.4', 'min_temperature': '1.2', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 23, 34, 10, 772000), 'min_temp_time': datetime.datetime(2019, 2, 9, 11, 25, 59, 653000), 'max_press': '105.9', 'min_press': '101.1', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 2, 9, 11, 25, 59, 653000), 'min_press_time': datetime.datetime(2019, 2, 2, 14, 26, 8, 481000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '5.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000044处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000052
此查询区间,当前编号下总共抄表记录: 563
此查询区间,上一月最后一天内当前编号下总共抄表记录: 79
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000589'}]
0000000589
00036000000052
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000575')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000589', 'rtu_no': '00030000000094', 'flmeter_no': '00036000000052', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 49, 734745), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '3902', 'work_sum': '3747', 'max_std_flow': '15.46', 'min_std_flow': '0.0', 'avg_std_flow': '2.0', 'max_std_flow_time': datetime.datetime(2019, 2, 15, 5, 24, 10, 800000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 14, 26, 38, 59000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 29, 57, 635000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 15, 32, 14, 836000), 'max_temperature': '25.6', 'min_temperature': '11.3', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 2, 24, 13, 26, 25, 923000), 'min_temp_time': datetime.datetime(2019, 2, 20, 7, 24, 13, 966000), 'max_press': '106.7', 'min_press': '96.5', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 2, 14, 3, 22, 51, 651000), 'min_press_time': datetime.datetime(2019, 2, 5, 10, 24, 54, 231000), 'price': '1.0', 'use_volume_work': '3747.0', 'use_volume_std': '3902.0', 'use_money': '3902.0', 'sum_total_volume': None, 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '1.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000052处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000048
此查询区间,当前编号下总共抄表记录: 245
此查询区间,上一月最后一天内当前编号下总共抄表记录: 85
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000590'}]
0000000590
00036000000048
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000557')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000590', 'rtu_no': '00030000000090', 'flmeter_no': '00036000000048', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 50, 544769), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 24, 9, 313000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 19, 965000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 24, 9, 313000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 19, 965000), 'max_temperature': '17.7', 'min_temperature': '13.6', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 23, 33, 35, 272000), 'min_temp_time': datetime.datetime(2019, 2, 11, 3, 24, 2, 342000), 'max_press': '103.3', 'min_press': '94.4', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 14, 0, 21, 11, 178000), 'min_press_time': datetime.datetime(2019, 2, 24, 1, 23, 5, 80000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '11.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000048处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000050
此查询区间,当前编号下总共抄表记录: 818
此查询区间,上一月最后一天内当前编号下总共抄表记录: 116
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000591'}]
0000000591
00036000000050
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000551')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000591', 'rtu_no': '00030000000092', 'flmeter_no': '00036000000050', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 50, 914783), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 11, 15, 511000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 18, 40, 737000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 11, 15, 511000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 18, 40, 737000), 'max_temperature': '20.9', 'min_temperature': '7.6', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 13, 9, 34, 340000), 'min_temp_time': datetime.datetime(2019, 2, 12, 5, 0, 9, 711000), 'max_press': '103.3', 'min_press': '77.4', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 9, 55, 36, 426000), 'min_press_time': datetime.datetime(2019, 2, 2, 8, 7, 46, 543000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000050处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000022
此查询区间,当前编号下总共抄表记录: 208
此查询区间,上一月最后一天内当前编号下总共抄表记录: 128
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000592'}]
0000000592
00036000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000549')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000592', 'rtu_no': None, 'flmeter_no': '00036000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 51, 204793), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '1511546.680', 'work_sum': '431435.100', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 24), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 24), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_temperature': '19.867', 'min_temperature': '1.428', 'avg_temperature': '7.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 16, 0, 22), 'min_temp_time': datetime.datetime(2019, 2, 2, 4, 0, 25), 'max_press': '120.811', 'min_press': '110.621', 'avg_press': '114.0', 'max_press_time': datetime.datetime(2019, 2, 1, 0, 0, 25), 'min_press_time': datetime.datetime(2019, 2, 21, 6, 0, 20), 'price': '0.000', 'use_volume_work': '431435.1', 'use_volume_std': '1511546.68', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '114.0', 'press_out': '114.0', 'temp_in': '7.0', 'temp_out': '7.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 773
此查询区间,上一月最后一天内当前编号下总共抄表记录: 167
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000593'}]
0000000593
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000545')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000593', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 51, 514768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '247', 'work_sum': '253', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 24, 35, 834000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 15, 45, 86000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 24, 35, 834000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 15, 45, 86000), 'max_temperature': '21.65', 'min_temperature': '10.53', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 22, 17, 12, 54, 293000), 'min_temp_time': datetime.datetime(2019, 2, 18, 6, 17, 48, 735000), 'max_press': '102.52', 'min_press': '100.21', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 13, 8, 44, 48, 912000), 'min_press_time': datetime.datetime(2019, 2, 2, 17, 58, 21, 418000), 'price': '3.5', 'use_volume_work': '84.0', 'use_volume_std': '84.0', 'use_money': '294.0', 'sum_total_volume': '247', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '11.0', 'remain_volume': '0.0', 'fm_state': '25', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '81', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000038
此查询区间,当前编号下总共抄表记录: 94
此查询区间,上一月最后一天内当前编号下总共抄表记录: 168
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000594'}]
0000000594
00036000000038
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000554')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000594', 'rtu_no': '00030000000079', 'flmeter_no': '00036000000038', 'customer_no': '00030000000016', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 51, 824899), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 20, 27, 24, 182000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 45, 8, 12000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 20, 27, 24, 182000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 45, 8, 12000), 'max_temperature': '9.5', 'min_temperature': '-0.2', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 21, 32, 22, 537000), 'min_temp_time': datetime.datetime(2019, 2, 9, 10, 45, 50, 685000), 'max_press': '103.8', 'min_press': '100.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 14, 1, 22, 39, 61000), 'min_press_time': datetime.datetime(2019, 2, 2, 14, 47, 23, 371000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000038处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000067
此查询区间,当前编号下总共抄表记录: 561
此查询区间,上一月最后一天内当前编号下总共抄表记录: 196
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000595'}]
0000000595
00036000000067
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000579')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000595', 'rtu_no': '00030000000109', 'flmeter_no': '00036000000067', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 52, 244784), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 3, 7, 3, 329000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 21, 45, 822000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 3, 7, 3, 329000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 21, 45, 822000), 'max_temperature': '22.7', 'min_temperature': '9.2', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 20, 10, 25, 583000), 'min_temp_time': datetime.datetime(2019, 2, 17, 1, 22, 37, 72000), 'max_press': '105.1', 'min_press': '100.7', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 28, 2, 6, 53, 54000), 'min_press_time': datetime.datetime(2019, 2, 7, 3, 33, 8, 687000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '17.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000067处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000060
此查询区间,当前编号下总共抄表记录: 474
此查询区间,上一月最后一天内当前编号下总共抄表记录: 220
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000596'}]
0000000596
00036000000060
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000570')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000596', 'rtu_no': '00030000000102', 'flmeter_no': '00036000000060', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 52, 534884), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 18, 25, 31, 831000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 25, 23, 446000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 18, 25, 31, 831000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 25, 23, 446000), 'max_temperature': '11.5', 'min_temperature': '9.1', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 7, 9, 24, 31, 575000), 'min_temp_time': datetime.datetime(2019, 2, 17, 8, 26, 3, 810000), 'max_press': '103.3', 'min_press': '99.8', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 9, 24, 25, 711000), 'min_press_time': datetime.datetime(2019, 2, 2, 14, 25, 58, 528000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000060处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000061
此查询区间,当前编号下总共抄表记录: 713
此查询区间,上一月最后一天内当前编号下总共抄表记录: 244
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000597'}]
0000000597
00036000000061
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000561')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000597', 'rtu_no': '00030000000103', 'flmeter_no': '00036000000061', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 52, 844881), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 18, 36, 4, 69000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 25, 38, 759000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 18, 36, 4, 69000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 25, 38, 759000), 'max_temperature': '11.6', 'min_temperature': '9.2', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 7, 8, 24, 2, 153000), 'min_temp_time': datetime.datetime(2019, 2, 17, 2, 22, 36, 469000), 'max_press': '127.9', 'min_press': '100.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 5, 11, 24, 57, 926000), 'min_press_time': datetime.datetime(2019, 2, 2, 19, 28, 27, 12000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000061处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000007
此查询区间,当前编号下总共抄表记录: 44
此查询区间,上一月最后一天内当前编号下总共抄表记录: 244
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000598'}]
0000000598
00036000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000572')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000598', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 53, 164768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '64', 'work_sum': '66', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 13, 12, 52, 35, 119000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 13, 7, 36, 39000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 13, 12, 52, 35, 119000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 13, 7, 36, 39000), 'max_temperature': '26.96', 'min_temperature': '26.96', 'avg_temperature': '26.0', 'max_temp_time': datetime.datetime(2019, 2, 13, 12, 52, 35, 119000), 'min_temp_time': datetime.datetime(2019, 2, 4, 13, 7, 36, 39000), 'max_press': '100.15', 'min_press': '100.15', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 13, 12, 52, 35, 119000), 'min_press_time': datetime.datetime(2019, 2, 4, 13, 7, 36, 39000), 'price': '0.0', 'use_volume_work': '-103.0', 'use_volume_std': '-99.0', 'use_money': '-0.0', 'sum_total_volume': '60498', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '39566.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '81', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '26.0', 'temp_out': '26.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000037
此查询区间,当前编号下总共抄表记录: 40
此查询区间,上一月最后一天内当前编号下总共抄表记录: 245
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000599'}]
0000000599
00036000000037
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000577')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000599', 'rtu_no': '00030000000064', 'flmeter_no': '00036000000037', 'customer_no': '00030000000018', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 53, 454751), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 16, 34, 52, 932000), 'min_std_flow_time': datetime.datetime(2019, 2, 3, 0, 20, 51, 965000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 16, 34, 52, 932000), 'min_work_flow_time': datetime.datetime(2019, 2, 3, 0, 20, 51, 965000), 'max_temperature': '12.7', 'min_temperature': '9.3', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 16, 34, 52, 932000), 'min_temp_time': datetime.datetime(2019, 2, 17, 0, 21, 2, 367000), 'max_press': '102.9', 'min_press': '100.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 0, 20, 45, 54000), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 20, 51, 965000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 6.0, 'total_buy_volume': None, 'total_buy_money': '6', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '16.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000037处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000066
此查询区间,当前编号下总共抄表记录: 117
此查询区间,上一月最后一天内当前编号下总共抄表记录: 245
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000600'}]
0000000600
00036000000066
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000582')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000600', 'rtu_no': '00030000000108', 'flmeter_no': '00036000000066', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 53, 744765), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '534', 'work_sum': '492', 'max_std_flow': '3.28', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 10, 25, 3, 856000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 25, 19, 818000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 11, 24, 38, 903000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 25, 19, 818000), 'max_temperature': '23.6', 'min_temperature': '4.4', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 24, 13, 25, 8, 329000), 'min_temp_time': datetime.datetime(2019, 2, 20, 5, 23, 18, 986000), 'max_press': '113.6', 'min_press': '100.7', 'avg_press': '108.0', 'max_press_time': datetime.datetime(2019, 2, 6, 16, 26, 11, 348000), 'min_press_time': datetime.datetime(2019, 2, 25, 5, 23, 49, 289000), 'price': '1.0', 'use_volume_work': '323.0', 'use_volume_std': '371.0', 'use_money': '371.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '108.0', 'press_out': '108.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '20.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000066处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000040
此查询区间,当前编号下总共抄表记录: 151
此查询区间,上一月最后一天内当前编号下总共抄表记录: 246
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000601'}]
0000000601
00036000000040
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000548')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000601', 'rtu_no': '00030000000081', 'flmeter_no': '00036000000040', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 54, 74768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 1, 23, 13, 181000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 12, 168000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 1, 23, 13, 181000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 12, 168000), 'max_temperature': '25.4', 'min_temperature': '1.2', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 15, 21, 45, 718000), 'min_temp_time': datetime.datetime(2019, 2, 9, 0, 21, 5, 260000), 'max_press': '103.9', 'min_press': '101.1', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 26, 9, 24, 56, 746000), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 20, 56, 153000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '6', 'remain_money': '6', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '29.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000040处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000051
此查询区间,当前编号下总共抄表记录: 202
此查询区间,上一月最后一天内当前编号下总共抄表记录: 259
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000602'}]
0000000602
00036000000051
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000580')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000602', 'rtu_no': '00030000000093', 'flmeter_no': '00036000000051', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 54, 504897), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 22, 17, 314000), 'min_std_flow_time': datetime.datetime(2019, 2, 3, 0, 21, 34, 715000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 22, 17, 314000), 'min_work_flow_time': datetime.datetime(2019, 2, 3, 0, 21, 34, 715000), 'max_temperature': '17.8', 'min_temperature': '13.7', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 20, 27, 35, 721000), 'min_temp_time': datetime.datetime(2019, 2, 11, 0, 20, 59, 304000), 'max_press': '112.2', 'min_press': '101.2', 'avg_press': '104.0', 'max_press_time': datetime.datetime(2019, 2, 23, 5, 22, 41, 95000), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 21, 34, 715000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '4.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000051处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000021
此查询区间,当前编号下总共抄表记录: 22
此查询区间,上一月最后一天内当前编号下总共抄表记录: 259
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000603'}]
0000000603
00036000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000547')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000603', 'rtu_no': '00030000000055', 'flmeter_no': '00036000000021', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 54, 824780), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.37', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 18, 6, 22, 980000), 'min_std_flow_time': datetime.datetime(2019, 2, 25, 0, 21, 8, 671000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 15, 14, 28, 79000), 'min_work_flow_time': datetime.datetime(2019, 2, 25, 0, 21, 8, 671000), 'max_temperature': '20.4', 'min_temperature': '10.7', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 26, 14, 10, 16, 544000), 'min_temp_time': datetime.datetime(2019, 2, 27, 0, 21, 2, 338000), 'max_press': '102.9', 'min_press': '90.2', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 23, 0, 21, 34, 975000), 'min_press_time': datetime.datetime(2019, 2, 25, 16, 6, 1, 206000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000077
此查询区间,当前编号下总共抄表记录: 812
此查询区间,上一月最后一天内当前编号下总共抄表记录: 289
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000604'}]
0000000604
00036000000077
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000567')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000604', 'rtu_no': '00030000000118', 'flmeter_no': '00036000000077', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 55, 154768), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '1.88', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 19, 32, 29, 688000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 56, 15, 567000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 43, 50, 38000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 56, 15, 567000), 'max_temperature': '20.4', 'min_temperature': '8.8', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 23, 33, 33, 749000), 'min_temp_time': datetime.datetime(2019, 2, 11, 7, 27, 7, 112000), 'max_press': '104.2', 'min_press': '95.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 1, 26, 1, 834000), 'min_press_time': datetime.datetime(2019, 2, 28, 15, 46, 13, 317000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000077处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000058
此查询区间,当前编号下总共抄表记录: 820
此查询区间,上一月最后一天内当前编号下总共抄表记录: 313
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000605'}]
0000000605
00036000000058
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000581')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000605', 'rtu_no': '00030000000100', 'flmeter_no': '00036000000058', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 55, 444767), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 32, 9, 528000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 24, 21, 525000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 32, 9, 528000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 24, 21, 525000), 'max_temperature': '17.8', 'min_temperature': '13.9', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 24, 23, 32, 59, 879000), 'min_temp_time': datetime.datetime(2019, 2, 11, 8, 25, 49, 189000), 'max_press': '118.2', 'min_press': '101.0', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 2, 28, 11, 23, 22, 655000), 'min_press_time': datetime.datetime(2019, 2, 2, 14, 24, 39, 981000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '21.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000058处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000045
此查询区间,当前编号下总共抄表记录: 327
此查询区间,上一月最后一天内当前编号下总共抄表记录: 315
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000606'}]
0000000606
00036000000045
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000546')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000606', 'rtu_no': '00030000000086', 'flmeter_no': '00036000000045', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 55, 834816), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '759', 'work_sum': '757', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 20, 19, 0, 96000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 10, 15, 47, 903000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 20, 19, 0, 96000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 10, 15, 47, 903000), 'max_temperature': '18.6', 'min_temperature': '18.6', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 2, 26, 20, 19, 0, 96000), 'min_temp_time': datetime.datetime(2019, 2, 2, 10, 15, 47, 903000), 'max_press': '102.2', 'min_press': '102.2', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 26, 20, 19, 0, 96000), 'min_press_time': datetime.datetime(2019, 2, 2, 10, 15, 47, 903000), 'price': '1.0', 'use_volume_work': '588.0', 'use_volume_std': '596.0', 'use_money': '596.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '40', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000045处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000075
此查询区间,当前编号下总共抄表记录: 770
此查询区间,上一月最后一天内当前编号下总共抄表记录: 317
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000607'}]
0000000607
00036000000075
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000573')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000607', 'rtu_no': '00030000000117', 'flmeter_no': '00036000000075', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 56, 291356), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 17, 19, 46, 166000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 11, 684000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 17, 19, 46, 166000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 11, 684000), 'max_temperature': '20.6', 'min_temperature': '8.8', 'avg_temperature': '13.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 20, 11, 44, 244000), 'min_temp_time': datetime.datetime(2019, 2, 11, 7, 48, 16, 206000), 'max_press': '163.7', 'min_press': '101.1', 'avg_press': '107.0', 'max_press_time': datetime.datetime(2019, 2, 13, 6, 56, 27, 51000), 'min_press_time': datetime.datetime(2019, 2, 3, 1, 21, 39, 325000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '107.0', 'press_out': '107.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '12.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000075处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000018
此查询区间,当前编号下总共抄表记录: 119
此查询区间,上一月最后一天内当前编号下总共抄表记录: 317
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000608'}]
0000000608
00036000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000574')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000608', 'rtu_no': '00030000000049', 'flmeter_no': '00036000000018', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 56, 621388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '333', 'work_sum': '123', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 18, 31, 56, 19000), 'min_std_flow_time': datetime.datetime(2019, 2, 22, 13, 46, 45, 52000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 18, 31, 56, 19000), 'min_work_flow_time': datetime.datetime(2019, 2, 22, 13, 46, 45, 52000), 'max_temperature': '25.7', 'min_temperature': '0.0', 'avg_temperature': '17.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 19, 46, 58, 81000), 'min_temp_time': datetime.datetime(2019, 2, 22, 11, 30, 22, 191000), 'max_press': '101.8', 'min_press': '0.0', 'avg_press': '78.0', 'max_press_time': datetime.datetime(2019, 2, 26, 16, 58, 54, 109000), 'min_press_time': datetime.datetime(2019, 2, 22, 11, 30, 22, 191000), 'price': '2.5', 'use_volume_work': '-46.0', 'use_volume_std': '170.0', 'use_money': '425.0', 'sum_total_volume': None, 'sum_total_money': 1399.0, 'total_buy_volume': None, 'total_buy_money': '2500', 'remain_money': '1101', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '78.0', 'press_out': '78.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '8.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000064
此查询区间,当前编号下总共抄表记录: 411
此查询区间,上一月最后一天内当前编号下总共抄表记录: 341
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000609'}]
0000000609
00036000000064
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000540')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000609', 'rtu_no': '00030000000106', 'flmeter_no': '00036000000064', 'customer_no': '00030000000046', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 56, 971388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 3, 23, 4, 944000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 3, 22, 25, 349000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 3, 23, 4, 944000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 3, 22, 25, 349000), 'max_temperature': '11.4', 'min_temperature': '9.0', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 7, 2, 22, 22, 161000), 'min_temp_time': datetime.datetime(2019, 2, 17, 10, 23, 25, 610000), 'max_press': '103.0', 'min_press': '76.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 11, 1, 21, 12, 447000), 'min_press_time': datetime.datetime(2019, 2, 3, 2, 21, 48, 762000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000064处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000020
此查询区间,当前编号下总共抄表记录: 35
此查询区间,上一月最后一天内当前编号下总共抄表记录: 341
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000610'}]
0000000610
00036000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000543')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000610', 'rtu_no': '00030000000051', 'flmeter_no': '00036000000020', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 57, 291517), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 11, 51, 58, 854000), 'min_std_flow_time': datetime.datetime(2019, 2, 24, 14, 1, 5, 302000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 11, 51, 58, 854000), 'min_work_flow_time': datetime.datetime(2019, 2, 24, 14, 1, 5, 302000), 'max_temperature': '24.0', 'min_temperature': '0.0', 'avg_temperature': '11.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 15, 22, 28, 95000), 'min_temp_time': datetime.datetime(2019, 2, 24, 14, 1, 5, 302000), 'max_press': '102.9', 'min_press': '0.0', 'avg_press': '55.0', 'max_press_time': datetime.datetime(2019, 2, 25, 14, 12, 17, 396000), 'min_press_time': datetime.datetime(2019, 2, 24, 14, 1, 5, 302000), 'price': '1.0', 'use_volume_work': '-169.0', 'use_volume_std': '-163.0', 'use_money': '-163.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '50', 'press_in': '55.0', 'press_out': '55.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000028
此查询区间,当前编号下总共抄表记录: 209
此查询区间,上一月最后一天内当前编号下总共抄表记录: 353
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000611'}]
0000000611
00036000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000558')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000611', 'rtu_no': None, 'flmeter_no': '00036000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 57, 611499), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '311644.480', 'work_sum': '287074.660', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 23), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 23), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_temperature': '20.0', 'min_temperature': '20.0', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 18, 0, 23), 'min_temp_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'max_press': '101.325', 'min_press': '101.325', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 28, 18, 0, 23), 'min_press_time': datetime.datetime(2019, 2, 4, 12, 0, 24), 'price': '0.000', 'use_volume_work': '286905.66', 'use_volume_std': '311481.48', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000068
此查询区间,当前编号下总共抄表记录: 873
此查询区间,上一月最后一天内当前编号下总共抄表记录: 378
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000612'}]
0000000612
00036000000068
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000552')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000612', 'rtu_no': '00030000000110', 'flmeter_no': '00036000000068', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 57, 961386), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '2', 'work_sum': '2', 'max_std_flow': '4.71', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 15, 15, 58, 45, 397000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 57, 13, 575000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 52, 36, 122000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 57, 13, 575000), 'max_temperature': '22.3', 'min_temperature': '7.6', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 23, 6, 41, 40, 618000), 'min_temp_time': datetime.datetime(2019, 2, 12, 5, 44, 1, 997000), 'max_press': '106.3', 'min_press': '100.7', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 20, 16, 30, 35, 769000), 'min_press_time': datetime.datetime(2019, 2, 7, 3, 20, 33, 968000), 'price': '1.0', 'use_volume_work': '2.0', 'use_volume_std': '2.0', 'use_money': '2.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '15.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000068处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000012
此查询区间,当前编号下总共抄表记录: 51
此查询区间,上一月最后一天内当前编号下总共抄表记录: 381
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000613'}]
0000000613
00036000000012
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000544')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000613', 'rtu_no': '00030000000043', 'flmeter_no': '00036000000012', 'customer_no': '00030000000005', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 58, 291356), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '6837', 'work_sum': '6828', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 1, 20, 37, 895000), 'min_std_flow_time': datetime.datetime(2019, 2, 1, 1, 20, 40, 356000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 1, 20, 37, 895000), 'min_work_flow_time': datetime.datetime(2019, 2, 1, 1, 20, 40, 356000), 'max_temperature': '19.6', 'min_temperature': '9.0', 'avg_temperature': '10.0', 'max_temp_time': datetime.datetime(2019, 2, 22, 14, 36, 45, 528000), 'min_temp_time': datetime.datetime(2019, 2, 11, 1, 21, 27, 165000), 'max_press': '103.0', 'min_press': '100.9', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 11, 1, 21, 27, 165000), 'min_press_time': datetime.datetime(2019, 2, 3, 1, 20, 50, 590000), 'price': '1.0', 'use_volume_work': '6828.0', 'use_volume_std': '6837.0', 'use_money': '6837.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2999', 'remain_money': '2999', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000012处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000073
此查询区间,当前编号下总共抄表记录: 405
此查询区间,上一月最后一天内当前编号下总共抄表记录: 395
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000614'}]
0000000614
00036000000073
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000550')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000614', 'rtu_no': '00030000000116', 'flmeter_no': '00036000000073', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 58, 741358), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 1, 22, 36, 447000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 14, 965000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 1, 22, 36, 447000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 14, 965000), 'max_temperature': '20.2', 'min_temperature': '8.8', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 22, 1, 21, 24, 805000), 'min_temp_time': datetime.datetime(2019, 2, 12, 7, 17, 52, 826000), 'max_press': '103.1', 'min_press': '99.7', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 11, 11, 13, 56, 100000), 'min_press_time': datetime.datetime(2019, 2, 7, 8, 54, 53, 43000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000073处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000043
此查询区间,当前编号下总共抄表记录: 188
此查询区间,上一月最后一天内当前编号下总共抄表记录: 404
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000615'}]
0000000615
00036000000043
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000560')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000615', 'rtu_no': '00030000000084', 'flmeter_no': '00036000000043', 'customer_no': '00030000000035', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 59, 91403), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 21, 31, 50, 778000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 29, 0, 155000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 21, 31, 50, 778000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 29, 0, 155000), 'max_temperature': '8.3', 'min_temperature': '0.6', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 1, 21, 58, 963000), 'min_temp_time': datetime.datetime(2019, 2, 9, 13, 24, 27, 530000), 'max_press': '103.6', 'min_press': '86.9', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 13, 22, 28, 21, 763000), 'min_press_time': datetime.datetime(2019, 2, 22, 2, 22, 10, 14000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '7.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000043处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000062
此查询区间,当前编号下总共抄表记录: 296
此查询区间,上一月最后一天内当前编号下总共抄表记录: 428
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000616'}]
0000000616
00036000000062
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000553')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000616', 'rtu_no': '00030000000104', 'flmeter_no': '00036000000062', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 59, 361386), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 2, 25, 32, 813000), 'min_std_flow_time': datetime.datetime(2019, 2, 1, 12, 25, 40, 840000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 2, 25, 32, 813000), 'min_work_flow_time': datetime.datetime(2019, 2, 1, 12, 25, 40, 840000), 'max_temperature': '17.9', 'min_temperature': '14.2', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 19, 31, 33, 600000), 'min_temp_time': datetime.datetime(2019, 2, 11, 10, 22, 39, 140000), 'max_press': '105.4', 'min_press': '100.1', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 7, 22, 25, 49, 817000), 'min_press_time': datetime.datetime(2019, 2, 28, 15, 29, 25, 199000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 899.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '99', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '10.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000062处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000047
此查询区间,当前编号下总共抄表记录: 70
此查询区间,上一月最后一天内当前编号下总共抄表记录: 428
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000617'}]
0000000617
00036000000047
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000559')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000617', 'rtu_no': '00030000000089', 'flmeter_no': '00036000000047', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 59, 641387), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '12', 'work_sum': '12', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 22, 31, 52, 505000), 'min_std_flow_time': datetime.datetime(2019, 2, 21, 9, 55, 11, 40000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 22, 31, 52, 505000), 'min_work_flow_time': datetime.datetime(2019, 2, 21, 9, 55, 11, 40000), 'max_temperature': '24.8', 'min_temperature': '0.0', 'avg_temperature': '14.0', 'max_temp_time': datetime.datetime(2019, 2, 26, 14, 26, 51, 394000), 'min_temp_time': datetime.datetime(2019, 2, 26, 13, 58, 33, 664000), 'max_press': '102.2', 'min_press': '0.0', 'avg_press': '85.0', 'max_press_time': datetime.datetime(2019, 2, 21, 0, 1, 46, 740000), 'min_press_time': datetime.datetime(2019, 2, 26, 13, 58, 33, 664000), 'price': '1.0', 'use_volume_work': '12.0', 'use_volume_std': '12.0', 'use_money': '12.0', 'sum_total_volume': None, 'sum_total_money': 21.0, 'total_buy_volume': None, 'total_buy_money': '119', 'remain_money': '98', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '85.0', 'press_out': '85.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '6.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000047处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000024
此查询区间,当前编号下总共抄表记录: 209
此查询区间,上一月最后一天内当前编号下总共抄表记录: 440
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000618'}]
0000000618
00036000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000556')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000618', 'rtu_no': None, 'flmeter_no': '00036000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 40, 59, 881412), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '2579974.290', 'work_sum': '695543.720', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 25), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 27), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 25), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 27), 'max_temperature': '13.38', 'min_temperature': '-1.254', 'avg_temperature': '4.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 16, 0, 22), 'min_temp_time': datetime.datetime(2019, 2, 16, 8, 0, 26), 'max_press': '104.997', 'min_press': '100.915', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 28, 16, 0, 22), 'min_press_time': datetime.datetime(2019, 2, 16, 8, 0, 26), 'price': '0.000', 'use_volume_work': '695543.72', 'use_volume_std': '2579974.29', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '4.0', 'temp_out': '4.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000069
此查询区间,当前编号下总共抄表记录: 42
此查询区间,上一月最后一天内当前编号下总共抄表记录: 441
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000619'}]
0000000619
00036000000069
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000555')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000619', 'rtu_no': '00030000000111', 'flmeter_no': '00036000000069', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 0, 151388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 0, 21, 22, 82000), 'min_std_flow_time': datetime.datetime(2019, 1, 10, 17, 57, 25, 731000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 0, 21, 22, 82000), 'min_work_flow_time': datetime.datetime(2019, 1, 10, 17, 57, 25, 731000), 'max_temperature': '20.5', 'min_temperature': '0.0', 'avg_temperature': '1.0', 'max_temp_time': datetime.datetime(2019, 1, 10, 18, 17, 30, 340000), 'min_temp_time': datetime.datetime(2019, 2, 2, 0, 20, 48, 59000), 'max_press': '101.3', 'min_press': '0.0', 'avg_press': '9.0', 'max_press_time': datetime.datetime(2019, 1, 10, 18, 17, 30, 340000), 'min_press_time': datetime.datetime(2019, 2, 2, 0, 20, 48, 59000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '9.0', 'press_out': '9.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '2.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000069处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000054
此查询区间,当前编号下总共抄表记录: 135
此查询区间,上一月最后一天内当前编号下总共抄表记录: 444
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000620'}]
0000000620
00036000000054
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000542')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000620', 'rtu_no': '00030000000096', 'flmeter_no': '00036000000054', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 0, 461388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '4414', 'work_sum': '4238', 'max_std_flow': '11.65', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 6, 16, 34, 55, 273000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 23, 606000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 0, 21, 12, 213000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 0, 21, 23, 606000), 'max_temperature': '23.9', 'min_temperature': '13.2', 'avg_temperature': '20.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 13, 36, 56, 210000), 'min_temp_time': datetime.datetime(2019, 2, 27, 1, 21, 11, 370000), 'max_press': '106.8', 'min_press': '101.1', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 2, 10, 0, 21, 21, 130000), 'min_press_time': datetime.datetime(2019, 2, 27, 13, 23, 49, 637000), 'price': '1.0', 'use_volume_work': '4238.0', 'use_volume_std': '4414.0', 'use_money': '4414.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '6.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000054处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000063
此查询区间,当前编号下总共抄表记录: 455
此查询区间,上一月最后一天内当前编号下总共抄表记录: 445
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000621'}]
0000000621
00036000000063
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000563')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000621', 'rtu_no': '00030000000105', 'flmeter_no': '00036000000063', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 0, 801358), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 26, 22, 43, 16, 52000), 'min_std_flow_time': datetime.datetime(2019, 2, 3, 0, 20, 46, 43000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 26, 22, 43, 16, 52000), 'min_work_flow_time': datetime.datetime(2019, 2, 3, 0, 20, 46, 43000), 'max_temperature': '20.9', 'min_temperature': '8.0', 'avg_temperature': '16.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 13, 36, 58, 491000), 'min_temp_time': datetime.datetime(2019, 2, 12, 0, 21, 8, 852000), 'max_press': '102.9', 'min_press': '90.7', 'avg_press': '99.0', 'max_press_time': datetime.datetime(2019, 2, 11, 0, 21, 11, 148000), 'min_press_time': datetime.datetime(2019, 2, 19, 1, 7, 16, 109000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[电量不足关阀][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[电量不足关阀][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '7.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000063处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000056
此查询区间,当前编号下总共抄表记录: 224
此查询区间,上一月最后一天内当前编号下总共抄表记录: 456
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000622'}]
0000000622
00036000000056
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000566')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000622', 'rtu_no': '00030000000098', 'flmeter_no': '00036000000056', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 1, 111402), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 0, 21, 19, 963000), 'min_std_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 16, 762000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 0, 21, 19, 963000), 'min_work_flow_time': datetime.datetime(2019, 2, 2, 1, 21, 16, 762000), 'max_temperature': '24.4', 'min_temperature': '16.0', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 14, 24, 12, 417000), 'min_temp_time': datetime.datetime(2019, 2, 2, 9, 22, 54, 700000), 'max_press': '103.5', 'min_press': '94.6', 'avg_press': '100.0', 'max_press_time': datetime.datetime(2019, 2, 14, 2, 22, 37, 860000), 'min_press_time': datetime.datetime(2019, 2, 2, 16, 24, 28, 450000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '7.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000056处理好数据已写入oracle
----------------------------------------------------------------------------------------
0800007983
此查询区间,当前编号下总共抄表记录: 358
此查询区间,上一月最后一天内当前编号下总共抄表记录: 487
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000623'}]
0000000623
0800007983
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000583')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000623', 'rtu_no': '00030000000114', 'flmeter_no': '0800007983', 'customer_no': '00030000000047', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 1, 431501), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 19, 30, 252000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 13, 1, 50, 929000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 19, 30, 252000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 13, 1, 50, 929000), 'max_temperature': '20.3', 'min_temperature': '8.9', 'avg_temperature': '12.0', 'max_temp_time': datetime.datetime(2019, 2, 25, 22, 19, 30, 252000), 'min_temp_time': datetime.datetime(2019, 2, 11, 10, 28, 51, 479000), 'max_press': '103.0', 'min_press': '77.4', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 11, 10, 29, 11, 963000), 'min_press_time': datetime.datetime(2019, 2, 2, 8, 51, 3, 778000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '13.0', 'srm_status': '1'}]
insert sys_serial_no ok
0800007983处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000057
此查询区间,当前编号下总共抄表记录: 278
此查询区间,上一月最后一天内当前编号下总共抄表记录: 488
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000624'}]
0000000624
00036000000057
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000538')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000624', 'rtu_no': '00030000000099', 'flmeter_no': '00036000000057', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 1, 711387), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '0.05', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 21, 11, 51, 1, 354000), 'min_std_flow_time': datetime.datetime(2019, 2, 3, 0, 21, 4, 575000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 3, 4, 1, 577000), 'min_work_flow_time': datetime.datetime(2019, 2, 3, 0, 21, 4, 575000), 'max_temperature': '22.1', 'min_temperature': '7.9', 'avg_temperature': '18.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 20, 7, 32, 128000), 'min_temp_time': datetime.datetime(2019, 2, 12, 0, 21, 13, 117000), 'max_press': '105.8', 'min_press': '101.0', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 15, 14, 25, 19, 645000), 'min_press_time': datetime.datetime(2019, 2, 3, 0, 21, 4, 575000), 'price': '1.0', 'use_volume_work': '5.0', 'use_volume_std': '5.0', 'use_money': '5.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000057处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000065
此查询区间,当前编号下总共抄表记录: 231
此查询区间,上一月最后一天内当前编号下总共抄表记录: 490
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000625'}]
0000000625
00036000000065
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000576')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000625', 'rtu_no': '00030000000107', 'flmeter_no': '00036000000065', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 2, 31356), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 3, 23, 27, 929000), 'min_std_flow_time': datetime.datetime(2019, 2, 1, 1, 21, 41, 215000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 3, 23, 27, 929000), 'min_work_flow_time': datetime.datetime(2019, 2, 1, 1, 21, 41, 215000), 'max_temperature': '11.4', 'min_temperature': '9.1', 'avg_temperature': '9.0', 'max_temp_time': datetime.datetime(2019, 2, 7, 1, 20, 35, 495000), 'min_temp_time': datetime.datetime(2019, 2, 17, 8, 28, 38, 703000), 'max_press': '106.7', 'min_press': '101.2', 'avg_press': '103.0', 'max_press_time': datetime.datetime(2019, 2, 27, 9, 25, 45, 918000), 'min_press_time': datetime.datetime(2019, 2, 7, 1, 21, 8, 777000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '12', 'remain_money': '9', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000065处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000053
此查询区间,当前编号下总共抄表记录: 443
此查询区间,上一月最后一天内当前编号下总共抄表记录: 494
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000626'}]
0000000626
00036000000053
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000539')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000626', 'rtu_no': '00030000000095', 'flmeter_no': '00036000000053', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 2, 291354), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 29, 34, 166000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 33, 4, 70000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 29, 34, 166000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 33, 4, 70000), 'max_temperature': '17.9', 'min_temperature': '13.8', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 19, 27, 34, 598000), 'min_temp_time': datetime.datetime(2019, 2, 11, 8, 24, 14, 298000), 'max_press': '103.5', 'min_press': '99.0', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 14, 0, 21, 28, 803000), 'min_press_time': datetime.datetime(2019, 2, 2, 16, 24, 11, 231000), 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '190', 'remain_money': '190', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '23.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000053处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000039
此查询区间,当前编号下总共抄表记录: 8
此查询区间,上一月最后一天内当前编号下总共抄表记录: 494
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000627'}]
0000000627
00036000000039
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000564')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000627', 'rtu_no': '00030000000080', 'flmeter_no': '00036000000039', 'customer_no': '00030000000029', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 2, 561356), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 27, 15, 58, 7, 315000), 'min_std_flow_time': datetime.datetime(2019, 2, 26, 11, 13, 2, 10000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 27, 15, 58, 7, 315000), 'min_work_flow_time': datetime.datetime(2019, 2, 26, 11, 13, 2, 10000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 27, 15, 58, 7, 315000), 'min_temp_time': datetime.datetime(2019, 2, 26, 11, 13, 2, 10000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 27, 15, 58, 7, 315000), 'min_press_time': datetime.datetime(2019, 2, 26, 11, 13, 2, 10000), 'price': '6.52', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '10', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '8.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000039处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000070
此查询区间,当前编号下总共抄表记录: 853
此查询区间,上一月最后一天内当前编号下总共抄表记录: 525
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000628'}]
0000000628
00036000000070
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000537')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000628', 'rtu_no': '00030000000112', 'flmeter_no': '00036000000070', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 2, 821387), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '5', 'work_sum': '5', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 25, 22, 19, 0, 830000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 11, 12, 25, 874000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 25, 22, 19, 0, 830000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 11, 12, 25, 874000), 'max_temperature': '21.5', 'min_temperature': '8.9', 'avg_temperature': '15.0', 'max_temp_time': datetime.datetime(2019, 2, 27, 0, 23, 40, 370000), 'min_temp_time': datetime.datetime(2019, 2, 11, 6, 43, 3, 242000), 'max_press': '108.1', 'min_press': '76.8', 'avg_press': '101.0', 'max_press_time': datetime.datetime(2019, 2, 23, 21, 10, 10, 144000), 'min_press_time': datetime.datetime(2019, 2, 2, 23, 5, 59, 137000), 'price': '1.0', 'use_volume_work': '4.0', 'use_volume_std': '3.0', 'use_money': '3.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '14.0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000070处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000009
此查询区间,当前编号下总共抄表记录: 563
此查询区间,上一月最后一天内当前编号下总共抄表记录: 525
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000629'}]
0000000629
00036000000009
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000565')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000629', 'rtu_no': '00030000000012', 'flmeter_no': '00036000000009', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 3, 131388), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '0', 'work_sum': '0', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 14, 8, 26, 46, 640000), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 37, 31, 23000), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 14, 8, 26, 46, 640000), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 37, 31, 23000), 'max_temperature': '0.0', 'min_temperature': '0.0', 'avg_temperature': '0.0', 'max_temp_time': datetime.datetime(2019, 2, 14, 8, 26, 46, 640000), 'min_temp_time': datetime.datetime(2019, 2, 4, 12, 37, 31, 23000), 'max_press': '0.0', 'min_press': '0.0', 'avg_press': '0.0', 'max_press_time': datetime.datetime(2019, 2, 14, 8, 26, 46, 640000), 'min_press_time': datetime.datetime(2019, 2, 4, 12, 37, 31, 23000), 'price': '1.0', 'use_volume_work': '-1.0', 'use_volume_std': '-2.0', 'use_money': '-2.0', 'sum_total_volume': '19674', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '80376.0', 'remain_volume': '0.0', 'fm_state': '00', 'fm_state_msg': None, 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '81', 'valve_state_msg': '关阀', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000009处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000023
此查询区间,当前编号下总共抄表记录: 209
此查询区间,上一月最后一天内当前编号下总共抄表记录: 537
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_MONTHLY', 'ssn_year': '2019', 'ssn_month': '02'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_MONTHLY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201902月报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '02', 'SSN_VALUE': '0000000630'}]
0000000630
00036000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_MONTHLY where SRM_ORG_ID = :1 and SRM_ID=:2],参数:[('0003', '00032019020000000568')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_MONTHLY (SRM_ORG_ID,SRM_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, STD_SUM,WORK_SUM,MAX_STD_FLOW,MIN_STD_FLOW,AVG_STD_FLOW,MAX_STD_FLOW_TIME,MIN_STD_FLOW_TIME,MAX_WORK_FLOW,MIN_WORK_FLOW,AVG_WORK_FLOW,MAX_WORK_FLOW_TIME,MIN_WORK_FLOW_TIME,MAX_TEMPERATURE,MIN_TEMPERATURE,AVG_TEMPERATURE,MAX_TEMP_TIME,MIN_TEMP_TIME,MAX_PRESS,MIN_PRESS,AVG_PRESS,MAX_PRESS_TIME,MIN_PRESS_TIME,PRICE,USE_VOLUME_WORK,USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI,SRM_STATUS )VALUES(:srm_org_id,:srm_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :std_sum,:work_sum,:max_std_flow,:min_std_flow,:avg_std_flow,:max_std_flow_time,:min_std_flow_time,:max_work_flow,:min_work_flow, :avg_work_flow,:max_work_flow_time,:min_work_flow_time,:max_temperature,:min_temperature,:avg_temperature,:max_temp_time,:min_temp_time,:max_press,:min_press,:avg_press,:max_press_time,:min_press_time,:price,:use_volume_work,:use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srm_status)],参数:[{'srm_org_id': '0003', 'srm_id': '00032019020000000630', 'rtu_no': None, 'flmeter_no': '00036000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 29, 16, 41, 3, 411390), 'year': '2019', 'month': '02', 'day': '', 'std_sum': '187556.770', 'work_sum': '73774.320', 'max_std_flow': '0.0', 'min_std_flow': '0.0', 'avg_std_flow': '0.0', 'max_std_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 24), 'min_std_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 26), 'max_work_flow': '0.0', 'min_work_flow': '0.0', 'avg_work_flow': '0.0', 'max_work_flow_time': datetime.datetime(2019, 2, 28, 18, 0, 24), 'min_work_flow_time': datetime.datetime(2019, 2, 4, 12, 0, 26), 'max_temperature': '14.094', 'min_temperature': '-3.982', 'avg_temperature': '2.0', 'max_temp_time': datetime.datetime(2019, 2, 28, 16, 0, 23), 'min_temp_time': datetime.datetime(2019, 2, 16, 8, 0, 24), 'max_press': '113.329', 'min_press': '100.17', 'avg_press': '102.0', 'max_press_time': datetime.datetime(2019, 2, 28, 16, 0, 23), 'min_press_time': datetime.datetime(2019, 2, 6, 18, 0, 22), 'price': '0.000', 'use_volume_work': '73773.32', 'use_volume_std': '187554.77', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '2.0', 'temp_out': '2.0', 'rssi': '0', 'srm_status': '1'}]
insert sys_serial_no ok
00036000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
0003 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0002
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0002 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0010
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0010 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0018
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0018 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0006
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0006 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0013
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0013 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
此机构: 0014
💗 I am main()
总共抄表数据: 0
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0014 ['2019-02-01 00:00:00', '2019-02-28 23:59:59'] 期间无抄表数据，请等待重新计算月报表
----------------------------------------------------------------------------------------
all done-月报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-03-29 16:40:39.647463
程序运行结束时间: 2019-03-29 16:41:04.411355
整个程序运行总时间: 24 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 3e-07
程序运行结束time.clock(): 24.7641587
整个程序运行总时间time.clock()差: 24.7641584 秒
----------------------------------------------------------------------------------------
