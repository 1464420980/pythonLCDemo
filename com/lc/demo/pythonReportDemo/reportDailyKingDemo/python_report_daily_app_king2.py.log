============================================================================================================================================================分隔符
此机构: 0008
I am main()
总共抄表数据: 20
总共抄表数据: 18
0008 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00086000000008
此查询区间,当前编号下总共抄表记录: 20
此查询区间,上一天当前编号下总共抄表记录: 18
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000020'}]
0000000020
00086000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0008', '00082019030000000019')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0008', 'srd_id': '00082019030000000020', 'rtu_no': '00080000000003', 'flmeter_no': '00086000000008', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 31, 529942), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '100', 'remain_money': '100', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '16.0', 'srd_status': '1'}]
insert sys_serial_no ok
00086000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
0008 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0015
I am main()
总共抄表数据: 0
总共抄表数据: 0
0015 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0017
I am main()
总共抄表数据: 0
总共抄表数据: 0
0017 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0005
I am main()
总共抄表数据: 1866
总共抄表数据: 1237
0005 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 21
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00056000000016
此查询区间,当前编号下总共抄表记录: 142
此查询区间,上一天当前编号下总共抄表记录: 17
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001112'}]
0000001112
00056000000016
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001100')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001112', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 32, 294941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '461101', 'work_sum': '265478', 'std_flow': '4.0', 'work_flow': '5.0', 'temperature': '18.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '116.0', 'use_volume_std': '269.0', 'use_money': '416.95', 'sum_total_volume': '265478', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '37632.79', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000016处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000019
此查询区间,当前编号下总共抄表记录: 37
此查询区间,上一天当前编号下总共抄表记录: 56
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001113'}]
0000001113
00056000000019
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001099')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001113', 'rtu_no': '00050000000016', 'flmeter_no': '00056000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 32, 565943), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '194677', 'work_sum': '179378', 'std_flow': '5.0', 'work_flow': '6.0', 'temperature': '9.0', 'pressure': '89.0', 'price': '2.28', 'use_volume_work': '-85984.0', 'use_volume_std': '-266155.0', 'use_money': '-606833.4', 'sum_total_volume': '179378', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '7045.7', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '89.0', 'press_out': '89.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000019处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 40
此查询区间,上一天当前编号下总共抄表记录: 100
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001114'}]
0000001114
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001108')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001114', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 32, 813942), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '25437', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5464.03', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 25
此查询区间,上一天当前编号下总共抄表记录: 123
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001115'}]
0000001115
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001102')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001115', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 33, 96943), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '4218', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '94.26', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000008
此查询区间,当前编号下总共抄表记录: 154
此查询区间,上一天当前编号下总共抄表记录: 305
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001116'}]
0000001116
00050000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001106')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001116', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 33, 391946), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '23', 'work_sum': '29', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '1.58', 'use_volume_work': '29.0', 'use_volume_std': '23.0', 'use_money': '36.34', 'sum_total_volume': '23', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '500.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00050000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000017
此查询区间,当前编号下总共抄表记录: 141
此查询区间,上一天当前编号下总共抄表记录: 321
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001117'}]
0000001117
00056000000017
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001105')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001117', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 33, 671940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '211076', 'work_sum': '220038', 'std_flow': '17.0', 'work_flow': '20.0', 'temperature': '18.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '220038.0', 'use_volume_std': '211076.0', 'use_money': '327167.8', 'sum_total_volume': '220038', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '28308.55', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000017处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 132
此查询区间,上一天当前编号下总共抄表记录: 338
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001118'}]
0000001118
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001093')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001118', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 33, 940941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '64385', 'work_sum': '69387', 'std_flow': '5.0', 'work_flow': '6.0', 'temperature': '34.0', 'pressure': '98.0', 'price': '1.46', 'use_volume_work': '69387.0', 'use_volume_std': '64385.0', 'use_money': '94002.1', 'sum_total_volume': '64385', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '9212.02', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '34.0', 'temp_out': '34.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 122
此查询区间,上一天当前编号下总共抄表记录: 382
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001119'}]
0000001119
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001104')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001119', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 34, 228944), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '626470', 'work_sum': '626470', 'std_flow': '46.0', 'work_flow': '54.0', 'temperature': '16.0', 'pressure': '84.0', 'price': '1.52', 'use_volume_work': '626470.0', 'use_volume_std': '626470.0', 'use_money': '952234.4', 'sum_total_volume': '626470', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '7680.38', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '84.0', 'press_out': '84.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000006
此查询区间,当前编号下总共抄表记录: 142
此查询区间,上一天当前编号下总共抄表记录: 641
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001120'}]
0000001120
00050000000006
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001111')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001120', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000006', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 34, 501941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '1000', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '1.58', 'use_volume_work': '0.0', 'use_volume_std': '1000.0', 'use_money': '1580.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1700.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00050000000006处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 36
此查询区间,上一天当前编号下总共抄表记录: 682
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001121'}]
0000001121
00056000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001103')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001121', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 34, 751940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '336749', 'work_sum': '173803', 'std_flow': '8.0', 'work_flow': '9.0', 'temperature': '18.0', 'pressure': '93.0', 'price': '1.43', 'use_volume_work': '173803.0', 'use_volume_std': '336749.0', 'use_money': '481551.07', 'sum_total_volume': '173803', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '11048.84', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '93.0', 'press_out': '93.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 40
此查询区间,上一天当前编号下总共抄表记录: 725
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001122'}]
0000001122
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001095')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001122', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 35, 36942), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '3', 'work_sum': '0', 'std_flow': '35.0', 'work_flow': '35.0', 'temperature': '35.0', 'pressure': '101.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '3.0', 'use_money': '6.84', 'sum_total_volume': '94545', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2600.79', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000015
此查询区间,当前编号下总共抄表记录: 141
此查询区间,上一天当前编号下总共抄表记录: 767
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001123'}]
0000001123
00056000000015
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001091')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001123', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000015', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 35, 318941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '336122', 'work_sum': '245089', 'std_flow': '7.0', 'work_flow': '8.0', 'temperature': '17.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '245089.0', 'use_volume_std': '336122.0', 'use_money': '520989.1', 'sum_total_volume': '245089', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '45288.53', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000015处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000018
此查询区间,当前编号下总共抄表记录: 138
此查询区间,上一天当前编号下总共抄表记录: 783
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001124'}]
0000001124
00056000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001101')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001124', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 35, 583939), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '155108', 'work_sum': '155108', 'std_flow': '0.0', 'work_flow': '1.0', 'temperature': '21.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '155108.0', 'use_volume_std': '155108.0', 'use_money': '240417.4', 'sum_total_volume': '155108', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26615.42', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 129
此查询区间,上一天当前编号下总共抄表记录: 828
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001125'}]
0000001125
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001107')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001125', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 35, 873946), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '29933', 'work_sum': '32207', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '32.0', 'pressure': '98.0', 'price': '1.59', 'use_volume_work': '32207.0', 'use_volume_std': '29933.0', 'use_money': '47593.47', 'sum_total_volume': '29933', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '461.6', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '32.0', 'temp_out': '32.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 40
此查询区间,上一天当前编号下总共抄表记录: 875
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001126'}]
0000001126
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001110')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001126', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 36, 120940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '86910', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2682.52', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000007
此查询区间,当前编号下总共抄表记录: 150
此查询区间,上一天当前编号下总共抄表记录: 1064
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001127'}]
0000001127
00050000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001109')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001127', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 36, 394941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '1000', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '1.58', 'use_volume_work': '0.0', 'use_volume_std': '1000.0', 'use_money': '1580.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '305.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00050000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 40
此查询区间,上一天当前编号下总共抄表记录: 1106
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001128'}]
0000001128
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001098')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001128', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 36, 664941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '244662', 'work_sum': '244662', 'std_flow': '16.0', 'work_flow': '19.0', 'temperature': '19.0', 'pressure': '86.0', 'price': '1.43', 'use_volume_work': '244662.0', 'use_volume_std': '244662.0', 'use_money': '349866.66', 'sum_total_volume': '244662', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2074.57', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 28
此查询区间,上一天当前编号下总共抄表记录: 1150
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001129'}]
0000001129
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001092')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001129', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 37, 942), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '123835', 'work_sum': '138622', 'std_flow': '57.0', 'work_flow': '60.0', 'temperature': '22.0', 'pressure': '96.0', 'price': '1.52', 'use_volume_work': '138622.0', 'use_volume_std': '123835.0', 'use_money': '188229.2', 'sum_total_volume': '123835', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '101374.53', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 116
此查询区间,上一天当前编号下总共抄表记录: 1196
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001130'}]
0000001130
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001097')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001130', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 37, 270952), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '5994', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '64.36', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 41
此查询区间,上一天当前编号下总共抄表记录: 1237
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001131'}]
0000001131
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001094')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001131', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 37, 598941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '47674', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13252.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000030
此查询区间,当前编号下总共抄表记录: 32
此查询区间,上一天当前编号下总共抄表记录: 1237
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001132'}]
0000001132
00056000000030
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001096')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001132', 'rtu_no': '00050000000025', 'flmeter_no': '00056000000030', 'customer_no': '00050000000022', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 37, 886941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[表内累计充值金额比IC卡内的累计金额大][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[表内累计充值金额比IC卡内的累计金额大][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '25.0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000030处理好数据已写入oracle
----------------------------------------------------------------------------------------
0005 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0007
I am main()
总共抄表数据: 0
总共抄表数据: 0
0007 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0009
I am main()
总共抄表数据: 0
总共抄表数据: 0
0009 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0011
I am main()
总共抄表数据: 0
总共抄表数据: 0
0011 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0012
I am main()
总共抄表数据: 0
总共抄表数据: 0
0012 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0016
I am main()
总共抄表数据: 24
总共抄表数据: 27
0016 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 2
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00160000000001
此查询区间,当前编号下总共抄表记录: 22
此查询区间,上一天当前编号下总共抄表记录: 24
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000034'}]
0000000034
00160000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0016', '00162019030000000033')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0016', 'srd_id': '00162019030000000034', 'rtu_no': 'FM0000000690', 'flmeter_no': '00160000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 38, 664944), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '69236645.950', 'work_sum': '16252376.440', 'std_flow': '1700.0', 'work_flow': '357.0', 'temperature': '6.0', 'pressure': '455.0', 'price': '0.000', 'use_volume_work': '7678.2599999997765', 'use_volume_std': '36545.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '455.0', 'press_out': '455.0', 'temp_in': '6.0', 'temp_out': '6.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00160000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
00166000000002
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 27
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000035'}]
0000000035
00166000000002
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0016', '00162019030000000032')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0016', 'srd_id': '00162019030000000035', 'rtu_no': '00160000000002', 'flmeter_no': '00166000000002', 'customer_no': '00160000000002', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 38, 978941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '96.0', 'price': '1.0', 'use_volume_work': '-16244698.18', 'use_volume_std': '-69200100.95', 'use_money': '-69200100.95', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '48', 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '19.0', 'srd_status': '1'}]
insert sys_serial_no ok
00166000000002处理好数据已写入oracle
----------------------------------------------------------------------------------------
0016 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0003
I am main()
总共抄表数据: 4714
总共抄表数据: 5224
0003 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 46
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00036000000047
此查询区间,当前编号下总共抄表记录: 17
此查询区间,上一天当前编号下总共抄表记录: 19
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000599'}]
0000000599
00036000000047
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000566')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000599', 'rtu_no': '00030000000089', 'flmeter_no': '00036000000047', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 39, 829972), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '12', 'work_sum': '12', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '8.0', 'pressure': '47.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 21.0, 'total_buy_volume': None, 'total_buy_money': '119', 'remain_money': '98', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '47.0', 'press_out': '47.0', 'temp_in': '8.0', 'temp_out': '8.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000047处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000012
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 21
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000600'}]
0000000600
00036000000012
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000575')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000600', 'rtu_no': '00030000000043', 'flmeter_no': '00036000000012', 'customer_no': '00030000000005', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 40, 136940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '6837', 'work_sum': '6828', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '6816.0', 'use_volume_std': '6825.0', 'use_money': '6825.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2999', 'remain_money': '2999', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000012处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000048
此查询区间,当前编号下总共抄表记录: 17
此查询区间,上一天当前编号下总共抄表记录: 38
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000601'}]
0000000601
00036000000048
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000561')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000601', 'rtu_no': '00030000000090', 'flmeter_no': '00036000000048', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 41, 672940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '-12.0', 'use_volume_std': '-12.0', 'use_money': '-12.0', 'sum_total_volume': None, 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000048处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000066
此查询区间,当前编号下总共抄表记录: 24
此查询区间,上一天当前编号下总共抄表记录: 49
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000602'}]
0000000602
00036000000066
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000565')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000602', 'rtu_no': '00030000000108', 'flmeter_no': '00036000000066', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 42, 440941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '27', 'work_sum': '26', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '105.0', 'price': '1.0', 'use_volume_work': '14.0', 'use_volume_std': '15.0', 'use_money': '15.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000066处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000065
此查询区间,当前编号下总共抄表记录: 23
此查询区间,上一天当前编号下总共抄表记录: 72
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000603'}]
0000000603
00036000000065
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000596')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000603', 'rtu_no': '00030000000107', 'flmeter_no': '00036000000065', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 42, 725940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-12.0', 'use_volume_std': '-12.0', 'use_money': '-12.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '13.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000065处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000073
此查询区间,当前编号下总共抄表记录: 502
此查询区间,上一天当前编号下总共抄表记录: 628
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000604'}]
0000000604
00036000000073
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000578')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000604', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000073', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 43, 16940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '31', 'work_sum': '16', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '31', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26377.18', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000073处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000024
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 640
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000605'}]
0000000605
00036000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000580')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000605', 'rtu_no': 'FM0000000353', 'flmeter_no': '00036000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 43, 294949), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '2579974.290', 'work_sum': '695543.720', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '18.0', 'pressure': '104.0', 'price': '0.000', 'use_volume_work': '695527.72', 'use_volume_std': '2579943.29', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000088
此查询区间,当前编号下总共抄表记录: 21
此查询区间,上一天当前编号下总共抄表记录: 652
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000606'}]
0000000606
00036000000088
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000559')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000606', 'rtu_no': '00030000000128', 'flmeter_no': '00036000000088', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 43, 582942), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '0', 'use_volume_work': '-16.0', 'use_volume_std': '-31.0', 'use_money': '-0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '31.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000088处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000072
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 655
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000607'}]
0000000607
00036000000072
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000553')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000607', 'rtu_no': '00030000000115', 'flmeter_no': '00036000000072', 'customer_no': '00030000000002', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 43, 837941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-16.0', 'use_volume_std': '-31.0', 'use_money': '-31.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000072处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000054
此查询区间,当前编号下总共抄表记录: 109
此查询区间,上一天当前编号下总共抄表记录: 720
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000608'}]
0000000608
00036000000054
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000589')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000608', 'rtu_no': '00030000000096', 'flmeter_no': '00036000000054', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 44, 206940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '19', 'work_sum': '60', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '19.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '44.0', 'use_volume_std': '-12.0', 'use_money': '-12.0', 'sum_total_volume': None, 'sum_total_money': 5.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '94', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '22.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000054处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000061
此查询区间,当前编号下总共抄表记录: 22
此查询区间,上一天当前编号下总共抄表记录: 746
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000609'}]
0000000609
00036000000061
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000590')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000609', 'rtu_no': '00030000000103', 'flmeter_no': '00036000000061', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 44, 481972), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-16.0', 'use_volume_std': '-31.0', 'use_money': '-31.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '16.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000061处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000040
此查询区间,当前编号下总共抄表记录: 76
此查询区间,上一天当前编号下总共抄表记录: 772
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000610'}]
0000000610
00036000000040
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000572')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000610', 'rtu_no': '00030000000081', 'flmeter_no': '00036000000040', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 44, 747940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '-16.0', 'use_volume_std': '-31.0', 'use_money': '-31.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '140', 'remain_money': '140', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '15.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000040处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000069
此查询区间,当前编号下总共抄表记录: 6
此查询区间,上一天当前编号下总共抄表记录: 782
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000611'}]
0000000611
00036000000069
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000592')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000611', 'rtu_no': '00030000000111', 'flmeter_no': '00036000000069', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 45, 130941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '2', 'work_sum': '2', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-14.0', 'use_volume_std': '-29.0', 'use_money': '-29.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '7', 'remain_money': '3', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '24.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000069处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000013
此查询区间,当前编号下总共抄表记录: 501
此查询区间,上一天当前编号下总共抄表记录: 1354
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000612'}]
0000000612
00036000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000583')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000612', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 45, 462942), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '2073', 'work_sum': '173', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '22.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2073', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1949.4', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000067
此查询区间,当前编号下总共抄表记录: 20
此查询区间,上一天当前编号下总共抄表记录: 1363
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000613'}]
0000000613
00036000000067
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000569')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000613', 'rtu_no': '00030000000109', 'flmeter_no': '00036000000067', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 45, 768940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-173.0', 'use_volume_std': '-2073.0', 'use_money': '-2073.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000067处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000058
此查询区间,当前编号下总共抄表记录: 31
此查询区间,上一天当前编号下总共抄表记录: 1399
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000614'}]
0000000614
00036000000058
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000557')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000614', 'rtu_no': '00030000000100', 'flmeter_no': '00036000000058', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 46, 74941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '105.0', 'price': '1.0', 'use_volume_work': '-173.0', 'use_volume_std': '-2073.0', 'use_money': '-2073.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '22.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000058处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000020
此查询区间,当前编号下总共抄表记录: 27
此查询区间,上一天当前编号下总共抄表记录: 1410
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000615'}]
0000000615
00036000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000562')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000615', 'rtu_no': '00030000000051', 'flmeter_no': '00036000000020', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 46, 377946), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '5', 'work_sum': '15', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '20.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-158.0', 'use_volume_std': '-2068.0', 'use_money': '-2068.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[温度异常][压力异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[温度异常][压力异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '94', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000038
此查询区间,当前编号下总共抄表记录: 21
此查询区间,上一天当前编号下总共抄表记录: 1430
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000616'}]
0000000616
00036000000038
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000563')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000616', 'rtu_no': '00030000000079', 'flmeter_no': '00036000000038', 'customer_no': '00030000000016', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 46, 768940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '-173.0', 'use_volume_std': '-2073.0', 'use_money': '-2073.0', 'sum_total_volume': None, 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '4.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000038处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000010
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 1432
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000617'}]
0000000617
00036000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000556')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000617', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 47, 112941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '69208357.950', 'work_sum': '16246420.290', 'std_flow': '2973.0', 'work_flow': '617.0', 'temperature': '2.0', 'pressure': '453.0', 'price': '0.000', 'use_volume_work': '16246247.29', 'use_volume_std': '69206284.95', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '453.0', 'press_out': '453.0', 'temp_in': '2.0', 'temp_out': '2.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000077
此查询区间,当前编号下总共抄表记录: 501
此查询区间,上一天当前编号下总共抄表记录: 1998
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000618'}]
0000000618
00036000000077
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000567')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000618', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000077', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 47, 397940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '9', 'work_sum': '4', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '9', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2526.2', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000077处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000022
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 2010
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000619'}]
0000000619
00036000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000573')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000619', 'rtu_no': 'FM0000000351', 'flmeter_no': '00036000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 47, 710943), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '1548582.120', 'work_sum': '440434.960', 'std_flow': '105.0', 'work_flow': '24.0', 'temperature': '17.0', 'pressure': '428.0', 'price': '0.000', 'use_volume_work': '440430.96', 'use_volume_std': '1548573.12', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '428.0', 'press_out': '428.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000053
此查询区间,当前编号下总共抄表记录: 36
此查询区间,上一天当前编号下总共抄表记录: 2042
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000620'}]
0000000620
00036000000053
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000593')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000620', 'rtu_no': '00030000000095', 'flmeter_no': '00036000000053', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 48, 104955), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '-4.0', 'use_volume_std': '-9.0', 'use_money': '-9.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '8', 'remain_money': '8', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000053处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000062
此查询区间,当前编号下总共抄表记录: 6
此查询区间,上一天当前编号下总共抄表记录: 2046
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000621'}]
0000000621
00036000000062
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000560')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000621', 'rtu_no': '00030000000104', 'flmeter_no': '00036000000062', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 48, 536940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '-4.0', 'use_volume_std': '-9.0', 'use_money': '-9.0', 'sum_total_volume': None, 'sum_total_money': 899.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '99', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '38.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000062处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000064
此查询区间,当前编号下总共抄表记录: 30
此查询区间,上一天当前编号下总共抄表记录: 2079
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000622'}]
0000000622
00036000000064
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000586')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000622', 'rtu_no': '00030000000106', 'flmeter_no': '00036000000064', 'customer_no': '00030000000046', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 48, 869941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '-4.0', 'use_volume_std': '-9.0', 'use_money': '-9.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000064处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000102
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 2079
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000623'}]
0000000623
00036000000102
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000555')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000623', 'rtu_no': '00030000000142', 'flmeter_no': '00036000000102', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 49, 158940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '5', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '0.0', 'pressure': '0.0', 'price': '0', 'use_volume_work': '-4.0', 'use_volume_std': '-4.0', 'use_money': '-0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '0', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000102处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000059
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 2087
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000624'}]
0000000624
00036000000059
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000581')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000624', 'rtu_no': '00030000000101', 'flmeter_no': '00036000000059', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 49, 513941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '2', 'work_sum': '2', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-2.0', 'use_volume_std': '-7.0', 'use_money': '-7.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '19.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000059处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000004
此查询区间,当前编号下总共抄表记录: 503
此查询区间,上一天当前编号下总共抄表记录: 2655
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000625'}]
0000000625
00036000000004
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000584')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000625', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000004', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 49, 923973), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '60364', 'work_sum': '51790', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '60364', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '52000.2', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000004处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000070
此查询区间,当前编号下总共抄表记录: 5
此查询区间,上一天当前编号下总共抄表记录: 2661
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000626'}]
0000000626
00036000000070
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000570')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000626', 'rtu_no': '00030000000112', 'flmeter_no': '00036000000070', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 50, 272940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '19.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-51790.0', 'use_volume_std': '-60364.0', 'use_money': '-60364.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '400', 'remain_money': '400', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '60', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '21.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000070处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000101
此查询区间,当前编号下总共抄表记录: 8
此查询区间,上一天当前编号下总共抄表记录: 2661
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000627'}]
0000000627
00036000000101
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000595')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000627', 'rtu_no': '00030000000141', 'flmeter_no': '00036000000101', 'customer_no': '00030000000068', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 50, 614940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '20.0', 'pressure': '101.0', 'price': '0', 'use_volume_work': '-51790.0', 'use_volume_std': '-60364.0', 'use_money': '-0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '01', 'battery_voltage': None, 'battery_level': '23', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '14.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000101处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000056
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一天当前编号下总共抄表记录: 2663
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000628'}]
0000000628
00036000000056
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000579')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000628', 'rtu_no': '00030000000098', 'flmeter_no': '00036000000056', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 50, 954940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '20.0', 'pressure': '98.0', 'price': '1.0', 'use_volume_work': '-51790.0', 'use_volume_std': '-60364.0', 'use_money': '-60364.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '10.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000056处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000051
此查询区间,当前编号下总共抄表记录: 35
此查询区间,上一天当前编号下总共抄表记录: 2700
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000629'}]
0000000629
00036000000051
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000554')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000629', 'rtu_no': '00030000000093', 'flmeter_no': '00036000000051', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 51, 268940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-51790.0', 'use_volume_std': '-60364.0', 'use_money': '-60364.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '28.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000051处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000089
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 2702
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000630'}]
0000000630
00036000000089
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000591')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000630', 'rtu_no': '00030000000129', 'flmeter_no': '00036000000089', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 51, 677942), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '0.0', 'pressure': '0.0', 'price': '0', 'use_volume_work': '-51790.0', 'use_volume_std': '-60364.0', 'use_money': '-0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '0', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '31.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000089处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000028
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 2714
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000631'}]
0000000631
00036000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000594')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000631', 'rtu_no': 'FM0000000355', 'flmeter_no': '00036000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 51, 984942), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '311644.480', 'work_sum': '287074.660', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '0.000', 'use_volume_work': '235284.65999999997', 'use_volume_std': '251280.47999999998', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000079
此查询区间,当前编号下总共抄表记录: 501
此查询区间,上一天当前编号下总共抄表记录: 3273
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000632'}]
0000000632
00036000000079
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000574')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000632', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000079', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 52, 304941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '11', 'work_sum': '11', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '11', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2427.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000079处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000045
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 3274
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000633'}]
0000000633
00036000000045
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000576')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000633', 'rtu_no': '00030000000086', 'flmeter_no': '00036000000045', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 52, 715941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '37', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000045处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000043
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 3275
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000634'}]
0000000634
00036000000043
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000598')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000634', 'rtu_no': '00030000000084', 'flmeter_no': '00036000000043', 'customer_no': '00030000000035', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 53, 52972), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '10.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000043处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000021
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 3275
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000635'}]
0000000635
00036000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000597')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000635', 'rtu_no': '00030000000055', 'flmeter_no': '00036000000021', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 53, 424940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[表内充值次数比IC卡充值次数多][充值金额过大超出液晶显示范围][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[表内充值次数比IC卡充值次数多][充值金额过大超出液晶显示范围][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '24.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000018
此查询区间,当前编号下总共抄表记录: 20
此查询区间,上一天当前编号下总共抄表记录: 3278
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000636'}]
0000000636
00036000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000577')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000636', 'rtu_no': '00030000000049', 'flmeter_no': '00036000000018', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 53, 880940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '7', 'work_sum': '12', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '20.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '1.0', 'use_volume_std': '-4.0', 'use_money': '-4.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[温度异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[温度异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '85', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '32.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000075
此查询区间,当前编号下总共抄表记录: 503
此查询区间,上一天当前编号下总共抄表记录: 3843
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000637'}]
0000000637
00036000000075
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000582')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000637', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000075', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 54, 214944), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2608.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000075处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000039
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一天当前编号下总共抄表记录: 3853
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000638'}]
0000000638
00036000000039
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000571')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000638', 'rtu_no': '00030000000080', 'flmeter_no': '00036000000039', 'customer_no': '00030000000029', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 54, 547940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '10556', 'remain_money': '10560', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '7.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000039处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 496
此查询区间,上一天当前编号下总共抄表记录: 4567
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000639'}]
0000000639
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000587')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000639', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 54, 972976), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '413', 'work_sum': '420', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '19.0', 'pressure': '100.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '413', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1474.93', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000063
此查询区间,当前编号下总共抄表记录: 27
此查询区间,上一天当前编号下总共抄表记录: 4597
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000640'}]
0000000640
00036000000063
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000588')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000640', 'rtu_no': '00030000000105', 'flmeter_no': '00036000000063', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 55, 292940), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '-420.0', 'use_volume_std': '-413.0', 'use_money': '-413.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '1.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000063处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000023
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 4609
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000641'}]
0000000641
00036000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000564')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000641', 'rtu_no': 'FM0000000352', 'flmeter_no': '00036000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 55, 732950), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '187556.770', 'work_sum': '73774.320', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '19.0', 'pressure': '103.0', 'price': '0.000', 'use_volume_work': '73354.32', 'use_volume_std': '187143.77', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000052
此查询区间,当前编号下总共抄表记录: 8
此查询区间,上一天当前编号下总共抄表记录: 4625
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000642'}]
0000000642
00036000000052
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000585')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000642', 'rtu_no': '00030000000094', 'flmeter_no': '00036000000052', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 56, 120941), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '6039', 'work_sum': '5852', 'std_flow': '3.0', 'work_flow': '0', 'temperature': '24.0', 'pressure': '103.0', 'price': '1.0', 'use_volume_work': '5432.0', 'use_volume_std': '5626.0', 'use_money': '5626.0', 'sum_total_volume': None, 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '5.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000052处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000044
此查询区间,当前编号下总共抄表记录: 23
此查询区间,上一天当前编号下总共抄表记录: 4644
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000643'}]
0000000643
00036000000044
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000568')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000643', 'rtu_no': '00030000000085', 'flmeter_no': '00036000000044', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 56, 520972), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-420.0', 'use_volume_std': '-413.0', 'use_money': '-413.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000044处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000003
此查询区间,当前编号下总共抄表记录: 500
此查询区间,上一天当前编号下总共抄表记录: 5211
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000644'}]
0000000644
00036000000003
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000558')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000644', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000003', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 56, 832945), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '80', 'work_sum': '83', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '100.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '80', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1426.0', 'remain_volume': '0.0', 'fm_state': '10000111', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,低电,阀关,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': '阀关', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000003处理好数据已写入oracle
----------------------------------------------------------------------------------------
0003 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0002
I am main()
总共抄表数据: 0
总共抄表数据: 0
0002 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0010
I am main()
总共抄表数据: 0
总共抄表数据: 0
0010 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0018
I am main()
总共抄表数据: 59
总共抄表数据: 0
0018 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00186000000001
此查询区间,当前编号下总共抄表记录: 59
此查询区间,上一天当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000011'}]
0000000011
00186000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0018', '00182019030000000010')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0018', 'srd_id': '00182019030000000011', 'rtu_no': '00180000000001', 'flmeter_no': '00186000000001', 'customer_no': '00180000000001', 'report_time': datetime.datetime(2019, 3, 28, 16, 11, 57, 534984), 'year': '2019', 'month': '03', 'day': '27', 'hour': '', 'std_sum': '3', 'work_sum': '3', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '88.0', 'price': '1.0', 'use_volume_work': '3.0', 'use_volume_std': '3.0', 'use_money': '3.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '3', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '88.0', 'press_out': '88.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '20.0', 'srd_status': '1'}]
insert sys_serial_no ok
00186000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0018 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0006
I am main()
总共抄表数据: 0
总共抄表数据: 0
0006 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0013
I am main()
总共抄表数据: 0
总共抄表数据: 0
0013 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0014
I am main()
总共抄表数据: 0
总共抄表数据: 0
0014 ['2019-03-27 00:00:00', '2019-03-27 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
all done-日报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-03-28 16:11:31.323940
程序运行结束时间: 2019-03-28 16:11:58.277941
整个程序运行总时间: 26 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 2e-07
程序运行结束time.clock(): 26.9535842
整个程序运行总时间time.clock()差: 26.953584000000003 秒
----------------------------------------------------------------------------------------
============================================================================================================================================================分隔符
此机构: 0008
I am main()
总共抄表数据: 18
总共抄表数据: 24
0008 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00086000000008
此查询区间,当前编号下总共抄表记录: 18
此查询区间,上一天当前编号下总共抄表记录: 24
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000021'}]
0000000021
00086000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0008', '00082019030000000017')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0008', 'srd_id': '00082019030000000021', 'rtu_no': '00080000000003', 'flmeter_no': '00086000000008', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 31, 27972), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '100', 'remain_money': '100', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '21.0', 'srd_status': '1'}]
insert sys_serial_no ok
00086000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
0008 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0015
I am main()
总共抄表数据: 0
总共抄表数据: 0
0015 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0017
I am main()
总共抄表数据: 0
总共抄表数据: 0
0017 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0005
I am main()
总共抄表数据: 1237
总共抄表数据: 1409
0005 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 20
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00050000000006
此查询区间,当前编号下总共抄表记录: 259
此查询区间,上一天当前编号下总共抄表记录: 387
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001133'}]
0000001133
00050000000006
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001052')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001133', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000006', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 31, 793944), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '1000', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.5', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1600.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00050000000006处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 41
此查询区间,上一天当前编号下总共抄表记录: 422
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001134'}]
0000001134
00056000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001068')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001134', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 32, 124942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '336455', 'work_sum': '173685', 'std_flow': '15.0', 'work_flow': '17.0', 'temperature': '18.0', 'pressure': '96.0', 'price': '1.43', 'use_volume_work': '173685.0', 'use_volume_std': '335455.0', 'use_money': '479700.65', 'sum_total_volume': '173685', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '11217.58', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 43
此查询区间,上一天当前编号下总共抄表记录: 462
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001135'}]
0000001135
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001057')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001135', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 32, 401940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '3', 'work_sum': '0', 'std_flow': '35.0', 'work_flow': '35.0', 'temperature': '35.0', 'pressure': '101.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '-997.0', 'use_money': '-2273.16', 'sum_total_volume': '94424', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2876.67', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 44
此查询区间,上一天当前编号下总共抄表记录: 504
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001136'}]
0000001136
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001059')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001136', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 32, 670941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '625760', 'work_sum': '625760', 'std_flow': '11.0', 'work_flow': '13.0', 'temperature': '17.0', 'pressure': '84.0', 'price': '1.52', 'use_volume_work': '625760.0', 'use_volume_std': '624760.0', 'use_money': '949635.2', 'sum_total_volume': '625760', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '8759.58', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '84.0', 'press_out': '84.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 41
此查询区间,上一天当前编号下总共抄表记录: 543
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001137'}]
0000001137
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001061')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001137', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 32, 952973), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '-1000.0', 'use_money': '-2280.0', 'sum_total_volume': '47674', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13252.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 23
此查询区间,上一天当前编号下总共抄表记录: 563
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001138'}]
0000001138
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001058')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001138', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 33, 248940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '-1000.0', 'use_money': '-2280.0', 'sum_total_volume': '4192', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '153.54', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 46
此查询区间,上一天当前编号下总共抄表记录: 604
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001139'}]
0000001139
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001051')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001139', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 33, 526942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '-1000.0', 'use_money': '-1610.0', 'sum_total_volume': '5978', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '90.12', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000015
此查询区间,当前编号下总共抄表记录: 42
此查询区间,上一天当前编号下总共抄表记录: 642
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001140'}]
0000001140
00056000000015
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001060')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001140', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000015', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 33, 842940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '335741', 'work_sum': '244926', 'std_flow': '11.0', 'work_flow': '12.0', 'temperature': '16.0', 'pressure': '79.0', 'price': '1.55', 'use_volume_work': '244926.0', 'use_volume_std': '334741.0', 'use_money': '518848.55', 'sum_total_volume': '244926', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '45541.18', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '79.0', 'press_out': '79.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000015处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 47
此查询区间,上一天当前编号下总共抄表记录: 683
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001141'}]
0000001141
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001064')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001141', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 34, 101973), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '-1000.0', 'use_money': '-2280.0', 'sum_total_volume': '86818', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2892.28', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 42
此查询区间,上一天当前编号下总共抄表记录: 723
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001142'}]
0000001142
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001053')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001142', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 34, 361942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '244122', 'work_sum': '244122', 'std_flow': '15.0', 'work_flow': '18.0', 'temperature': '19.0', 'pressure': '86.0', 'price': '1.43', 'use_volume_work': '244122.0', 'use_volume_std': '243122.0', 'use_money': '347664.46', 'sum_total_volume': '244122', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2846.77', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000008
此查询区间,当前编号下总共抄表记录: 182
此查询区间,上一天当前编号下总共抄表记录: 982
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001143'}]
0000001143
00050000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001065')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001143', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 34, 658966), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '23', 'work_sum': '29', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.58', 'use_volume_work': '29.0', 'use_volume_std': '-977.0', 'use_money': '-2520.66', 'sum_total_volume': '23', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '400.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00050000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000016
此查询区间,当前编号下总共抄表记录: 17
此查询区间,上一天当前编号下总共抄表记录: 982
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001144'}]
0000001144
00056000000016
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001066')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001144', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 34, 917954), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '460832', 'work_sum': '265362', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '18.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '265362.0', 'use_volume_std': '459832.0', 'use_money': '712739.6', 'sum_total_volume': '265362', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '37812.59', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000016处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000017
此查询区间,当前编号下总共抄表记录: 16
此查询区间,上一天当前编号下总共抄表记录: 982
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001145'}]
0000001145
00056000000017
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001050')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001145', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 35, 170940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '210260', 'work_sum': '219695', 'std_flow': '10.0', 'work_flow': '12.0', 'temperature': '18.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '219695.0', 'use_volume_std': '209260.0', 'use_money': '324353.0', 'sum_total_volume': '219695', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '28840.2', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000017处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 44
此查询区间,上一天当前编号下总共抄表记录: 1022
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001146'}]
0000001146
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001069')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001146', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 35, 428945), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '-1000.0', 'use_money': '-1610.0', 'sum_total_volume': '25372', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5568.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 45
此查询区间,上一天当前编号下总共抄表记录: 1059
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001147'}]
0000001147
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001067')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001147', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 35, 676954), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '29933', 'work_sum': '32207', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '31.0', 'pressure': '98.0', 'price': '1.59', 'use_volume_work': '32207.0', 'use_volume_std': '28933.0', 'use_money': '46003.47', 'sum_total_volume': '29933', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '461.6', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '31.0', 'temp_out': '31.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000019
此查询区间,当前编号下总共抄表记录: 39
此查询区间,上一天当前编号下总共抄表记录: 1098
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001148'}]
0000001148
00056000000019
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001062')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001148', 'rtu_no': '00050000000016', 'flmeter_no': '00056000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 35, 970972), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '194474', 'work_sum': '179299', 'std_flow': '2.0', 'work_flow': '2.0', 'temperature': '9.0', 'pressure': '87.0', 'price': '2.28', 'use_volume_work': '179299.0', 'use_volume_std': '193474.0', 'use_money': '441120.72', 'sum_total_volume': '179299', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '7225.82', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '87.0', 'press_out': '87.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000019处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 44
此查询区间,上一天当前编号下总共抄表记录: 1136
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001149'}]
0000001149
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001056')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001149', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 36, 241940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '123051', 'work_sum': '137793', 'std_flow': '46.0', 'work_flow': '49.0', 'temperature': '22.0', 'pressure': '96.0', 'price': '1.52', 'use_volume_work': '1698.0', 'use_volume_std': '1592.0', 'use_money': '2419.84', 'sum_total_volume': '123051', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '102566.21', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000018
此查询区间,当前编号下总共抄表记录: 16
此查询区间,上一天当前编号下总共抄表记录: 1136
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001150'}]
0000001150
00056000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001063')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001150', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 36, 478953), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '154993', 'work_sum': '154993', 'std_flow': '10.0', 'work_flow': '12.0', 'temperature': '19.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '18898.0', 'use_volume_std': '33534.0', 'use_money': '51977.7', 'sum_total_volume': '154993', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26793.67', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000007
此查询区间,当前编号下总共抄表记录: 189
此查询区间,上一天当前编号下总共抄表记录: 1409
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001151'}]
0000001151
00050000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001055')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001151', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 36, 724941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '1000', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.58', 'use_volume_work': '-136095.0', 'use_volume_std': '-120459.0', 'use_money': '-310784.22', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '205.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00050000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 17
此查询区间,上一天当前编号下总共抄表记录: 1409
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000001152'}]
0000001152
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019030000001054')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019030000001152', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 37, 54942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '64053', 'work_sum': '69027', 'std_flow': '6.0', 'work_flow': '6.0', 'temperature': '34.0', 'pressure': '97.0', 'price': '1.46', 'use_volume_work': '-67068.0', 'use_volume_std': '-57406.0', 'use_money': '-83812.76', 'sum_total_volume': '64053', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '9696.74', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '97.0', 'press_out': '97.0', 'temp_in': '34.0', 'temp_out': '34.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
0005 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0007
I am main()
总共抄表数据: 0
总共抄表数据: 0
0007 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0009
I am main()
总共抄表数据: 0
总共抄表数据: 0
0009 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0011
I am main()
总共抄表数据: 0
总共抄表数据: 0
0011 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0012
I am main()
总共抄表数据: 0
总共抄表数据: 0
0012 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0016
I am main()
总共抄表数据: 27
总共抄表数据: 25
0016 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 2
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00166000000002
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000036'}]
0000000036
00166000000002
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0016', '00162019030000000029')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0016', 'srd_id': '00162019030000000036', 'rtu_no': '00160000000002', 'flmeter_no': '00166000000002', 'customer_no': '00160000000002', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 37, 838098), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '96.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '4b', 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '15.0', 'srd_status': '1'}]
insert sys_serial_no ok
00166000000002处理好数据已写入oracle
----------------------------------------------------------------------------------------
00160000000001
此查询区间,当前编号下总共抄表记录: 24
此查询区间,上一天当前编号下总共抄表记录: 25
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000037'}]
0000000037
00160000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0016', '00162019030000000028')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0016', 'srd_id': '00162019030000000037', 'rtu_no': 'FM0000000690', 'flmeter_no': '00160000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 38, 141940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '69200100.950', 'work_sum': '16244698.180', 'std_flow': '1608.0', 'work_flow': '336.0', 'temperature': '5.0', 'pressure': '456.0', 'price': '0.000', 'use_volume_work': '8164.359999999404', 'use_volume_std': '38983.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '456.0', 'press_out': '456.0', 'temp_in': '5.0', 'temp_out': '5.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00160000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0016 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0003
I am main()
总共抄表数据: 5224
总共抄表数据: 2815
0003 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 45
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00036000000038
此查询区间,当前编号下总共抄表记录: 20
此查询区间,上一天当前编号下总共抄表记录: 25
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000645'}]
0000000645
00036000000038
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000489')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000645', 'rtu_no': '00030000000079', 'flmeter_no': '00036000000038', 'customer_no': '00030000000016', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 38, 887942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '9.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000038处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000054
此查询区间,当前编号下总共抄表记录: 65
此查询区间,上一天当前编号下总共抄表记录: 90
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000646'}]
0000000646
00036000000054
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000477')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000646', 'rtu_no': '00030000000096', 'flmeter_no': '00036000000054', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 39, 152945), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '2', 'work_sum': '2', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '100.0', 'price': '2.5', 'use_volume_work': '2.0', 'use_volume_std': '2.0', 'use_money': '5.0', 'sum_total_volume': None, 'sum_total_money': 5.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[用户身份编号出错][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[用户身份编号出错][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '16.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000054处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000018
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 95
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000647'}]
0000000647
00036000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000499')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000647', 'rtu_no': '00030000000049', 'flmeter_no': '00036000000018', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 39, 418941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '1667.0', 'pressure': '46.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[温度异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[温度异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '56', 'press_in': '46.0', 'press_out': '46.0', 'temp_in': '1667.0', 'temp_out': '1667.0', 'rssi': '30.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000012
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 96
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000648'}]
0000000648
00036000000012
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000472')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000648', 'rtu_no': '00030000000043', 'flmeter_no': '00036000000012', 'customer_no': '00030000000005', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 39, 729974), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '6837', 'work_sum': '6828', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '6828.0', 'use_volume_std': '6837.0', 'use_money': '6837.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2999', 'remain_money': '2999', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '19.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000012处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000069
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一天当前编号下总共抄表记录: 101
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000649'}]
0000000649
00036000000069
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000490')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000649', 'rtu_no': '00030000000111', 'flmeter_no': '00036000000069', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 40, 26944), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '2', 'work_sum': '2', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '98.0', 'price': '1.0', 'use_volume_work': '2.0', 'use_volume_std': '2.0', 'use_money': '2.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '7', 'remain_money': '3', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '7.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000069处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000073
此查询区间,当前编号下总共抄表记录: 556
此查询区间,上一天当前编号下总共抄表记录: 316
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000650'}]
0000000650
00036000000073
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000500')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000650', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000073', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 40, 314941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '31', 'work_sum': '16', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '31', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26177.18', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000073处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000013
此查询区间,当前编号下总共抄表记录: 572
此查询区间,上一天当前编号下总共抄表记录: 641
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000651'}]
0000000651
00036000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000506')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000651', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 40, 631965), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '2073', 'work_sum': '173', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '22.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2073', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1749.4', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000020
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 650
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000652'}]
0000000652
00036000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000498')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000652', 'rtu_no': '00030000000051', 'flmeter_no': '00036000000020', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 40, 935972), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '92.0', 'price': '0', 'use_volume_work': '-173.0', 'use_volume_std': '-2073.0', 'use_money': '-0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '92.0', 'press_out': '92.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '25.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000044
此查询区间,当前编号下总共抄表记录: 19
此查询区间,上一天当前编号下总共抄表记录: 670
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000653'}]
0000000653
00036000000044
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000502')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000653', 'rtu_no': '00030000000085', 'flmeter_no': '00036000000044', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 41, 197941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-173.0', 'use_volume_std': '-2073.0', 'use_money': '-2073.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000044处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000047
此查询区间,当前编号下总共抄表记录: 19
此查询区间,上一天当前编号下总共抄表记录: 687
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000654'}]
0000000654
00036000000047
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000470')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000654', 'rtu_no': '00030000000089', 'flmeter_no': '00036000000047', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 41, 505941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '12', 'work_sum': '12', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '9.0', 'pressure': '63.0', 'price': '1.0', 'use_volume_work': '-161.0', 'use_volume_std': '-2061.0', 'use_money': '-2061.0', 'sum_total_volume': None, 'sum_total_money': 21.0, 'total_buy_volume': None, 'total_buy_money': '119', 'remain_money': '98', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '63.0', 'press_out': '63.0', 'temp_in': '9.0', 'temp_out': '9.0', 'rssi': '1.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000047处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000070
此查询区间,当前编号下总共抄表记录: 6
此查询区间,上一天当前编号下总共抄表记录: 700
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000655'}]
0000000655
00036000000070
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000478')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000655', 'rtu_no': '00030000000112', 'flmeter_no': '00036000000070', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 41, 806972), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '20.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-173.0', 'use_volume_std': '-2073.0', 'use_money': '-2073.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '300', 'remain_money': '300', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '40', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '14.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000070处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000079
此查询区间,当前编号下总共抄表记录: 559
此查询区间,上一天当前编号下总共抄表记录: 1021
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000656'}]
0000000656
00036000000079
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000471')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000656', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000079', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 42, 142943), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '11', 'work_sum': '11', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '11', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2227.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000079处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000067
此查询区间,当前编号下总共抄表记录: 9
此查询区间,上一天当前编号下总共抄表记录: 1024
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000657'}]
0000000657
00036000000067
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000484')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000657', 'rtu_no': '00030000000109', 'flmeter_no': '00036000000067', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 42, 427941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000067处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000056
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 1031
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000658'}]
0000000658
00036000000056
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000465')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000658', 'rtu_no': '00030000000098', 'flmeter_no': '00036000000056', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 42, 696942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '21.0', 'pressure': '98.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '7.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000056处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000024
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一天当前编号下总共抄表记录: 1043
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000659'}]
0000000659
00036000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000503')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000659', 'rtu_no': 'FM0000000353', 'flmeter_no': '00036000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 43, 941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '2579974.290', 'work_sum': '695543.720', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '16.0', 'pressure': '103.0', 'price': '0.000', 'use_volume_work': '695532.72', 'use_volume_std': '2579963.29', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000028
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一天当前编号下总共抄表记录: 1055
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000660'}]
0000000660
00036000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000481')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000660', 'rtu_no': 'FM0000000355', 'flmeter_no': '00036000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 43, 345972), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '311644.480', 'work_sum': '287074.660', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '0.000', 'use_volume_work': '287063.66', 'use_volume_std': '311633.48', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000061
此查询区间,当前编号下总共抄表记录: 26
此查询区间,上一天当前编号下总共抄表记录: 1080
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000661'}]
0000000661
00036000000061
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000464')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000661', 'rtu_no': '00030000000103', 'flmeter_no': '00036000000061', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 43, 650940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '16.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000061处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000052
此查询区间,当前编号下总共抄表记录: 16
此查询区间,上一天当前编号下总共抄表记录: 1100
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000662'}]
0000000662
00036000000052
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000475')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000662', 'rtu_no': '00030000000094', 'flmeter_no': '00036000000052', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 43, 946939), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '6009', 'work_sum': '5822', 'std_flow': '3.0', 'work_flow': '0', 'temperature': '23.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '5811.0', 'use_volume_std': '5998.0', 'use_money': '5998.0', 'sum_total_volume': None, 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '2.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000052处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000039
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一天当前编号下总共抄表记录: 1115
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000663'}]
0000000663
00036000000039
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000462')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000663', 'rtu_no': '00030000000080', 'flmeter_no': '00036000000039', 'customer_no': '00030000000029', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 44, 260942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.5', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-27.5', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '10556', 'remain_money': '10556', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '11.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000039处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000080
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 1115
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000664'}]
0000000664
00036000000080
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000468')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000664', 'rtu_no': '00030000000120', 'flmeter_no': '00036000000080', 'customer_no': '00030000000050', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 44, 601940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.5', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-27.5', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2200', 'remain_money': '2200', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[用户身份编号出错][电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[用户身份编号出错][电量不足关阀][温度异常][压力异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '1.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000080处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000064
此查询区间,当前编号下总共抄表记录: 33
此查询区间,上一天当前编号下总共抄表记录: 1145
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000665'}]
0000000665
00036000000064
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000487')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000665', 'rtu_no': '00030000000106', 'flmeter_no': '00036000000064', 'customer_no': '00030000000046', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 44, 848943), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '103.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '13.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000064处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000022
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一天当前编号下总共抄表记录: 1157
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000666'}]
0000000666
00036000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000501')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000666', 'rtu_no': 'FM0000000351', 'flmeter_no': '00036000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 45, 118943), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '1546129.360', 'work_sum': '439862.420', 'std_flow': '118.0', 'work_flow': '27.0', 'temperature': '16.0', 'pressure': '427.0', 'price': '0.000', 'use_volume_work': '439851.42', 'use_volume_std': '1546118.36', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '427.0', 'press_out': '427.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000072
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 1159
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000667'}]
0000000667
00036000000072
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000482')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000667', 'rtu_no': '00030000000115', 'flmeter_no': '00036000000072', 'customer_no': '00030000000002', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 45, 405942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000072处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000066
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 1173
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000668'}]
0000000668
00036000000066
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000493')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000668', 'rtu_no': '00030000000108', 'flmeter_no': '00036000000066', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 45, 704940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '21', 'work_sum': '20', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '105.0', 'price': '1.0', 'use_volume_work': '9.0', 'use_volume_std': '10.0', 'use_money': '10.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000066处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000063
此查询区间,当前编号下总共抄表记录: 30
此查询区间,上一天当前编号下总共抄表记录: 1204
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000669'}]
0000000669
00036000000063
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000469')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000669', 'rtu_no': '00030000000105', 'flmeter_no': '00036000000063', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 46, 85940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '2.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000063处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000045
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 1206
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000670'}]
0000000670
00036000000045
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000486')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000670', 'rtu_no': '00030000000086', 'flmeter_no': '00036000000045', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 46, 441942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '-11.0', 'use_volume_std': '-11.0', 'use_money': '-11.0', 'sum_total_volume': None, 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '37', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000045处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000003
此查询区间,当前编号下总共抄表记录: 567
此查询区间,上一天当前编号下总共抄表记录: 1627
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000671'}]
0000000671
00036000000003
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000466')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000671', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000003', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 46, 719941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '80', 'work_sum': '83', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '80', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1226.0', 'remain_volume': '0.0', 'fm_state': '10000111', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,低电,阀关,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': '阀关', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000003处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000004
此查询区间,当前编号下总共抄表记录: 568
此查询区间,上一天当前编号下总共抄表记录: 1868
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000672'}]
0000000672
00036000000004
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000479')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000672', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000004', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 47, 112943), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '60364', 'work_sum': '51790', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '60364', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '51800.2', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000004处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000089
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 1869
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000673'}]
0000000673
00036000000089
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000505')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000673', 'rtu_no': '00030000000129', 'flmeter_no': '00036000000089', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 47, 397941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '0.0', 'pressure': '0.0', 'price': '0', 'use_volume_work': '-51790.0', 'use_volume_std': '-60364.0', 'use_money': '-0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '5f', 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '31.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000089处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000062
此查询区间,当前编号下总共抄表记录: 4
此查询区间,上一天当前编号下总共抄表记录: 1871
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000674'}]
0000000674
00036000000062
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000491')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000674', 'rtu_no': '00030000000104', 'flmeter_no': '00036000000062', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 47, 695942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-51790.0', 'use_volume_std': '-60364.0', 'use_money': '-60364.0', 'sum_total_volume': None, 'sum_total_money': 899.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '99', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '39.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000062处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000043
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 1878
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000675'}]
0000000675
00036000000043
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000485')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000675', 'rtu_no': '00030000000084', 'flmeter_no': '00036000000043', 'customer_no': '00030000000035', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 48, 37966), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '13.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-51790.0', 'use_volume_std': '-60364.0', 'use_money': '-60364.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '10.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000043处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000077
此查询区间,当前编号下总共抄表记录: 566
此查询区间,上一天当前编号下总共抄表记录: 2010
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000676'}]
0000000676
00036000000077
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000504')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000676', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000077', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 48, 352967), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '9', 'work_sum': '4', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '9', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2326.2', 'remain_volume': '0.0', 'fm_state': '10000111', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,低电,阀关,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': '阀关', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000077处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000075
此查询区间,当前编号下总共抄表记录: 565
此查询区间,上一天当前编号下总共抄表记录: 2249
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000677'}]
0000000677
00036000000075
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000473')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000677', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000075', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 48, 646942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2408.0', 'remain_volume': '0.0', 'fm_state': '10000111', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,低电,阀关,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '1', 'valve_state_msg': '阀关', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000075处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000053
此查询区间,当前编号下总共抄表记录: 32
此查询区间,上一天当前编号下总共抄表记录: 2301
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000678'}]
0000000678
00036000000053
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000488')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000678', 'rtu_no': '00030000000095', 'flmeter_no': '00036000000053', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 48, 968941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '8', 'remain_money': '8', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '38.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000053处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000065
此查询区间,当前编号下总共抄表记录: 23
此查询区间,上一天当前编号下总共抄表记录: 2327
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000679'}]
0000000679
00036000000065
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000474')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000679', 'rtu_no': '00030000000107', 'flmeter_no': '00036000000065', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 49, 309941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '14.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000065处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000059
此查询区间,当前编号下总共抄表记录: 8
此查询区间,上一天当前编号下总共抄表记录: 2351
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000680'}]
0000000680
00036000000059
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000480')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000680', 'rtu_no': '00030000000101', 'flmeter_no': '00036000000059', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 49, 656942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '2', 'work_sum': '2', 'std_flow': '4.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '2.0', 'use_volume_std': '2.0', 'use_money': '2.0', 'sum_total_volume': None, 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000059处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000088
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一天当前编号下总共抄表记录: 2351
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000681'}]
0000000681
00036000000088
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000497')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000681', 'rtu_no': '00030000000128', 'flmeter_no': '00036000000088', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 50, 62942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '31.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000088处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000051
此查询区间,当前编号下总共抄表记录: 37
此查询区间,上一天当前编号下总共抄表记录: 2384
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000682'}]
0000000682
00036000000051
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000494')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000682', 'rtu_no': '00030000000093', 'flmeter_no': '00036000000051', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 50, 391943), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '14.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000051处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000048
此查询区间,当前编号下总共抄表记录: 17
此查询区间,上一天当前编号下总共抄表记录: 2403
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000683'}]
0000000683
00036000000048
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000476')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000683', 'rtu_no': '00030000000090', 'flmeter_no': '00036000000048', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 50, 749940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '23.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000048处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000058
此查询区间,当前编号下总共抄表记录: 36
此查询区间,上一天当前编号下总共抄表记录: 2440
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000684'}]
0000000684
00036000000058
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000495')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000684', 'rtu_no': '00030000000100', 'flmeter_no': '00036000000058', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 51, 134941), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '104.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '25.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000058处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 714
此查询区间,上一天当前编号下总共抄表记录: 2774
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000685'}]
0000000685
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000467')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000685', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 51, 486967), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '413', 'work_sum': '420', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '18.0', 'pressure': '100.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '413', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1274.93', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000023
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一天当前编号下总共抄表记录: 2786
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000686'}]
0000000686
00036000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000496')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000686', 'rtu_no': 'FM0000000352', 'flmeter_no': '00036000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 51, 862940), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '187556.770', 'work_sum': '73774.320', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '16.0', 'pressure': '103.0', 'price': '0.000', 'use_volume_work': '73354.32', 'use_volume_std': '187143.77', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000040
此查询区间,当前编号下总共抄表记录: 26
此查询区间,上一天当前编号下总共抄表记录: 2811
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000687'}]
0000000687
00036000000040
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000492')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000687', 'rtu_no': '00030000000081', 'flmeter_no': '00036000000040', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 52, 163942), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '2', 'work_sum': '2', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '-418.0', 'use_volume_std': '-411.0', 'use_money': '-411.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '1', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '3.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000040处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000010
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 2813
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000688'}]
0000000688
00036000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000483')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000688', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 52, 481956), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '69170490.950', 'work_sum': '16238464.100', 'std_flow': '2990.0', 'work_flow': '614.0', 'temperature': '-1.0', 'pressure': '454.0', 'price': '0.000', 'use_volume_work': '16238044.1', 'use_volume_std': '69170077.95', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '454.0', 'press_out': '454.0', 'temp_in': '-1.0', 'temp_out': '-1.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000068
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 2814
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '03'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201903日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '03', 'SSN_VALUE': '0000000689'}]
0000000689
00036000000068
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019030000000463')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019030000000689', 'rtu_no': '00030000000110', 'flmeter_no': '00036000000068', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 3, 28, 16, 12, 52, 886969), 'year': '2019', 'month': '03', 'day': '26', 'hour': '', 'std_sum': '2', 'work_sum': '2', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '19.0', 'pressure': '105.0', 'price': '1.0', 'use_volume_work': '-418.0', 'use_volume_std': '-411.0', 'use_money': '-411.0', 'sum_total_volume': None, 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[电量不足关阀][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[电量不足关阀][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '64', 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '56.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000068处理好数据已写入oracle
----------------------------------------------------------------------------------------
0003 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0002
I am main()
总共抄表数据: 0
总共抄表数据: 0
0002 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0010
I am main()
总共抄表数据: 0
总共抄表数据: 0
0010 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0018
I am main()
总共抄表数据: 0
总共抄表数据: 25
0018 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0006
I am main()
总共抄表数据: 0
总共抄表数据: 0
0006 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0013
I am main()
总共抄表数据: 0
总共抄表数据: 0
0013 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0014
I am main()
总共抄表数据: 0
总共抄表数据: 0
0014 ['2019-03-26 00:00:00', '2019-03-26 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
all done-日报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-03-28 16:12:30.842946
程序运行结束时间: 2019-03-28 16:12:53.916945
整个程序运行总时间: 23 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 3e-07
程序运行结束time.clock(): 23.0739137
整个程序运行总时间time.clock()差: 23.0739134 秒
----------------------------------------------------------------------------------------
============================================================================================================================================================分隔符
此机构: 0008
I am main()
总共抄表数据: 15
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 21
0008 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00086000000008
此查询区间,当前编号下总共抄表记录: 15
此查询区间,上一天当前编号下总共抄表记录: 21
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000015'}]
0000000015
00086000000008 ☆ sum_total_volume is None 置为0
00086000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0008', '00082019040000000014')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0008', 'srd_id': '00082019040000000015', 'rtu_no': '00080000000003', 'flmeter_no': '00086000000008', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 43, 807695), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '100', 'remain_money': '100', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '26.0', 'srd_status': '1'}]
insert sys_serial_no ok
00086000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
0008 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0015
I am main()
总共抄表数据: 3
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0015 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00156000000001
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0015', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0015', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000010'}]
0000000010
00156000000001 ☆ sum_total_volume is None 置为0
00156000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0015', '00152019040000000009')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0015', 'srd_id': '00152019040000000010', 'rtu_no': '00150000000001', 'flmeter_no': '00156000000001', 'customer_no': '00150000000001', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 44, 194700), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '96.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 15.0, 'total_buy_volume': None, 'total_buy_money': '20', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '56.0', 'srd_status': '1'}]
insert sys_serial_no ok
00156000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0015 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0017
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0017 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0005
I am main()
总共抄表数据: 3555
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 6464
0005 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 21
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 158
此查询区间,上一天当前编号下总共抄表记录: 286
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000218'}]
0000000218
00056000000024 ☆ sum_total_money <0 置为0
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000211')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000218', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 45, 168695), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '248598', 'work_sum': '248598', 'std_flow': '17.0', 'work_flow': '20.0', 'temperature': '20.0', 'pressure': '86.0', 'price': '1.43', 'use_volume_work': '275.0', 'use_volume_std': '275.0', 'use_money': '393.25', 'sum_total_volume': '248598', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '3599.62', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000026
此查询区间,当前编号下总共抄表记录: 161
此查询区间,上一天当前编号下总共抄表记录: 581
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000219'}]
0000000219
00056000000026 ☆ use_volume_work <0 置为0
00056000000026 ☆ use_volume_std <0 置为0
00056000000026 ☆ sum_total_money <0 置为0
00056000000026
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000206')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000219', 'rtu_no': '00050000000021', 'flmeter_no': '00056000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 45, 456727), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '9816', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2447.86', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000026处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 159
此查询区间,上一天当前编号下总共抄表记录: 870
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000220'}]
0000000220
00056000000013 ☆ use_volume_work <0 置为0
00056000000013 ☆ use_volume_std <0 置为0
00056000000013 ☆ sum_total_money <0 置为0
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000214')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000220', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 45, 738711), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '3', 'work_sum': '0', 'std_flow': '35.0', 'work_flow': '35.0', 'temperature': '35.0', 'pressure': '101.0', 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '95713', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '11337.75', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000018
此查询区间,当前编号下总共抄表记录: 176
此查询区间,上一天当前编号下总共抄表记录: 1221
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000221'}]
0000000221
00056000000018 ☆ sum_total_money <0 置为0
00056000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000197')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000221', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 46, 27697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '156125', 'work_sum': '156125', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '21.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '2.0', 'use_volume_std': '2.0', 'use_money': '3.1', 'sum_total_volume': '156125', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '25039.07', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 178
此查询区间,上一天当前编号下总共抄表记录: 1501
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000222'}]
0000000222
00056000000023 ☆ sum_total_money <0 置为0
00056000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000204')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000222', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 46, 296727), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '340680', 'work_sum': '175354', 'std_flow': '10.0', 'work_flow': '11.0', 'temperature': '19.0', 'pressure': '96.0', 'price': '1.43', 'use_volume_work': '108.0', 'use_volume_std': '108.0', 'use_money': '154.44', 'sum_total_volume': '175354', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '8830.91', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 158
此查询区间,上一天当前编号下总共抄表记录: 1791
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000223'}]
0000000223
00056000000020 ☆ sum_total_money <0 置为0
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000217')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000223', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 46, 583726), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '29933', 'work_sum': '32207', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '32.0', 'pressure': '99.0', 'price': '1.59', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '29933', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '461.6', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '32.0', 'temp_out': '32.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 159
此查询区间,上一天当前编号下总共抄表记录: 2087
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000224'}]
0000000224
00056000000027 ☆ sum_total_money <0 置为0
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000205')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000224', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 46, 852725), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '36.0', 'use_money': '82.08', 'sum_total_volume': '87826', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '594.04', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 157
此查询区间,上一天当前编号下总共抄表记录: 2380
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000225'}]
0000000225
00056000000029 ☆ use_volume_std <0 置为0
00056000000029 ☆ sum_total_money <0 置为0
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000215')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000225', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 47, 121726), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '25762', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '7838.78', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 158
此查询区间,上一天当前编号下总共抄表记录: 2669
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000226'}]
0000000226
00056000000021 ☆ sum_total_money <0 置为0
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000198')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000226', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 47, 386696), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '66504', 'work_sum': '71687', 'std_flow': '15.0', 'work_flow': '17.0', 'temperature': '32.0', 'pressure': '98.0', 'price': '1.46', 'use_volume_work': '242.0', 'use_volume_std': '224.0', 'use_money': '327.04', 'sum_total_volume': '66504', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '26118.28', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '32.0', 'temp_out': '32.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000016
此查询区间,当前编号下总共抄表记录: 176
此查询区间,上一天当前编号下总共抄表记录: 3030
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000227'}]
0000000227
00056000000016 ☆ sum_total_money <0 置为0
00056000000016
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000199')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000227', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 47, 728727), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '463780', 'work_sum': '266612', 'std_flow': '6.0', 'work_flow': '7.0', 'temperature': '18.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '195167.0', 'use_volume_std': '200332.0', 'use_money': '310514.6', 'sum_total_volume': '266612', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '35875.09', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000016处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000017
此查询区间,当前编号下总共抄表记录: 176
此查询区间,上一天当前编号下总共抄表记录: 3383
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000228'}]
0000000228
00056000000017 ☆ sum_total_money <0 置为0
00056000000017
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000213')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000228', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 47, 983727), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '214928', 'work_sum': '221606', 'std_flow': '4.0', 'work_flow': '5.0', 'temperature': '20.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '150161.0', 'use_volume_std': '155326.0', 'use_money': '240755.3', 'sum_total_volume': '221606', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '25878.15', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000017处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 161
此查询区间,上一天当前编号下总共抄表记录: 3670
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000229'}]
0000000229
00056000000028 ☆ sum_total_money <0 置为0
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000207')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000229', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 48, 288701), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '133746', 'work_sum': '149161', 'std_flow': '49.0', 'work_flow': '52.0', 'temperature': '22.0', 'pressure': '96.0', 'price': '1.52', 'use_volume_work': '77716.0', 'use_volume_std': '67466.0', 'use_money': '102548.32', 'sum_total_volume': '133746', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '115704.41', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000015
此查询区间,当前编号下总共抄表记录: 174
此查询区间,上一天当前编号下总共抄表记录: 4022
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000230'}]
0000000230
00056000000015 ☆ sum_total_money <0 置为0
00056000000015
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000216')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000230', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000015', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 48, 553727), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '338084', 'work_sum': '245931', 'std_flow': '3.0', 'work_flow': '4.0', 'temperature': '17.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '174486.0', 'use_volume_std': '179651.0', 'use_money': '278459.05', 'sum_total_volume': '245931', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '43983.43', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000015处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000008
此查询区间,当前编号下总共抄表记录: 176
此查询区间,上一天当前编号下总共抄表记录: 4314
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000231'}]
0000000231
00050000000008 ☆ use_volume_work <0 置为0
00050000000008 ☆ use_volume_std <0 置为0
00050000000008 ☆ sum_total_money <0 置为0
00050000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000209')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000231', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000008', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 48, 837725), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '23', 'work_sum': '29', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '1.7', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '23', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '500.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00050000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000007
此查询区间,当前编号下总共抄表记录: 183
此查询区间,上一天当前编号下总共抄表记录: 4610
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000232'}]
0000000232
00050000000007 ☆ use_volume_work <0 置为0
00050000000007 ☆ use_volume_std <0 置为0
00050000000007 ☆ sum_total_money <0 置为0
00050000000007
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000203')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000232', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000007', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 49, 190697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '1000', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '1.7', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '305.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00050000000007处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 159
此查询区间,上一天当前编号下总共抄表记录: 4900
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000233'}]
0000000233
00056000000025 ☆ use_volume_work <0 置为0
00056000000025 ☆ use_volume_std <0 置为0
00056000000025 ☆ sum_total_money <0 置为0
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000208')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000233', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 49, 486696), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '47674', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13252.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00050000000006
此查询区间,当前编号下总共抄表记录: 166
此查询区间,上一天当前编号下总共抄表记录: 5191
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000234'}]
0000000234
00050000000006 ☆ use_volume_work <0 置为0
00050000000006 ☆ use_volume_std <0 置为0
00050000000006 ☆ sum_total_money <0 置为0
00050000000006
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000202')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000234', 'rtu_no': '00050000000002', 'flmeter_no': '00050000000006', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 49, 778726), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '1000', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '1.7', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '1000', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1700.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00050000000006处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000019
此查询区间,当前编号下总共抄表记录: 160
此查询区间,上一天当前编号下总共抄表记录: 5482
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000235'}]
0000000235
00056000000019 ☆ sum_total_money <0 置为0
00056000000019
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000201')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000235', 'rtu_no': '00050000000016', 'flmeter_no': '00056000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 50, 45727), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '195912', 'work_sum': '179885', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '10.0', 'pressure': '90.0', 'price': '2.28', 'use_volume_work': '108440.0', 'use_volume_std': '113605.0', 'use_money': '259019.4', 'sum_total_volume': '179885', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '15889.74', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '90.0', 'press_out': '90.0', 'temp_in': '10.0', 'temp_out': '10.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000019处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 159
此查询区间,上一天当前编号下总共抄表记录: 5773
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000236'}]
0000000236
00056000000010 ☆ sum_total_money <0 置为0
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000212')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000236', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 50, 328727), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '631250', 'work_sum': '631250', 'std_flow': '19.0', 'work_flow': '22.0', 'temperature': '18.0', 'pressure': '84.0', 'price': '1.52', 'use_volume_work': '307.0', 'use_volume_std': '307.0', 'use_money': '466.64', 'sum_total_volume': '631250', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '6414.78', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '84.0', 'press_out': '84.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 241
此查询区间,上一天当前编号下总共抄表记录: 6176
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000237'}]
0000000237
00056000000014 ☆ use_volume_work <0 置为0
00056000000014 ☆ use_volume_std <0 置为0
00056000000014 ☆ sum_total_money <0 置为0
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000200')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000237', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 50, 615696), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '4372', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '883.14', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 160
此查询区间,上一天当前编号下总共抄表记录: 6464
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000238'}]
0000000238
00056000000022 ☆ sum_total_money <0 置为0
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000210')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000238', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 50, 892726), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '8.0', 'use_money': '12.88', 'sum_total_volume': '6069', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '347.72', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
0005 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0007
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0007 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0009
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0009 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0011
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0011 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0012
I am main()
总共抄表数据: 20
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0012 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00126000000003
此查询区间,当前编号下总共抄表记录: 20
此查询区间,上一天当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0012', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0012', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000007'}]
0000000007
00126000000003 ☆ sum_total_volume is None 置为0
00126000000003
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0012', '00122019040000000006')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0012', 'srd_id': '00122019040000000007', 'rtu_no': '00120000000003', 'flmeter_no': '00126000000003', 'customer_no': '00120000000002', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 51, 561726), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '2', 'work_sum': '2', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '11.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '2.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '24.0', 'srd_status': '1'}]
insert sys_serial_no ok
00126000000003处理好数据已写入oracle
----------------------------------------------------------------------------------------
0012 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0016
I am main()
总共抄表数据: 14
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 27
0016 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 2
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00166000000002
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 3
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000018'}]
0000000018
00166000000002 ☆ sum_total_volume is None 置为0
00166000000002
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0016', '00162019040000000016')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0016', 'srd_id': '00162019040000000018', 'rtu_no': '00160000000002', 'flmeter_no': '00166000000002', 'customer_no': '00160000000002', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 51, 918710), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '19.0', 'pressure': '96.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[温度异常][压力异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[温度异常][压力异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '62', 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '19.0', 'srd_status': '1'}]
insert sys_serial_no ok
00166000000002处理好数据已写入oracle
----------------------------------------------------------------------------------------
00160000000001
此查询区间,当前编号下总共抄表记录: 13
此查询区间,上一天当前编号下总共抄表记录: 27
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000019'}]
0000000019
00160000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0016', '00162019040000000017')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0016', 'srd_id': '00162019040000000019', 'rtu_no': 'FM0000000690', 'flmeter_no': '00160000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 52, 215696), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '69540173.950', 'work_sum': '16324003.530', 'std_flow': '1715.0', 'work_flow': '432.0', 'temperature': '3.0', 'pressure': '400.0', 'price': '0.000', 'use_volume_work': '4789.219999998808', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '400.0', 'press_out': '400.0', 'temp_in': '3.0', 'temp_out': '3.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00160000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0016 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0019
I am main()
总共抄表数据: 1
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 25
0019 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00196000000002
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 25
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0019', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0019', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000010'}]
0000000010
00196000000002
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0019', '00192019040000000009')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0019', 'srd_id': '00192019040000000010', 'rtu_no': 'FM0000000697', 'flmeter_no': '00196000000002', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 52, 591720), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0.000', 'work_sum': '0.000', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '17.0', 'pressure': '101.0', 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00196000000002处理好数据已写入oracle
----------------------------------------------------------------------------------------
0019 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0003
I am main()
总共抄表数据: 752
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 456
0003 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 36
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 27
此查询区间,上一天当前编号下总共抄表记录: 14
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000313'}]
0000000313
00036000000005 ☆ sum_total_money <0 置为0
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000286')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000313', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 53, 136696), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '413', 'work_sum': '420', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '19.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '413', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1474.93', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000052
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一天当前编号下总共抄表记录: 36
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000314'}]
0000000314
00036000000052 ☆ use_volume_std <0 置为0
00036000000052 ☆ sum_total_volume is None 置为0
00036000000052
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000279')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000314', 'rtu_no': '00030000000094', 'flmeter_no': '00036000000052', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 53, 412697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '6765', 'work_sum': '6562', 'std_flow': '4.0', 'work_flow': '0', 'temperature': '23.0', 'pressure': '103.0', 'price': '1.0', 'use_volume_work': '6142.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000052处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000045
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 37
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000315'}]
0000000315
00036000000045 ☆ use_volume_work <0 置为0
00036000000045 ☆ use_volume_std <0 置为0
00036000000045 ☆ sum_total_volume is None 置为0
00036000000045
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000280')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000315', 'rtu_no': '00030000000086', 'flmeter_no': '00036000000045', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 53, 722701), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '37', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000045处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000053
此查询区间,当前编号下总共抄表记录: 22
此查询区间,上一天当前编号下总共抄表记录: 67
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000316'}]
0000000316
00036000000053 ☆ use_volume_work <0 置为0
00036000000053 ☆ use_volume_std <0 置为0
00036000000053 ☆ sum_total_volume is None 置为0
00036000000053
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000304')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000316', 'rtu_no': '00030000000095', 'flmeter_no': '00036000000053', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 54, 36705), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '53', 'remain_money': '53', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '22.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000053处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000061
此查询区间,当前编号下总共抄表记录: 13
此查询区间,上一天当前编号下总共抄表记录: 91
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000317'}]
0000000317
00036000000061 ☆ use_volume_work <0 置为0
00036000000061 ☆ use_volume_std <0 置为0
00036000000061 ☆ sum_total_volume is None 置为0
00036000000061
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000278')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000317', 'rtu_no': '00030000000103', 'flmeter_no': '00036000000061', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 54, 324698), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000061处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000058
此查询区间,当前编号下总共抄表记录: 18
此查询区间,上一天当前编号下总共抄表记录: 119
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000318'}]
0000000318
00036000000058 ☆ use_volume_work <0 置为0
00036000000058 ☆ use_volume_std <0 置为0
00036000000058 ☆ sum_total_volume is None 置为0
00036000000058
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000290')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000318', 'rtu_no': '00030000000100', 'flmeter_no': '00036000000058', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 54, 689697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '104.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '104.0', 'press_out': '104.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '25.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000058处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000059
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 120
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000319'}]
0000000319
00036000000059 ☆ use_volume_work <0 置为0
00036000000059 ☆ use_volume_std <0 置为0
00036000000059 ☆ sum_total_volume is None 置为0
00036000000059
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000300')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000319', 'rtu_no': '00030000000101', 'flmeter_no': '00036000000059', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 54, 982696), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '13', 'work_sum': '13', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 14.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '21.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000059处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000024
此查询区间,当前编号下总共抄表记录: 7
此查询区间,上一天当前编号下总共抄表记录: 132
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000320'}]
0000000320
00036000000024 ☆ use_volume_std <0 置为0
00036000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000306')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000320', 'rtu_no': 'FM0000000353', 'flmeter_no': '00036000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 55, 281697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '2579974.290', 'work_sum': '695543.720', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '13.0', 'pressure': '102.0', 'price': '0.000', 'use_volume_work': '695123.72', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000065
此查询区间,当前编号下总共抄表记录: 13
此查询区间,上一天当前编号下总共抄表记录: 156
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000321'}]
0000000321
00036000000065 ☆ use_volume_work <0 置为0
00036000000065 ☆ use_volume_std <0 置为0
00036000000065 ☆ sum_total_volume is None 置为0
00036000000065
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000310')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000321', 'rtu_no': '00030000000107', 'flmeter_no': '00036000000065', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 55, 589737), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '13.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000065处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000064
此查询区间,当前编号下总共抄表记录: 17
此查询区间,上一天当前编号下总共抄表记录: 186
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000322'}]
0000000322
00036000000064 ☆ use_volume_work <0 置为0
00036000000064 ☆ use_volume_std <0 置为0
00036000000064 ☆ sum_total_volume is None 置为0
00036000000064
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000287')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000322', 'rtu_no': '00030000000106', 'flmeter_no': '00036000000064', 'customer_no': '00030000000046', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 55, 881696), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '14.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000064处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000048
此查询区间,当前编号下总共抄表记录: 6
此查询区间,上一天当前编号下总共抄表记录: 210
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000323'}]
0000000323
00036000000048 ☆ use_volume_work <0 置为0
00036000000048 ☆ use_volume_std <0 置为0
00036000000048 ☆ sum_total_volume is None 置为0
00036000000048 ☆ sum_total_money <0 置为0
00036000000048
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000296')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000323', 'rtu_no': '00030000000090', 'flmeter_no': '00036000000048', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 56, 148699), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '35.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000048处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000043
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 211
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000324'}]
0000000324
00036000000043 ☆ use_volume_work <0 置为0
00036000000043 ☆ use_volume_std <0 置为0
00036000000043 ☆ sum_total_volume is None 置为0
00036000000043
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000307')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000324', 'rtu_no': '00030000000084', 'flmeter_no': '00036000000043', 'customer_no': '00030000000035', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 56, 581705), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '13.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000043处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000051
此查询区间,当前编号下总共抄表记录: 17
此查询区间,上一天当前编号下总共抄表记录: 238
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000325'}]
0000000325
00036000000051 ☆ use_volume_work <0 置为0
00036000000051 ☆ use_volume_std <0 置为0
00036000000051 ☆ sum_total_volume is None 置为0
00036000000051
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000295')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000325', 'rtu_no': '00030000000093', 'flmeter_no': '00036000000051', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 56, 865708), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '38.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000051处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000066
此查询区间,当前编号下总共抄表记录: 9
此查询区间,上一天当前编号下总共抄表记录: 258
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000326'}]
0000000326
00036000000066 ☆ use_volume_work <0 置为0
00036000000066 ☆ use_volume_std <0 置为0
00036000000066 ☆ sum_total_volume is None 置为0
00036000000066
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000297')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000326', 'rtu_no': '00030000000108', 'flmeter_no': '00036000000066', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 57, 124727), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '65', 'work_sum': '61', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '106.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '106.0', 'press_out': '106.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '23.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000066处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000099
此查询区间,当前编号下总共抄表记录: 4
此查询区间,上一天当前编号下总共抄表记录: 259
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000327'}]
0000000327
00036000000099 ☆ use_volume_work <0 置为0
00036000000099 ☆ use_volume_std <0 置为0
00036000000099 ☆ sum_total_volume is None 置为0
00036000000099
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000282')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000327', 'rtu_no': '00030000000139', 'flmeter_no': '00036000000099', 'customer_no': '00030000000052', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 57, 407701), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '6', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '14.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000099处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000023
此查询区间,当前编号下总共抄表记录: 7
此查询区间,上一天当前编号下总共抄表记录: 271
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000328'}]
0000000328
00036000000023 ☆ use_volume_std <0 置为0
00036000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000288')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000328', 'rtu_no': 'FM0000000352', 'flmeter_no': '00036000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 57, 722698), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '187556.770', 'work_sum': '73774.320', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '12.0', 'pressure': '101.0', 'price': '0.000', 'use_volume_work': '73354.32', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '12.0', 'temp_out': '12.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000004
此查询区间,当前编号下总共抄表记录: 27
此查询区间,上一天当前编号下总共抄表记录: 285
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000329'}]
0000000329
00036000000004 ☆ sum_total_money <0 置为0
00036000000004
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000281')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000329', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000004', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 58, 98697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '60364', 'work_sum': '51790', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '60364', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '52000.2', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000004处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000047
此查询区间,当前编号下总共抄表记录: 15
此查询区间,上一天当前编号下总共抄表记录: 298
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000330'}]
0000000330
00036000000047 ☆ use_volume_work <0 置为0
00036000000047 ☆ use_volume_std <0 置为0
00036000000047 ☆ sum_total_volume is None 置为0
00036000000047
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000289')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000330', 'rtu_no': '00030000000089', 'flmeter_no': '00036000000047', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 58, 374701), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '12', 'work_sum': '12', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 21.0, 'total_buy_volume': None, 'total_buy_money': '119', 'remain_money': '98', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '11.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000047处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000040
此查询区间,当前编号下总共抄表记录: 5
此查询区间,上一天当前编号下总共抄表记录: 298
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000331'}]
0000000331
00036000000040 ☆ use_volume_work <0 置为0
00036000000040 ☆ use_volume_std <0 置为0
00036000000040 ☆ sum_total_volume is None 置为0
00036000000040
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000292')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000331', 'rtu_no': '00030000000081', 'flmeter_no': '00036000000040', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 58, 689733), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '8.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '8.0', 'temp_out': '8.0', 'rssi': '23.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000040处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000012
此查询区间,当前编号下总共抄表记录: 6
此查询区间,上一天当前编号下总共抄表记录: 301
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000332'}]
0000000332
00036000000012 ☆ use_volume_work <0 置为0
00036000000012 ☆ use_volume_std <0 置为0
00036000000012 ☆ sum_total_volume is None 置为0
00036000000012
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000311')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000332', 'rtu_no': '00030000000043', 'flmeter_no': '00036000000012', 'customer_no': '00030000000005', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 58, 965705), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '6837', 'work_sum': '6828', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2999', 'remain_money': '2999', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000012处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000003
此查询区间,当前编号下总共抄表记录: 27
此查询区间,上一天当前编号下总共抄表记录: 315
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000333'}]
0000000333
00036000000003 ☆ sum_total_money <0 置为0
00036000000003
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000298')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000333', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000003', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 59, 266701), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '80', 'work_sum': '83', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '21.0', 'pressure': '100.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '80', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1426.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000003处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000038
此查询区间,当前编号下总共抄表记录: 12
此查询区间,上一天当前编号下总共抄表记录: 338
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000334'}]
0000000334
00036000000038 ☆ use_volume_work <0 置为0
00036000000038 ☆ use_volume_std <0 置为0
00036000000038 ☆ sum_total_volume is None 置为0
00036000000038
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000302')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000334', 'rtu_no': '00030000000079', 'flmeter_no': '00036000000038', 'customer_no': '00030000000016', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 59, 676714), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '13.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '13.0', 'temp_out': '13.0', 'rssi': '10.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000038处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000070
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 340
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000335'}]
0000000335
00036000000070 ☆ use_volume_work <0 置为0
00036000000070 ☆ use_volume_std <0 置为0
00036000000070 ☆ sum_total_volume is None 置为0
00036000000070
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000299')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000335', 'rtu_no': '00030000000112', 'flmeter_no': '00036000000070', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 57, 59, 965697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000070处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000022
此查询区间,当前编号下总共抄表记录: 7
此查询区间,上一天当前编号下总共抄表记录: 352
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000336'}]
0000000336
00036000000022 ☆ use_volume_std <0 置为0
00036000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000303')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000336', 'rtu_no': 'FM0000000351', 'flmeter_no': '00036000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 0, 299696), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '1570680.100', 'work_sum': '445637.220', 'std_flow': '130.0', 'work_flow': '30.0', 'temperature': '17.0', 'pressure': '428.0', 'price': '0.000', 'use_volume_work': '445554.22', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '428.0', 'press_out': '428.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000072
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 354
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000337'}]
0000000337
00036000000072 ☆ use_volume_work <0 置为0
00036000000072 ☆ use_volume_std <0 置为0
00036000000072 ☆ sum_total_volume is None 置为0
00036000000072
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000284')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000337', 'rtu_no': '00030000000115', 'flmeter_no': '00036000000072', 'customer_no': '00030000000002', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 0, 585761), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000072处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000063
此查询区间,当前编号下总共抄表记录: 14
此查询区间,上一天当前编号下总共抄表记录: 385
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000338'}]
0000000338
00036000000063 ☆ use_volume_work <0 置为0
00036000000063 ☆ use_volume_std <0 置为0
00036000000063 ☆ sum_total_volume is None 置为0
00036000000063
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000291')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000338', 'rtu_no': '00030000000105', 'flmeter_no': '00036000000063', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 0, 864698), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '10.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000063处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000056
此查询区间,当前编号下总共抄表记录: 5
此查询区间,上一天当前编号下总共抄表记录: 387
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000339'}]
0000000339
00036000000056 ☆ use_volume_work <0 置为0
00036000000056 ☆ use_volume_std <0 置为0
00036000000056 ☆ sum_total_volume is None 置为0
00036000000056
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000293')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000339', 'rtu_no': '00030000000098', 'flmeter_no': '00036000000056', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 1, 148734), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '19.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000056处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000062
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 388
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000340'}]
0000000340
00036000000062 ☆ use_volume_work <0 置为0
00036000000062 ☆ use_volume_std <0 置为0
00036000000062 ☆ sum_total_volume is None 置为0
00036000000062
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000283')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000340', 'rtu_no': '00030000000104', 'flmeter_no': '00036000000062', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 1, 431697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 899.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '99', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '40.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000062处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000013
此查询区间,当前编号下总共抄表记录: 27
此查询区间,上一天当前编号下总共抄表记录: 402
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000341'}]
0000000341
00036000000013 ☆ sum_total_money <0 置为0
00036000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000285')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000341', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 1, 782701), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '2073', 'work_sum': '173', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '22.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2073', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1949.4', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000010
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 404
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000342'}]
0000000342
00036000000010 ☆ use_volume_std <0 置为0
00036000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000308')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000342', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 2, 84697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '69526407.950', 'work_sum': '16320681.820', 'std_flow': '3073.0', 'work_flow': '963.0', 'temperature': '1.0', 'pressure': '310.0', 'price': '0.000', 'use_volume_work': '16320508.82', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '310.0', 'press_out': '310.0', 'temp_in': '1.0', 'temp_out': '1.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000054
此查询区间,当前编号下总共抄表记录: 374
此查询区间,上一天当前编号下总共抄表记录: 408
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000343'}]
0000000343
00036000000054 ☆ use_volume_work <0 置为0
00036000000054 ☆ use_volume_std <0 置为0
00036000000054 ☆ sum_total_volume is None 置为0
00036000000054
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000277')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000343', 'rtu_no': '00030000000096', 'flmeter_no': '00036000000054', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 2, 366698), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '34', 'work_sum': '34', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '20.0', 'pressure': '101.0', 'price': '1.2', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '6', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '98', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '23.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000054处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000087
此查询区间,当前编号下总共抄表记录: 21
此查询区间,上一天当前编号下总共抄表记录: 408
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000344'}]
0000000344
00036000000087 ☆ use_volume_std <0 置为0
00036000000087 ☆ sum_total_volume is None 置为0
00036000000087
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000312')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000344', 'rtu_no': '00030000000127', 'flmeter_no': '00036000000087', 'customer_no': '00030000000051', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 2, 708696), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '95648512', 'work_sum': '95684124', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '0', 'use_volume_work': '95683951.0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[网络异常][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[网络异常][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '31.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000087处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000044
此查询区间,当前编号下总共抄表记录: 13
此查询区间,上一天当前编号下总共抄表记录: 426
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000345'}]
0000000345
00036000000044 ☆ use_volume_work <0 置为0
00036000000044 ☆ use_volume_std <0 置为0
00036000000044 ☆ sum_total_volume is None 置为0
00036000000044
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000301')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000345', 'rtu_no': '00030000000085', 'flmeter_no': '00036000000044', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 3, 18736), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000044处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000028
此查询区间,当前编号下总共抄表记录: 7
此查询区间,上一天当前编号下总共抄表记录: 438
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000346'}]
0000000346
00036000000028 ☆ use_volume_std <0 置为0
00036000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000309')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000346', 'rtu_no': 'FM0000000355', 'flmeter_no': '00036000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 3, 280707), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '312644.260', 'work_sum': '287993.890', 'std_flow': '15.0', 'work_flow': '14.0', 'temperature': '11.0', 'pressure': '110.0', 'price': '0.000', 'use_volume_work': '287820.89', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '110.0', 'press_out': '110.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000067
此查询区间,当前编号下总共抄表记录: 4
此查询区间,上一天当前编号下总共抄表记录: 439
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000347'}]
0000000347
00036000000067 ☆ use_volume_work <0 置为0
00036000000067 ☆ use_volume_std <0 置为0
00036000000067 ☆ sum_total_volume is None 置为0
00036000000067
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000294')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000347', 'rtu_no': '00030000000109', 'flmeter_no': '00036000000067', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 3, 564697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000067处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000018
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 440
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000348'}]
0000000348
00036000000018 ☆ use_volume_work <0 置为0
00036000000018 ☆ use_volume_std <0 置为0
00036000000018 ☆ sum_total_volume is None 置为0
00036000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000305')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000348', 'rtu_no': '00030000000049', 'flmeter_no': '00036000000018', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 3, 892721), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '103', 'work_sum': '104', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '101.0', 'price': '0.01', 'use_volume_work': '0', 'use_volume_std': '0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '14', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '65', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '21.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
0003 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0002
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0002 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0010
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0010 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0018
I am main()
总共抄表数据: 4
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 7
0018 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00186000000001
此查询区间,当前编号下总共抄表记录: 4
此查询区间,上一天当前编号下总共抄表记录: 7
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000010'}]
0000000010
00186000000001 ☆ sum_total_volume is None 置为0
00186000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0018', '00182019040000000009')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0018', 'srd_id': '00182019040000000010', 'rtu_no': '00180000000001', 'flmeter_no': '00186000000001', 'customer_no': '00180000000001', 'report_time': datetime.datetime(2019, 4, 5, 16, 58, 4, 600697), 'year': '2019', 'month': '04', 'day': '04', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '99.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[表内累计充值金额比IC卡内的累计金额大][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[表内累计充值金额比IC卡内的累计金额大][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '20.0', 'srd_status': '1'}]
insert sys_serial_no ok
00186000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0018 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0006
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0006 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0013
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0013 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0014
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0014 ['2019-04-04 00:00:00', '2019-04-04 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
all done-日报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-04-05 16:57:43.593734
程序运行结束时间: 2019-04-05 16:58:05.305703
整个程序运行总时间: 21 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 6e-07
程序运行结束time.clock(): 21.7120104
整个程序运行总时间time.clock()差: 21.7120098 秒
----------------------------------------------------------------------------------------
============================================================================================================================================================分隔符
此机构: 0008
I am main()
总共抄表数据: 28
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 23
0008 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00086000000008
此查询区间,当前编号下总共抄表记录: 28
此查询区间,上一天当前编号下总共抄表记录: 23
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0008', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0008', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000029'}]
0000000029
00086000000008 ☆ sum_total_volume is None 置为0
00086000000008
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0008', '00082019040000000028')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0008', 'srd_id': '00082019040000000029', 'rtu_no': '00080000000003', 'flmeter_no': '00086000000008', 'customer_no': '00080000000001', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 1, 834448), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '100', 'remain_money': '100', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00086000000008处理好数据已写入oracle
----------------------------------------------------------------------------------------
0008 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0015
I am main()
总共抄表数据: 8
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 8
0015 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00156000000001
此查询区间,当前编号下总共抄表记录: 8
此查询区间,上一天当前编号下总共抄表记录: 8
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0015', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0015', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000018'}]
0000000018
00156000000001 ☆ sum_total_volume is None 置为0
00156000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0015', '00152019040000000017')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0015', 'srd_id': '00152019040000000018', 'rtu_no': '00150000000001', 'flmeter_no': '00156000000001', 'customer_no': '00150000000001', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 2, 207453), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '98.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 15.0, 'total_buy_volume': None, 'total_buy_money': '20', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '5.0', 'srd_status': '1'}]
insert sys_serial_no ok
00156000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0015 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0017
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0017 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0005
I am main()
总共抄表数据: 5093
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 6156
0005 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 19
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00056000000019
此查询区间,当前编号下总共抄表记录: 269
此查询区间,上一天当前编号下总共抄表记录: 293
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000252'}]
0000000252
00056000000019 ☆ sum_total_money <0 置为0
00056000000019
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000239')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000252', 'rtu_no': '00050000000016', 'flmeter_no': '00056000000019', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 3, 134481), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '196104', 'work_sum': '179965', 'std_flow': '1.0', 'work_flow': '1.0', 'temperature': '11.0', 'pressure': '89.0', 'price': '2.28', 'use_volume_work': '68.0', 'use_volume_std': '68.0', 'use_money': '155.04', 'sum_total_volume': '179965', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '15707.34', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '89.0', 'press_out': '89.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000019处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000021
此查询区间,当前编号下总共抄表记录: 268
此查询区间,上一天当前编号下总共抄表记录: 289
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000253'}]
0000000253
00056000000021 ☆ sum_total_money <0 置为0
00056000000021
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000240')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000253', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000021', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 3, 389480), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '66659', 'work_sum': '71855', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '32.0', 'pressure': '98.0', 'price': '1.46', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '66659', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '25891.98', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '32.0', 'temp_out': '32.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000021处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000022
此查询区间,当前编号下总共抄表记录: 268
此查询区间,上一天当前编号下总共抄表记录: 293
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000254'}]
0000000254
00056000000022 ☆ sum_total_money <0 置为0
00056000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000250')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000254', 'rtu_no': '00050000000017', 'flmeter_no': '00056000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 3, 649450), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '11.0', 'use_money': '17.71', 'sum_total_volume': '6082', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '326.79', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000029
此查询区间,当前编号下总共抄表记录: 285
此查询区间,上一天当前编号下总共抄表记录: 293
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000255'}]
0000000255
00056000000029 ☆ sum_total_money <0 置为0
00056000000029
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000246')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000255', 'rtu_no': '00050000000024', 'flmeter_no': '00056000000029', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 3, 939480), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '2.0', 'use_money': '3.22', 'sum_total_volume': '25769', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '7827.51', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000029处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000015
此查询区间,当前编号下总共抄表记录: 285
此查询区间,上一天当前编号下总共抄表记录: 331
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000256'}]
0000000256
00056000000015 ☆ sum_total_money <0 置为0
00056000000015
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000242')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000256', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000015', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 4, 221482), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '338360', 'work_sum': '246049', 'std_flow': '4.0', 'work_flow': '5.0', 'temperature': '18.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '76.0', 'use_volume_std': '76.0', 'use_money': '117.8', 'sum_total_volume': '246049', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '43800.53', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000015处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000026
此查询区间,当前编号下总共抄表记录: 311
此查询区间,上一天当前编号下总共抄表记录: 291
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000257'}]
0000000257
00056000000026 ☆ sum_total_money <0 置为0
00056000000026
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000243')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000257', 'rtu_no': '00050000000021', 'flmeter_no': '00056000000026', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 4, 486474), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '1.61', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '9816', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '2447.86', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000026处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000017
此查询区间,当前编号下总共抄表记录: 281
此查询区间,上一天当前编号下总共抄表记录: 352
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000258'}]
0000000258
00056000000017 ☆ sum_total_money <0 置为0
00056000000017
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000249')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000258', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000017', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 4, 749477), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '215469', 'work_sum': '221798', 'std_flow': '3.0', 'work_flow': '3.0', 'temperature': '21.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '90.0', 'use_volume_std': '90.0', 'use_money': '139.5', 'sum_total_volume': '221798', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '25580.55', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000017处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000020
此查询区间,当前编号下总共抄表记录: 265
此查询区间,上一天当前编号下总共抄表记录: 289
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000259'}]
0000000259
00056000000020 ☆ sum_total_money <0 置为0
00056000000020
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000251')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000259', 'rtu_no': '00050000000015', 'flmeter_no': '00056000000020', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 5, 27450), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '29933', 'work_sum': '32207', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '30.0', 'pressure': '98.0', 'price': '1.59', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '29933', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '461.6', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '30.0', 'temp_out': '30.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000020处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000023
此查询区间,当前编号下总共抄表记录: 334
此查询区间,上一天当前编号下总共抄表记录: 327
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000260'}]
0000000260
00056000000023 ☆ sum_total_money <0 置为0
00056000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000233')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000260', 'rtu_no': '00050000000018', 'flmeter_no': '00056000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 5, 276448), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '341643', 'work_sum': '175731', 'std_flow': '16.0', 'work_flow': '17.0', 'temperature': '19.0', 'pressure': '95.0', 'price': '1.43', 'use_volume_work': '284.0', 'use_volume_std': '284.0', 'use_money': '406.12', 'sum_total_volume': '175731', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '8291.8', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '95.0', 'press_out': '95.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000018
此查询区间,当前编号下总共抄表记录: 280
此查询区间,上一天当前编号下总共抄表记录: 350
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000261'}]
0000000261
00056000000018 ☆ sum_total_money <0 置为0
00056000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000236')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000261', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000018', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 5, 639450), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '156324', 'work_sum': '156324', 'std_flow': '3.0', 'work_flow': '3.0', 'temperature': '21.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '96.0', 'use_volume_std': '96.0', 'use_money': '148.8', 'sum_total_volume': '156324', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '24730.62', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000027
此查询区间,当前编号下总共抄表记录: 270
此查询区间,上一天当前编号下总共抄表记录: 293
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000262'}]
0000000262
00056000000027 ☆ sum_total_money <0 置为0
00056000000027
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000235')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000262', 'rtu_no': '00050000000022', 'flmeter_no': '00056000000027', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 5, 899450), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '135.0', 'use_money': '307.8', 'sum_total_volume': '88034', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '6120.76', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000027处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000016
此查询区间,当前编号下总共抄表记录: 279
此查询区间,上一天当前编号下总共抄表记录: 356
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000263'}]
0000000263
00056000000016 ☆ sum_total_money <0 置为0
00056000000016
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000248')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000263', 'rtu_no': '00050000000014', 'flmeter_no': '00056000000016', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 6, 143480), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '463996', 'work_sum': '266705', 'std_flow': '1.0', 'work_flow': '1.0', 'temperature': '20.0', 'pressure': '83.0', 'price': '1.55', 'use_volume_work': '49.0', 'use_volume_std': '49.0', 'use_money': '75.95', 'sum_total_volume': '266705', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '35730.94', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '83.0', 'press_out': '83.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000016处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000014
此查询区间,当前编号下总共抄表记录: 356
此查询区间,上一天当前编号下总共抄表记录: 402
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000264'}]
0000000264
00056000000014 ☆ sum_total_money <0 置为0
00056000000014
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000237')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000264', 'rtu_no': '00050000000013', 'flmeter_no': '00056000000014', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 6, 418483), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '17.0', 'use_money': '38.76', 'sum_total_volume': '4396', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '828.42', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000014处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000024
此查询区间,当前编号下总共抄表记录: 264
此查询区间,上一天当前编号下总共抄表记录: 289
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000265'}]
0000000265
00056000000024 ☆ sum_total_money <0 置为0
00056000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000244')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000265', 'rtu_no': '00050000000019', 'flmeter_no': '00056000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 6, 715452), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '249277', 'work_sum': '249277', 'std_flow': '17.0', 'work_flow': '20.0', 'temperature': '21.0', 'pressure': '86.0', 'price': '1.43', 'use_volume_work': '449.0', 'use_volume_std': '449.0', 'use_money': '642.07', 'sum_total_volume': '249277', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '9782.18', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '86.0', 'press_out': '86.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000028
此查询区间,当前编号下总共抄表记录: 266
此查询区间,上一天当前编号下总共抄表记录: 290
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000266'}]
0000000266
00056000000028 ☆ sum_total_money <0 置为0
00056000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000234')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000266', 'rtu_no': '00050000000023', 'flmeter_no': '00056000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 7, 19473), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '134782', 'work_sum': '150268', 'std_flow': '37.0', 'work_flow': '40.0', 'temperature': '21.0', 'pressure': '96.0', 'price': '1.52', 'use_volume_work': '924.0', 'use_volume_std': '866.0', 'use_money': '1316.32', 'sum_total_volume': '134782', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '114129.69', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000025
此查询区间,当前编号下总共抄表记录: 267
此查询区间,上一天当前编号下总共抄表记录: 289
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000267'}]
0000000267
00056000000025 ☆ sum_total_money <0 置为0
00056000000025
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000245')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000267', 'rtu_no': '00050000000020', 'flmeter_no': '00056000000025', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 7, 317449), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '0.0', 'pressure': '0.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '47674', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '13252.68', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '0.0', 'press_out': '0.0', 'temp_in': '0.0', 'temp_out': '0.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000025处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000030
此查询区间,当前编号下总共抄表记录: 6
此查询区间,上一天当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000268'}]
0000000268
00056000000030 ☆ sum_total_volume is None 置为0
00056000000030
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000238')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000268', 'rtu_no': '00050000000025', 'flmeter_no': '00056000000030', 'customer_no': '00050000000022', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 7, 611448), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '24.0', 'pressure': '72.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '72.0', 'press_out': '72.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '26.0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000030处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000010
此查询区间,当前编号下总共抄表记录: 271
此查询区间,上一天当前编号下总共抄表记录: 291
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000269'}]
0000000269
00056000000010 ☆ sum_total_money <0 置为0
00056000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000247')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000269', 'rtu_no': '00050000000004', 'flmeter_no': '00056000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 7, 889450), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '632162', 'work_sum': '632162', 'std_flow': '21.0', 'work_flow': '25.0', 'temperature': '18.0', 'pressure': '84.0', 'price': '1.52', 'use_volume_work': '582.0', 'use_volume_std': '582.0', 'use_money': '884.64', 'sum_total_volume': '632162', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '5028.54', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '84.0', 'press_out': '84.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00056000000013
此查询区间,当前编号下总共抄表记录: 268
此查询区间,上一天当前编号下总共抄表记录: 291
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0005', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0005', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000270'}]
0000000270
00056000000013 ☆ sum_total_money <0 置为0
00056000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0005', '00052019040000000241')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0005', 'srd_id': '00052019040000000270', 'rtu_no': '00050000000012', 'flmeter_no': '00056000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 8, 168450), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '3', 'work_sum': '0', 'std_flow': '35.0', 'work_flow': '35.0', 'temperature': '35.0', 'pressure': '101.0', 'price': '2.28', 'use_volume_work': '0.0', 'use_volume_std': '170.0', 'use_money': '387.6', 'sum_total_volume': '95971', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '10749.51', 'remain_volume': '0.0', 'fm_state': '10000000', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,已开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '35.0', 'temp_out': '35.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00056000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
0005 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0007
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0007 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0009
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0009 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0011
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0011 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0012
I am main()
总共抄表数据: 1
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 38
0012 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00126000000003
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 38
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0012', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0012', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000005'}]
0000000005
00126000000003 ☆ use_volume_work <0 置为0
00126000000003 ☆ sum_total_volume is None 置为0
00126000000003
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0012', '00122019040000000004')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0012', 'srd_id': '00122019040000000005', 'rtu_no': '00120000000003', 'flmeter_no': '00126000000003', 'customer_no': '00120000000002', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 8, 821458), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '7', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '13.0', 'srd_status': '1'}]
insert sys_serial_no ok
00126000000003处理好数据已写入oracle
----------------------------------------------------------------------------------------
0012 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0016
I am main()
总共抄表数据: 23
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 25
0016 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 2
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00166000000002
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000014'}]
0000000014
00166000000002 ☆ sum_total_volume is None 置为0
00166000000002
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0016', '00162019040000000013')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0016', 'srd_id': '00162019040000000014', 'rtu_no': '00160000000002', 'flmeter_no': '00166000000002', 'customer_no': '00160000000002', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 9, 167461), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '19.0', 'pressure': '96.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '68', 'press_in': '96.0', 'press_out': '96.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00166000000002处理好数据已写入oracle
----------------------------------------------------------------------------------------
00160000000001
此查询区间,当前编号下总共抄表记录: 22
此查询区间,上一天当前编号下总共抄表记录: 24
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0016', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0016', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000015'}]
0000000015
00160000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0016', '00162019040000000012')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0016', 'srd_id': '00162019040000000015', 'rtu_no': 'FM0000000690', 'flmeter_no': '00160000000001', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 9, 415459), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '69598495.950', 'work_sum': '16336887.940', 'std_flow': '1665.0', 'work_flow': '365.0', 'temperature': '7.0', 'pressure': '444.0', 'price': '0.000', 'use_volume_work': '7951.6500000003725', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '444.0', 'press_out': '444.0', 'temp_in': '7.0', 'temp_out': '7.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00160000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0016 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0019
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 10
0019 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0003
I am main()
总共抄表数据: 551
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 1021
0003 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 34
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00036000000048
此查询区间,当前编号下总共抄表记录: 22
此查询区间,上一天当前编号下总共抄表记录: 24
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000239'}]
0000000239
00036000000048 ☆ sum_total_volume is None 置为0
00036000000048 ☆ sum_total_money <0 置为0
00036000000048
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000216')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000239', 'rtu_no': '00030000000090', 'flmeter_no': '00036000000048', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 9, 973486), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '99.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '99.0', 'press_out': '99.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '20.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000048处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000010
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000240'}]
0000000240
00036000000010
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000233')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000240', 'rtu_no': 'FM0000000690', 'flmeter_no': '00036000000010', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 10, 242450), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '69577982.950', 'work_sum': '16332331.300', 'std_flow': '2502.0', 'work_flow': '555.0', 'temperature': '3.0', 'pressure': '428.0', 'price': '0.000', 'use_volume_work': '11649.480000000447', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '428.0', 'press_out': '428.0', 'temp_in': '3.0', 'temp_out': '3.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000010处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000059
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000241'}]
0000000241
00036000000059 ☆ sum_total_volume is None 置为0
00036000000059
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000238')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000241', 'rtu_no': '00030000000101', 'flmeter_no': '00036000000059', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 10, 549447), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '13', 'work_sum': '13', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '19.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 14.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '1', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '19.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000059处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000005
此查询区间,当前编号下总共抄表记录: 44
此查询区间,上一天当前编号下总共抄表记录: 49
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000242'}]
0000000242
00036000000005 ☆ sum_total_money <0 置为0
00036000000005
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000219')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000242', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000005', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 10, 787449), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '413', 'work_sum': '420', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '100.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '413', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1474.93', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000005处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000067
此查询区间,当前编号下总共抄表记录: 26
此查询区间,上一天当前编号下总共抄表记录: 15
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000243'}]
0000000243
00036000000067 ☆ sum_total_volume is None 置为0
00036000000067
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000221')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000243', 'rtu_no': '00030000000109', 'flmeter_no': '00036000000067', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 11, 58459), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[充值金额过大超出液晶显示范围][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000067处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000023
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 12
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000244'}]
0000000244
00036000000023
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000234')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000244', 'rtu_no': 'FM0000000352', 'flmeter_no': '00036000000023', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 11, 328452), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '187556.770', 'work_sum': '73774.320', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '18.0', 'pressure': '102.0', 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000023处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000062
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000245'}]
0000000245
00036000000062 ☆ sum_total_volume is None 置为0
00036000000062
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000211')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000245', 'rtu_no': '00030000000104', 'flmeter_no': '00036000000062', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 11, 548499), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 899.0, 'total_buy_volume': None, 'total_buy_money': '998', 'remain_money': '99', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '38.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000062处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000044
此查询区间,当前编号下总共抄表记录: 21
此查询区间,上一天当前编号下总共抄表记录: 24
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000246'}]
0000000246
00036000000044 ☆ sum_total_volume is None 置为0
00036000000044
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000232')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000246', 'rtu_no': '00030000000085', 'flmeter_no': '00036000000044', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 11, 792453), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000044处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000047
此查询区间,当前编号下总共抄表记录: 14
此查询区间,上一天当前编号下总共抄表记录: 25
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000247'}]
0000000247
00036000000047 ☆ sum_total_volume is None 置为0
00036000000047
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000210')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000247', 'rtu_no': '00030000000089', 'flmeter_no': '00036000000047', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 12, 24451), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '12', 'work_sum': '12', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 21.0, 'total_buy_volume': None, 'total_buy_money': '119', 'remain_money': '98', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '8.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000047处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000072
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000248'}]
0000000248
00036000000072 ☆ sum_total_volume is None 置为0
00036000000072
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000215')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000248', 'rtu_no': '00030000000115', 'flmeter_no': '00036000000072', 'customer_no': '00030000000002', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 12, 261449), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 2.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000072处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000061
此查询区间,当前编号下总共抄表记录: 22
此查询区间,上一天当前编号下总共抄表记录: 24
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000249'}]
0000000249
00036000000061 ☆ sum_total_volume is None 置为0
00036000000061
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000209')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000249', 'rtu_no': '00030000000103', 'flmeter_no': '00036000000061', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 12, 513452), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000061处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000064
此查询区间,当前编号下总共抄表记录: 28
此查询区间,上一天当前编号下总共抄表记录: 30
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000250'}]
0000000250
00036000000064 ☆ sum_total_volume is None 置为0
00036000000064
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000231')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000250', 'rtu_no': '00030000000106', 'flmeter_no': '00036000000064', 'customer_no': '00030000000046', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 12, 781457), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '14.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000064处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000051
此查询区间,当前编号下总共抄表记录: 29
此查询区间,上一天当前编号下总共抄表记录: 30
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000251'}]
0000000251
00036000000051 ☆ sum_total_volume is None 置为0
00036000000051
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000235')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000251', 'rtu_no': '00030000000093', 'flmeter_no': '00036000000051', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 13, 64457), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '16.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000051处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000038
此查询区间,当前编号下总共抄表记录: 10
此查询区间,上一天当前编号下总共抄表记录: 19
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000252'}]
0000000252
00036000000038 ☆ sum_total_volume is None 置为0
00036000000038
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000206')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000252', 'rtu_no': '00030000000079', 'flmeter_no': '00036000000038', 'customer_no': '00030000000016', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 13, 340449), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '13.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000038处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000063
此查询区间,当前编号下总共抄表记录: 27
此查询区间,上一天当前编号下总共抄表记录: 27
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000253'}]
0000000253
00036000000063 ☆ sum_total_volume is None 置为0
00036000000063
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000226')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000253', 'rtu_no': '00030000000105', 'flmeter_no': '00036000000063', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 13, 660448), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2', 'remain_money': '2', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '7.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000063处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000043
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000254'}]
0000000254
00036000000043 ☆ sum_total_volume is None 置为0
00036000000043
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000213')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000254', 'rtu_no': '00030000000084', 'flmeter_no': '00036000000043', 'customer_no': '00030000000035', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 13, 949450), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000043处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000065
此查询区间,当前编号下总共抄表记录: 22
此查询区间,上一天当前编号下总共抄表记录: 24
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000255'}]
0000000255
00036000000065 ☆ sum_total_volume is None 置为0
00036000000065
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000222')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000255', 'rtu_no': '00030000000107', 'flmeter_no': '00036000000065', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 14, 225451), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '14.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000065处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000045
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 1
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000256'}]
0000000256
00036000000045 ☆ sum_total_volume is None 置为0
00036000000045
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000224')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000256', 'rtu_no': '00030000000086', 'flmeter_no': '00036000000045', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 14, 535481), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '102.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 3.0, 'total_buy_volume': None, 'total_buy_money': '40', 'remain_money': '37', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '102.0', 'press_out': '102.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '17.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000045处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000024
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 12
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000257'}]
0000000257
00036000000024
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000207')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000257', 'rtu_no': 'FM0000000353', 'flmeter_no': '00036000000024', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 14, 816491), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '2579974.290', 'work_sum': '695543.720', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '17.0', 'pressure': '103.0', 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000024处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000012
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 6
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000258'}]
0000000258
00036000000012 ☆ sum_total_volume is None 置为0
00036000000012
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000230')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000258', 'rtu_no': '00030000000043', 'flmeter_no': '00036000000012', 'customer_no': '00030000000005', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 15, 86447), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '6837', 'work_sum': '6828', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '15.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '2999', 'remain_money': '2999', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '15.0', 'temp_out': '15.0', 'rssi': '19.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000012处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000018
此查询区间,当前编号下总共抄表记录: 3
此查询区间,上一天当前编号下总共抄表记录: 2
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000259'}]
0000000259
00036000000018 ☆ sum_total_volume is None 置为0
00036000000018
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000225')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000259', 'rtu_no': '00030000000049', 'flmeter_no': '00036000000018', 'customer_no': '00030000000006', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 15, 403538), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '103', 'work_sum': '104', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '18.0', 'pressure': '100.0', 'price': '0.01', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '15', 'remain_money': '14', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '43', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '20.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000018处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000022
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 12
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000260'}]
0000000260
00036000000022
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000227')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000260', 'rtu_no': 'FM0000000351', 'flmeter_no': '00036000000022', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 15, 663453), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '1574574.530', 'work_sum': '446581.200', 'std_flow': '114.0', 'work_flow': '27.0', 'temperature': '18.0', 'pressure': '417.0', 'price': '0.000', 'use_volume_work': '602.6500000000233', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '417.0', 'press_out': '417.0', 'temp_in': '18.0', 'temp_out': '18.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000022处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000003
此查询区间,当前编号下总共抄表记录: 44
此查询区间,上一天当前编号下总共抄表记录: 49
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000261'}]
0000000261
00036000000003 ☆ sum_total_money <0 置为0
00036000000003
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000205')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000261', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000003', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 15, 924486), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '80', 'work_sum': '83', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '21.0', 'pressure': '100.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '80', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1426.0', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '21.0', 'temp_out': '21.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000003处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000028
此查询区间,当前编号下总共抄表记录: 11
此查询区间,上一天当前编号下总共抄表记录: 12
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000262'}]
0000000262
00036000000028
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000217')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000262', 'rtu_no': 'FM0000000355', 'flmeter_no': '00036000000028', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 16, 215499), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '312790.030', 'work_sum': '288130.450', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '16.0', 'pressure': '109.0', 'price': '0.000', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0.000', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0.000', 'remain_volume': '0.000', 'fm_state': None, 'fm_state_msg': None, 'rtu_state': None, 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': None, 'power_voltage': None, 'battery_voltage': None, 'battery_level': None, 'press_in': '109.0', 'press_out': '109.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000028处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000056
此查询区间,当前编号下总共抄表记录: 2
此查询区间,上一天当前编号下总共抄表记录: 11
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000263'}]
0000000263
00036000000056 ☆ sum_total_volume is None 置为0
00036000000056
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000208')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000263', 'rtu_no': '00030000000098', 'flmeter_no': '00036000000056', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 16, 558492), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '19.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '5', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '19.0', 'temp_out': '19.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000056处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000054
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 389
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000264'}]
0000000264
00036000000054 ☆ sum_total_volume is None 置为0
00036000000054
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000218')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000264', 'rtu_no': '00030000000096', 'flmeter_no': '00036000000054', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 16, 968453), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '7724', 'work_sum': '7489', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '24.0', 'pressure': '103.0', 'price': '1.0', 'use_volume_work': '7455.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 245.0, 'total_buy_volume': None, 'total_buy_money': '245', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '24.0', 'temp_out': '24.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000054处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000066
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 14
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000265'}]
0000000265
00036000000066 ☆ sum_total_volume is None 置为0
00036000000066
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000237')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000265', 'rtu_no': '00030000000108', 'flmeter_no': '00036000000066', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 17, 265480), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '66', 'work_sum': '62', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '11.0', 'pressure': '105.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '105.0', 'press_out': '105.0', 'temp_in': '11.0', 'temp_out': '11.0', 'rssi': '18.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000066处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000004
此查询区间,当前编号下总共抄表记录: 44
此查询区间,上一天当前编号下总共抄表记录: 49
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000266'}]
0000000266
00036000000004 ☆ sum_total_money <0 置为0
00036000000004
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000212')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000266', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000004', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 17, 533476), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '60364', 'work_sum': '51790', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '20.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '60364', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '52000.2', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000004处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000070
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 3
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000267'}]
0000000267
00036000000070 ☆ sum_total_volume is None 置为0
00036000000070
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000220')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000267', 'rtu_no': '00030000000112', 'flmeter_no': '00036000000070', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 17, 806448), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '14.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 4.0, 'total_buy_volume': None, 'total_buy_money': '4', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '14.0', 'temp_out': '14.0', 'rssi': '42.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000070处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000058
此查询区间,当前编号下总共抄表记录: 29
此查询区间,上一天当前编号下总共抄表记录: 29
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000268'}]
0000000268
00036000000058 ☆ sum_total_volume is None 置为0
00036000000058
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000236')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000268', 'rtu_no': '00030000000100', 'flmeter_no': '00036000000058', 'customer_no': '00030000000007', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 18, 134452), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '11.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000058处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000099
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 4
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000269'}]
0000000269
00036000000099 ☆ sum_total_volume is None 置为0
00036000000099
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000228')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000269', 'rtu_no': '00030000000139', 'flmeter_no': '00036000000099', 'customer_no': '00030000000052', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 18, 446449), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '17.0', 'pressure': '101.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 1.0, 'total_buy_volume': None, 'total_buy_money': '6', 'remain_money': '5', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '17.0', 'temp_out': '17.0', 'rssi': '12.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000099处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000052
此查询区间,当前编号下总共抄表记录: 21
此查询区间,上一天当前编号下总共抄表记录: 23
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000270'}]
0000000270
00036000000052 ☆ sum_total_volume is None 置为0
00036000000052
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000223')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000270', 'rtu_no': '00030000000094', 'flmeter_no': '00036000000052', 'customer_no': '00030000000036', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 18, 740448), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '6888', 'work_sum': '6685', 'std_flow': '4.0', 'work_flow': '0', 'temperature': '23.0', 'pressure': '103.0', 'price': '1.0', 'use_volume_work': '93.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 10.0, 'total_buy_volume': None, 'total_buy_money': '10', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '103.0', 'press_out': '103.0', 'temp_in': '23.0', 'temp_out': '23.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000052处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000053
此查询区间,当前编号下总共抄表记录: 37
此查询区间,上一天当前编号下总共抄表记录: 35
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000271'}]
0000000271
00036000000053 ☆ sum_total_volume is None 置为0
00036000000053
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000214')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000271', 'rtu_no': '00030000000095', 'flmeter_no': '00036000000053', 'customer_no': '00030000000030', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 19, 15448), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '16.0', 'pressure': '100.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '53', 'remain_money': '53', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '无报警[状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '无报警[状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '100.0', 'press_out': '100.0', 'temp_in': '16.0', 'temp_out': '16.0', 'rssi': '30.0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000053处理好数据已写入oracle
----------------------------------------------------------------------------------------
00036000000013
此查询区间,当前编号下总共抄表记录: 45
此查询区间,上一天当前编号下总共抄表记录: 49
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0003', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0003', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000272'}]
0000000272
00036000000013 ☆ sum_total_money <0 置为0
00036000000013
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0003', '00032019040000000229')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0003', 'srd_id': '00032019040000000272', 'rtu_no': '00030000000002', 'flmeter_no': '00036000000013', 'customer_no': None, 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 19, 327450), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '2073', 'work_sum': '173', 'std_flow': '0.0', 'work_flow': '0.0', 'temperature': '22.0', 'pressure': '101.0', 'price': '2.39', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '2073', 'sum_total_money': '0', 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '1949.4', 'remain_volume': '0.0', 'fm_state': '10000001', 'fm_state_msg': '外接电,阀门无低电,无卡攻击,未剪线,远程阀开,无低电,阀开,未开户', 'rtu_state': '0000', 'rtu_state_msg': None, 'valve_state': '0', 'valve_state_msg': '阀开', 'power_voltage': '0000', 'battery_voltage': '0000', 'battery_level': None, 'press_in': '101.0', 'press_out': '101.0', 'temp_in': '22.0', 'temp_out': '22.0', 'rssi': '0', 'srd_status': '1'}]
insert sys_serial_no ok
00036000000013处理好数据已写入oracle
----------------------------------------------------------------------------------------
0003 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0002
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0002 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0010
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0010 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0018
I am main()
总共抄表数据: 1
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 5
0018 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 开始进行计算日报表数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00186000000001
此查询区间,当前编号下总共抄表记录: 1
此查询区间,上一天当前编号下总共抄表记录: 5
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0018', 'ssn_key_name': 'SCADA_REPORT_DAILY', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0018', 'SSN_KEY_NAME': 'SCADA_REPORT_DAILY', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904日报表', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000008'}]
0000000008
00186000000001 ☆ sum_total_volume is None 置为0
00186000000001
总列表长度: 1
执行sql:[delete from SCADA_REPORT_DAILY where SRD_ORG_ID = :1 and SRD_ID=:2],参数:[('0018', '00182019040000000007')]
del_by_where ok
执行sql:[INSERT INTO SCADA_REPORT_DAILY (SRD_ORG_ID,SRD_ID, RTU_NO,FLMETER_NO,CUSTOMER_NO,REPORT_TIME,YEAR,MONTH,DAY, HOUR,STD_SUM,WORK_SUM,STD_FLOW,WORK_FLOW,TEMPERATURE,PRESSURE,PRICE,USE_VOLUME_WORK, USE_VOLUME_STD,USE_MONEY,SUM_TOTAL_VOLUME,SUM_TOTAL_MONEY,TOTAL_BUY_VOLUME,TOTAL_BUY_MONEY,REMAIN_MONEY,REMAIN_VOLUME,FM_STATE,FM_STATE_MSG,RTU_STATE,RTU_STATE_MSG,VALVE_STATE,VALVE_STATE_MSG,POWER_VOLTAGE,BATTERY_VOLTAGE,BATTERY_LEVEL,PRESS_IN,PRESS_OUT,TEMP_IN,TEMP_OUT,RSSI, SRD_STATUS ) VALUES(:srd_org_id,:srd_id, :rtu_no,:flmeter_no,:customer_no,:report_time,:year,:month,:day, :hour,:std_sum,:work_sum,:std_flow,:work_flow,:temperature,:pressure,:price,:use_volume_work, :use_volume_std,:use_money,:sum_total_volume,:sum_total_money,:total_buy_volume,:total_buy_money,:remain_money,:remain_volume,:fm_state,:fm_state_msg,:rtu_state,:rtu_state_msg,:valve_state,:valve_state_msg,:power_voltage,:battery_voltage,:battery_level,:press_in,:press_out,:temp_in,:temp_out,:rssi, :srd_status)],参数:[{'srd_org_id': '0018', 'srd_id': '00182019040000000008', 'rtu_no': '00180000000001', 'flmeter_no': '00186000000001', 'customer_no': '00180000000001', 'report_time': datetime.datetime(2019, 4, 6, 12, 3, 19, 859448), 'year': '2019', 'month': '04', 'day': '05', 'hour': '', 'std_sum': '0', 'work_sum': '0', 'std_flow': '0.0', 'work_flow': '0', 'temperature': '20.0', 'pressure': '98.0', 'price': '1.0', 'use_volume_work': '0.0', 'use_volume_std': '0.0', 'use_money': '0.0', 'sum_total_volume': '0', 'sum_total_money': 0.0, 'total_buy_volume': None, 'total_buy_money': '0', 'remain_money': '0', 'remain_volume': None, 'fm_state': '1', 'fm_state_msg': '[表内累计充值金额比IC卡内的累计金额大][状态字2备用待定;]', 'rtu_state': '1', 'rtu_state_msg': '[表内累计充值金额比IC卡内的累计金额大][状态字2备用待定;]', 'valve_state': None, 'valve_state_msg': None, 'power_voltage': '00', 'battery_voltage': None, 'battery_level': '100', 'press_in': '98.0', 'press_out': '98.0', 'temp_in': '20.0', 'temp_out': '20.0', 'rssi': '19.0', 'srd_status': '1'}]
insert sys_serial_no ok
00186000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0018 data_processing is ok
----------------------------------------------------------------------------------------
此机构: 0006
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0006 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0013
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0013 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
此机构: 0014
I am main()
总共抄表数据: 0
下面是查询当天的上一天数据-总共抄表数据
总共抄表数据: 0
0014 ['2019-04-05 00:00:00', '2019-04-05 23:59:59'] 期间无抄表数据，请等待重新计算日报表
----------------------------------------------------------------------------------------
all done-日报表整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-04-06 12:03:01.679449
程序运行结束时间: 2019-04-06 12:03:20.433457
整个程序运行总时间: 18 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 3e-07
程序运行结束time.clock(): 18.75413
整个程序运行总时间time.clock()差: 18.7541297 秒
----------------------------------------------------------------------------------------
