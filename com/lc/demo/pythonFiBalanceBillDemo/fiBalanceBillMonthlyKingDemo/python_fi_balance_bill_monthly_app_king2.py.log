============================================================================================================================================================分隔符
此机构: 0017
💗 I am main()
总共抄表数据: 6
下面是查询当月的上一月最后一天内数据-总共抄表数据
总共抄表数据: 0
0017 ['2019-04-01 00:00:00', '2019-04-30 23:59:59'] 开始进行计算月账单数据处理
不同的表计号共有个数: 1
根据表计号，进行数据的再次筛选，处理，写入数据库
----------------------------------------------------------------------------------------
00176000000001
此查询区间,当前编号下总共抄表记录: 6
此查询区间,上一月最后一天内当前编号下总共抄表记录: 0
开始取自动递增流水号逻辑
总列表长度: 1
执行sql:[update SYS_SERIAL_NO set SSN_VALUE= trim(To_Char(SSN_VALUE+1,'0000000000')) where SSN_ORG_ID= :ssn_org_id and SSN_KEY_NAME = :ssn_key_name and SSN_YEAR = :ssn_year and SSN_MONTH = :ssn_month],参数:[{'ssn_org_id': '0017', 'ssn_key_name': 'FI_BALANCE_BILL', 'ssn_year': '2019', 'ssn_month': '04'}]
update sys_serial_no ok
[{'SSN_ORG_ID': '0017', 'SSN_KEY_NAME': 'FI_BALANCE_BILL', 'SSN_KEY_TYPE': '2', 'SSN_KEY_DESCRIPTION': '201904月账单', 'SSN_YEAR': '2019', 'SSN_MONTH': '04', 'SSN_VALUE': '0000000007'}]
0000000007
00176000000001
总列表长度: 1
执行sql:[delete from FI_BALANCE_BILL where FBB_ORG_ID = :1 and FBB_ID=:2],参数:[('0017', '00172019040000000006')]
del_by_where ok
执行sql:[INSERT INTO FI_BALANCE_BILL (FBB_ORG_ID,FBB_ID, ACCOUNT_MONTH,METER_NO,CUSTOMER_NO,LAST_READ,THIS_READ,THIS_USE_VOLUME,READ_TIME, READ_OPERATOR,PRICE_NO,PRICE,PAYABLE_MONEY,PAYABLE_DATE,LATE_FEE_ENABLE,LATE_FEE_RATE,LATE_DAYS,LATE_FEE_MONEY,PAYABLE_MONEY_TOTAL,BALANCE_OPERATOR,BALANCE_TIME,RECEIPT_OPERATOR,RECEIPT_TIME,RECEIPT_BRANCH_NO,RECEIPT_NO,REMARK,FBB_STATUS,FBB_PAY_WAY,RECEIPT_MONEY_TOTAL,CREATE_TIME)VALUES(:fbb_org_id,:fbb_id, :account_month,:meter_no,:customer_no,:last_read,:this_read,:this_use_volume,:read_time, :read_operator,:price_no,:price,:payable_money,:payable_date,:late_fee_enable,:late_fee_rate,:late_days,:late_fee_money, :payable_money_total,:balance_operator,:balance_time,:receipt_operator,:receipt_time,:receipt_branch_no,:receipt_no,:remark,:fbb_status,:fbb_pay_way,:receipt_money_total,:create_time)],参数:[{'fbb_org_id': '0017', 'fbb_id': '00172019040000000007', 'account_month': '201904', 'meter_no': '00176000000001', 'customer_no': None, 'last_read': '0', 'this_read': '0.000', 'this_use_volume': '0.0', 'read_time': datetime.datetime(2019, 4, 1, 11, 50, 1), 'read_operator': '', 'price_no': '0017000001', 'price': '0.000', 'payable_money': '0.0', 'payable_date': datetime.datetime(2019, 4, 30, 23, 59, 59, 999999), 'late_fee_enable': '0', 'late_fee_rate': '', 'late_days': '', 'late_fee_money': '', 'payable_money_total': '', 'balance_operator': '', 'balance_time': '', 'receipt_operator': '', 'receipt_time': '', 'receipt_branch_no': '', 'receipt_no': '', 'remark': '', 'fbb_status': '', 'fbb_pay_way': '', 'receipt_money_total': '', 'create_time': datetime.datetime(2019, 4, 10, 15, 52, 58, 59443)}]
insert_fi_balance_bill_monthly ok
00176000000001处理好数据已写入oracle
----------------------------------------------------------------------------------------
0017 data_processing is ok
----------------------------------------------------------------------------------------
all done-月账单整个处理流程完成
----------------------------------------------------------------------------------------
程序运行开始时间 2019-04-10 15:52:56.619635
程序运行结束时间: 2019-04-10 15:52:58.179488
整个程序运行总时间: 1 秒
----------------------------------------------------------------------------------------
程序运行开始time.clock(): 2e-07
程序运行结束time.clock(): 1.5677455
整个程序运行总时间time.clock()差: 1.5677453000000001 秒
----------------------------------------------------------------------------------------
